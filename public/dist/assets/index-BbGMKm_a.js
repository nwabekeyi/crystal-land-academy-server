import{r as f,j as t,a as Ae}from"./index-D_kDwTfs.js";import{t as ue,D as ne,a as ae,b as se,c as re}from"./modal-BxlCeH0G.js";import{T as me}from"./table-CgRA7PAF.js";import{H as he}from"./Header--K5xCYHz.js";import{j as fe,v as b,Z as P,$ as U,a0 as R,x as T,T as S,y as $}from"./TextField-BjozRPlS.js";import{M as v}from"./MenuItem-C1-m6Bfh.js";import{w as Ye}from"./dasboardPagesContainer-BVoh5IGI.js";import"./IconButton-BWguZOxP.js";import"./useMediaQuery-CPtOszEa.js";import"./index-BddYBctM.js";import"./loadingButton-C8yTBzap.js";import"./CircularProgress-xlKSzPfm.js";import"./index-NEecTaUU.js";import"./useApi-CbGRypPa.js";import"./confirmationModal-BB-Svlb_.js";import"./crystal-land-log-removebg-DVF-nlbN.js";import"./useSlot-ambHsR5D.js";const Oe=6048e5,xe=6e4,ge=36e5,le=Symbol.for("constructDateFrom");function F(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&le in n?n[le](e):n instanceof Date?new n.constructor(e):new Date(e)}function M(n,e){return F(e||n,n)}let Pe={};function V(){return Pe}function A(n,e){var u,m,d,x;const s=V(),r=(e==null?void 0:e.weekStartsOn)??((m=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??s.weekStartsOn??((x=(d=s.locale)==null?void 0:d.options)==null?void 0:x.weekStartsOn)??0,l=M(n,e==null?void 0:e.in),o=l.getDay(),c=(o<r?7:0)+o-r;return l.setDate(l.getDate()-c),l.setHours(0,0,0,0),l}function Re(n,e){var x,W,N,k;const s=M(n,e==null?void 0:e.in),r=s.getFullYear(),l=V(),o=(e==null?void 0:e.firstWeekContainsDate)??((W=(x=e==null?void 0:e.locale)==null?void 0:x.options)==null?void 0:W.firstWeekContainsDate)??l.firstWeekContainsDate??((k=(N=l.locale)==null?void 0:N.options)==null?void 0:k.firstWeekContainsDate)??1,c=F((e==null?void 0:e.in)||n,0);c.setFullYear(r+1,0,o),c.setHours(0,0,0,0);const u=A(c,e),m=F((e==null?void 0:e.in)||n,0);m.setFullYear(r,0,o),m.setHours(0,0,0,0);const d=A(m,e);return+s>=+u?r+1:+s>=+d?r:r-1}function Fe(n,e){var u,m,d,x;const s=V(),r=(e==null?void 0:e.firstWeekContainsDate)??((m=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((x=(d=s.locale)==null?void 0:d.options)==null?void 0:x.firstWeekContainsDate)??1,l=Re(n,e),o=F((e==null?void 0:e.in)||n,0);return o.setFullYear(l,0,r),o.setHours(0,0,0,0),A(o,e)}function H(n,e){const s=M(n,e==null?void 0:e.in),r=+A(s,e)-+Fe(s,e);return Math.round(r/Oe)+1}function L(n,e){const s=()=>F(e==null?void 0:e.in,NaN),l=Ee(n);let o;if(l.date){const d=Ue(l.date,2);o=He(d.restDateString,d.year)}if(!o||isNaN(+o))return s();const c=+o;let u=0,m;if(l.time&&(u=Le(l.time),isNaN(u)))return s();if(l.timezone){if(m=Je(l.timezone),isNaN(m))return s()}else{const d=new Date(c+u),x=M(0,e==null?void 0:e.in);return x.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),x.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),x}return M(c+u+m,e==null?void 0:e.in)}const E={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Me=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,_e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,$e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ee(n){const e={},s=n.split(E.dateTimeDelimiter);let r;if(s.length>2)return e;if(/:/.test(s[0])?r=s[0]:(e.date=s[0],r=s[1],E.timeZoneDelimiter.test(e.date)&&(e.date=n.split(E.timeZoneDelimiter)[0],r=n.substr(e.date.length,n.length))),r){const l=E.timezone.exec(r);l?(e.time=r.replace(l[1],""),e.timezone=l[1]):e.time=r}return e}function Ue(n,e){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=n.match(s);if(!r)return{year:NaN,restDateString:""};const l=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?l:o*100,restDateString:n.slice((r[1]||r[2]).length)}}function He(n,e){if(e===null)return new Date(NaN);const s=n.match(Me);if(!s)return new Date(NaN);const r=!!s[4],l=O(s[1]),o=O(s[2])-1,c=O(s[3]),u=O(s[4]),m=O(s[5])-1;if(r)return Ge(e,u,m)?Be(e,u,m):new Date(NaN);{const d=new Date(0);return!Ze(e,o,c)||!qe(e,l)?new Date(NaN):(d.setUTCFullYear(e,o,Math.max(l,c)),d)}}function O(n){return n?parseInt(n):1}function Le(n){const e=n.match(_e);if(!e)return NaN;const s=G(e[1]),r=G(e[2]),l=G(e[3]);return Ke(s,r,l)?s*ge+r*xe+l*1e3:NaN}function G(n){return n&&parseFloat(n.replace(",","."))||0}function Je(n){if(n==="Z")return 0;const e=n.match($e);if(!e)return 0;const s=e[1]==="+"?-1:1,r=parseInt(e[2]),l=e[3]&&parseInt(e[3])||0;return Qe(r,l)?s*(r*ge+l*xe):NaN}function Be(n,e,s){const r=new Date(0);r.setUTCFullYear(n,0,4);const l=r.getUTCDay()||7,o=(e-1)*7+s+1-l;return r.setUTCDate(r.getUTCDate()+o),r}const ze=[31,null,31,30,31,30,31,31,30,31,30,31];function Se(n){return n%400===0||n%4===0&&n%100!==0}function Ze(n,e,s){return e>=0&&e<=11&&s>=1&&s<=(ze[e]||(Se(n)?29:28))}function qe(n,e){return e>=1&&e<=(Se(n)?366:365)}function Ge(n,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function Ke(n,e,s){return n===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&n>=0&&n<25}function Qe(n,e){return e>=0&&e<=59}const Ve=[{id:1,session:"2024-2025",term:"First Term",date:"2024-09-02",location:"Room 101",time:"08:00 - 09:00",topic:"Mathematics: Algebra Basics",attended:"Yes"},{id:2,session:"2024-2025",term:"First Term",date:"2024-09-02",location:"Room 102",time:"09:15 - 10:15",topic:"English: Literature Analysis",attended:"No"},{id:3,session:"2024-2025",term:"First Term",date:"2024-09-09",location:"Lab 1",time:"10:30 - 11:30",topic:"Science: Chemistry Experiments",attended:"Yes"},{id:4,session:"2024-2025",term:"Second Term",date:"2025-01-06",location:"Room 103",time:"08:00 - 09:00",topic:"History: World War II",attended:"No"},{id:5,session:"2024-2025",term:"Second Term",date:"2025-01-13",location:"Room 101",time:"09:15 - 10:15",topic:"Physical Education: Fitness Training",attended:"Yes"}],ie=["2024-2025","2025-2026"],K=["First Term","Second Term","Third Term"],ce=12,Xe=()=>{const n=fe(),e=ue(n.palette.mode),[s,r]=f.useState(ie[0]),[l,o]=f.useState(K[0]),[c,u]=f.useState(1),[m,d]=f.useState("date"),[x,W]=f.useState("asc"),[N,k]=f.useState(0),[J,p]=f.useState(5),B=i=>{const j=L(i),q=A(L("2024-09-01"));return H(j,{weekStartsOn:1})-H(q,{weekStartsOn:1})+1},_=Ve.filter(i=>i.session===s&&i.term===l&&B(i.date)===c).map((i,j)=>({...i,sn:j+1,date:i.date?new Date(i.date).toLocaleDateString():"N/A"})),z=[{id:"sn",label:"S/N",flex:.5},{id:"date",label:"Date",flex:1,renderCell:i=>t.jsx(S,{children:i.date||"N/A"})},{id:"location",label:"Location",flex:1,renderCell:i=>t.jsx(S,{children:String(i.location||"N/A")})},{id:"time",label:"Time",flex:1,renderCell:i=>t.jsx(S,{children:String(i.time||"N/A")})},{id:"topic",label:"Topic",flex:2,renderCell:i=>t.jsx(S,{children:String(i.topic||"N/A")})},{id:"attended",label:"Attended",flex:1,renderCell:i=>t.jsx(S,{children:String(i.attended||"N/A")})}],I=i=>{W(m===i&&x==="asc"?"desc":"asc"),d(i)},Z=(i,j)=>{k(j)},y=i=>{p(parseInt(i.target.value,10)),k(0)},Y=i=>{console.log("Row clicked:",i)},w=()=>{c>1&&(u(c-1),k(0))},g=()=>{c<ce&&(u(c+1),k(0))},D={columns:z,tableHeader:`Schedule for ${s}, ${l}, Week ${c}`,data:_,sortBy:m,sortDirection:x,onSortChange:I,page:N,rowsPerPage:J,onPageChange:Z,onRowsPerPageChange:y,onRowClick:Y};return t.jsxs(b,{py:"20px",children:[t.jsx(he,{title:"TIME TABLE",subtitle:"Weekly Schedule Overview"}),t.jsxs(b,{mb:"20px",display:"flex",gap:"20px",alignItems:"center",children:[t.jsxs(P,{sx:{minWidth:150},children:[t.jsx(U,{id:"session-select-label",children:"Session"}),t.jsx(R,{labelId:"session-select-label",value:s,label:"Session",onChange:i=>{r(i.target.value),o(K[0]),u(1),k(0)},children:ie.map(i=>t.jsx(v,{value:i,children:i},i))})]}),t.jsxs(P,{sx:{minWidth:150},children:[t.jsx(U,{id:"term-select-label",children:"Term"}),t.jsx(R,{labelId:"term-select-label",value:l,label:"Term",onChange:i=>{o(i.target.value),u(1),k(0)},children:K.map(i=>t.jsx(v,{value:i,children:i},i))})]}),t.jsxs(b,{display:"flex",alignItems:"center",gap:"10px",children:[t.jsx(T,{variant:"contained",onClick:w,disabled:c===1,sx:{backgroundColor:e.blueAccent[700]},children:"Previous Week"}),t.jsxs(S,{variant:"h6",children:["Week ",c]}),t.jsx(T,{variant:"contained",onClick:g,disabled:c===ce,sx:{backgroundColor:e.blueAccent[700]},children:"Next Week"})]})]}),t.jsx(b,{children:_.length>0?t.jsx(me,{...D}):t.jsx(S,{children:"No schedule available for this week."})})]})},et=[{id:1,session:"2024-2025",term:"First Term",date:"2024-09-02",location:"Room 101",time:"08:00 - 09:00",topic:"Mathematics: Algebra Basics",students:[{studentId:"stu_1",name:"John Doe",attendance:"Yes"},{studentId:"stu_2",name:"Jane Smith",attendance:"No"}]},{id:2,session:"2024-2025",term:"First Term",date:"2024-09-02",location:"Room 102",time:"09:15 - 10:15",topic:"English: Literature Analysis",students:[{studentId:"stu_1",name:"John Doe",attendance:"No"},{studentId:"stu_2",name:"Jane Smith",attendance:"Yes"}]},{id:3,session:"2024-2025",term:"First Term",date:"2024-09-09",location:"Lab 1",time:"10:30 - 11:30",topic:"Science: Chemistry Experiments",students:[{studentId:"stu_1",name:"John Doe",attendance:"Yes"},{studentId:"stu_2",name:"Jane Smith",attendance:"Yes"}]},{id:4,session:"2024-2025",term:"Second Term",date:"2025-01-06",location:"Room 103",time:"08:00 - 09:00",topic:"History: World War II",students:[{studentId:"stu_1",name:"John Doe",attendance:"No"},{studentId:"stu_2",name:"Jane Smith",attendance:"No"}]}],tt=[{studentId:"stu_1",name:"John Doe"},{studentId:"stu_2",name:"Jane Smith"}],oe=["2024-2025","2025-2026"],Q=["First Term","Second Term","Third Term"],de=12,nt=()=>{var ee;const n=fe(),e=ue(n.palette.mode),[s,r]=f.useState(oe[0]),[l,o]=f.useState(Q[0]),[c,u]=f.useState(1),[m,d]=f.useState(et),[x,W]=f.useState("date"),[N,k]=f.useState("asc"),[J,p]=f.useState(0),[B,_]=f.useState(5),[z,I]=f.useState(!1),[Z,y]=f.useState(!1),[Y,w]=f.useState(null),[g,D]=f.useState({date:"",location:"",time:"",topic:""}),[i,j]=f.useState({}),q=a=>{const h=L(a),C=A(L("2024-09-01"));return H(h,{weekStartsOn:1})-H(C,{weekStartsOn:1})+1},X=m.filter(a=>a.session===s&&a.term===l&&q(a.date)===c).map((a,h)=>({...a,sn:h+1,date:a.date?new Date(a.date).toLocaleDateString():"N/A"})),Ce=()=>{const h={id:m.length+1,session:s,term:l,date:g.date,location:g.location,time:g.time,topic:g.topic,students:tt.map(C=>({studentId:C.studentId,name:C.name,attendance:"No"}))};d([...m,h]),D({date:"",location:"",time:"",topic:""}),I(!1)},je=(a,h)=>{j(C=>({...C,[a]:h}))},be=()=>{d(a=>a.map(h=>h.id===Y?{...h,students:h.students.map(C=>({...C,attendance:i[C.studentId]||C.attendance}))}:h)),y(!1),w(null),j({})},ke=a=>{const h=m.find(C=>C.id===a);if(h){const C=h.students.reduce((ve,te)=>({...ve,[te.studentId]:te.attendance}),{});j(C),w(a),y(!0)}},Te=[{id:"sn",label:"S/N",flex:.5},{id:"date",label:"Date",flex:1,renderCell:a=>t.jsx(S,{children:a.date||"N/A"})},{id:"location",label:"Location",flex:1,renderCell:a=>t.jsx(S,{children:String(a.location||"N/A")})},{id:"time",label:"Time",flex:1,renderCell:a=>t.jsx(S,{children:String(a.time||"N/A")})},{id:"topic",label:"Topic",flex:2,renderCell:a=>t.jsx(S,{children:String(a.topic||"N/A")})},{id:"students",label:"Student Attendance",flex:3,renderCell:a=>t.jsxs(b,{children:[a.students.map(h=>t.jsxs(S,{mb:"5px",children:[h.name,": ",h.attendance]},h.studentId)),t.jsx(T,{variant:"contained",color:"secondary",size:"small",onClick:()=>ke(a.id),sx:{mt:1},children:"Mark Attendance"})]})}],De=a=>{k(x===a&&N==="asc"?"desc":"asc"),W(a)},pe=(a,h)=>{p(h)},Ne=a=>{_(parseInt(a.target.value,10)),p(0)},We=a=>{console.log("Row clicked:",a)},Ie=()=>{c>1&&(u(c-1),p(0))},ye=()=>{c<de&&(u(c+1),p(0))},we={columns:Te,tableHeader:`Schedule for ${s}, ${l}, Week ${c}`,data:X,sortBy:x,sortDirection:N,onSortChange:De,page:J,rowsPerPage:B,onPageChange:pe,onRowsPerPageChange:Ne,onRowClick:We};return t.jsxs(b,{py:"20px",children:[t.jsx(he,{title:"TEACHER TIME TABLE",subtitle:"Manage Weekly Schedule and Attendance"}),t.jsxs(b,{mb:"20px",display:"flex",gap:"20px",alignItems:"center",children:[t.jsxs(P,{sx:{minWidth:150},children:[t.jsx(U,{id:"session-select-label",children:"Session"}),t.jsx(R,{labelId:"session-select-label",value:s,label:"Session",onChange:a=>{r(a.target.value),o(Q[0]),u(1),p(0)},children:oe.map(a=>t.jsx(v,{value:a,children:a},a))})]}),t.jsxs(P,{sx:{minWidth:150},children:[t.jsx(U,{id:"term-select-label",children:"Term"}),t.jsx(R,{labelId:"term-select-label",value:l,label:"Term",onChange:a=>{o(a.target.value),u(1),p(0)},children:Q.map(a=>t.jsx(v,{value:a,children:a},a))})]}),t.jsxs(b,{display:"flex",alignItems:"center",gap:"10px",children:[t.jsx(T,{variant:"contained",onClick:Ie,disabled:c===1,sx:{backgroundColor:e.blueAccent[700]},children:"Previous Week"}),t.jsxs(S,{variant:"h6",children:["Week ",c]}),t.jsx(T,{variant:"contained",onClick:ye,disabled:c===de,sx:{backgroundColor:e.blueAccent[700]},children:"Next Week"})]}),t.jsx(T,{variant:"contained",color:"secondary",onClick:()=>I(!0),sx:{ml:"auto"},children:"Add Schedule"})]}),t.jsx(b,{children:X.length>0?t.jsx(me,{...we}):t.jsx(S,{children:"No schedule available for this week."})}),t.jsxs(ne,{open:z,onClose:()=>{I(!1),D({date:"",location:"",time:"",topic:""})},children:[t.jsx(ae,{children:"Add New Schedule"}),t.jsx(se,{children:t.jsxs(b,{display:"flex",flexDirection:"column",gap:"16px",mt:"10px",children:[t.jsx($,{label:"Date (YYYY-MM-DD)",value:g.date,onChange:a=>D({...g,date:a.target.value}),fullWidth:!0}),t.jsx($,{label:"Location",value:g.location,onChange:a=>D({...g,location:a.target.value}),fullWidth:!0}),t.jsx($,{label:"Time (e.g., 08:00 - 09:00)",value:g.time,onChange:a=>D({...g,time:a.target.value}),fullWidth:!0}),t.jsx($,{label:"Topic",value:g.topic,onChange:a=>D({...g,topic:a.target.value}),fullWidth:!0})]})}),t.jsxs(re,{children:[t.jsx(T,{onClick:()=>{I(!1),D({date:"",location:"",time:"",topic:""})},children:"Cancel"}),t.jsx(T,{onClick:Ce,color:"primary",disabled:!g.date||!g.location||!g.time||!g.topic,children:"Add"})]})]}),t.jsxs(ne,{open:Z,onClose:()=>{y(!1),w(null),j({})},children:[t.jsx(ae,{children:"Mark Attendance"}),t.jsx(se,{children:t.jsx(b,{display:"flex",flexDirection:"column",gap:"16px",mt:"10px",children:Y&&((ee=m.find(a=>a.id===Y))==null?void 0:ee.students.map(a=>t.jsxs(b,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[t.jsx(S,{children:a.name}),t.jsx(P,{sx:{minWidth:100},children:t.jsxs(R,{value:i[a.studentId]||a.attendance,onChange:h=>je(a.studentId,h.target.value),children:[t.jsx(v,{value:"Yes",children:"Yes"}),t.jsx(v,{value:"No",children:"No"})]})})]},a.studentId)))})}),t.jsxs(re,{children:[t.jsx(T,{onClick:()=>{y(!1),w(null),j({})},children:"Cancel"}),t.jsx(T,{onClick:be,color:"primary",children:"Confirm"})]})]})]})},at=()=>{const n=Ae(s=>s.users.user),e=n.role;return t.jsx("div",{children:e==="student"?t.jsx(Xe,{}):t.jsx(nt,{babtechUser:n})})},kt=Ye(at);export{kt as default};
