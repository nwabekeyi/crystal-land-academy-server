import{j as e,a as I,r as t,K as p,e as f}from"./index-qmmqHzY5.js";import{a as E}from"./index-BwtLsqef.js";import{d as $}from"./Visibility-DhFnvRmn.js";import{t as T}from"./TextField-Cs2SSotF.js";import{r as H,M as C}from"./modal-Bx1kEpp4.js";import{T as W}from"./table-BbIk8x_V.js";import{H as U}from"./Header-CzWZr2ph.js";import{u as y}from"./useApi-CFpppkIv.js";import{I as o}from"./IconButton-DTIv2feH.js";import{u as L}from"./MenuItem-CyVMp_O5.js";import"./confirmationModal-35_TUgti.js";import"./CircularProgress-BakzznEt.js";import"./index-B9CRSDbo.js";import"./loadingButton-C3v_gCSH.js";import"./useSlot-fCuBEx6y.js";import"./useMediaQuery-is2W_U8_.js";var x={},z=T;Object.defineProperty(x,"__esModule",{value:!0});var v=x.default=void 0,Q=z(H()),B=e;v=x.default=(0,Q.default)((0,B.jsx)("path",{d:"M12 19c0-3.87 3.13-7 7-7 1.08 0 2.09.25 3 .68V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h8.08c-.05-.33-.08-.66-.08-1M4 6l8 5 8-5v2l-8 5-8-5zm13.34 16-3.54-3.54 1.41-1.41 2.12 2.12 4.24-4.24L23 16.34z"}),"MarkEmailRead");const ie=()=>{const l=L(),{enquiries:i,loading:d,error:c}=I(r=>r.enquiries),[s,m]=t.useState(null),[u,h]=t.useState(!1),[R,j]=t.useState(0),[b,q]=t.useState(10),{callApi:M}=y(),{callApi:P}=y();t.useEffect(()=>{l(p())},[l]),console.log("Redux Enquiries:",i);const D=[{id:"name",label:"Name",minWidth:100},{id:"phone",label:"Phone No.",minWidth:50},{id:"email",label:"Email",minWidth:100},{id:"status",label:"Status",minWidth:50},{id:"actions",label:"Actions",minWidth:150,renderCell:r=>r.actions}],g=i.map(r=>({_id:r._id,name:r.name,phone:r.phone,email:r.email,status:r.status==="read"?"Read":"Unread",actions:e.jsxs(e.Fragment,{children:[e.jsx(o,{onClick:()=>_(r),"aria-label":"view",style:{marginRight:"10px"},children:e.jsx($,{})}),e.jsx(o,{onClick:()=>w(r),"aria-label":"delete",color:"error",children:e.jsx(E,{})})]})}));console.log("Table Rows:",g);const k=(r,a)=>{j(a)},S=r=>{q(parseInt(r.target.value,10)),j(0)},_=r=>{m(r),h(!1)},w=r=>{m(r),h(!0)},n=()=>{m(null),h(!1)},A=async r=>{try{const a=`${f.ENQUIRIES}/${r}`;console.log("Marking as read:",a);const F=await M(a,"PATCH",{status:"read"});l(p())}catch(a){console.error("Error marking enquiry as read:",a)}},N=async r=>{try{const a=`${f.ENQUIRIES}/${r}`;console.log("Deleting enquiry:",a),await P(a,"DELETE"),l(p()),n()}catch(a){console.error("Error deleting enquiry:",a)}};return e.jsxs("div",{children:[e.jsx(U,{title:"Enquiries",subtitle:"Enquiries from prospects"}),d&&e.jsx("p",{children:"Loading..."}),c&&e.jsx("p",{style:{color:"red"},children:c}),!d&&!c&&i.length===0&&e.jsx("p",{children:"No enquiries found."}),!d&&!c&&i.length>0&&e.jsx(W,{columns:D,tableHeader:"Enquiries",data:g,page:R,rowsPerPage:b,onPageChange:k,onRowsPerPageChange:S}),s&&!u&&e.jsx(C,{open:!!s,onClose:n,noConfirm:!0,title:"Enquiry Details",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("h2",{children:[e.jsx("strong",{children:"Name: "}),s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Number: "}),s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"E-mail: "}),e.jsx("a",{href:`mailto:${s.email}`,style:{textDecoration:"underline"},children:s.email})]})," ",e.jsxs("p",{children:[e.jsx("strong",{children:"Message: "}),s.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status: "}),s.status==="read"?"Read":"Unread"]}),s.status==="unread"&&e.jsx(o,{onClick:()=>{A(s._id),n()},"aria-label":"mark as read",color:"primary",children:e.jsx(v,{})})]})}),u&&s&&e.jsx(C,{open:u,onClose:n,noConfirm:!0,title:"Confirm Delete",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"Are you sure you want to delete this enquiry?"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name: "}),s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone: "}),s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email: "}),e.jsx("a",{href:`mailto:${s.email}`,style:{color:"blue",textDecoration:"underline"},children:s.email})]})," ",e.jsxs("p",{children:[e.jsx("strong",{children:"Message: "}),s.message]}),e.jsxs("div",{style:{display:"flex",justifyContent:"end",marginTop:"20px"},children:[e.jsx(o,{onClick:()=>N(s._id),"aria-label":"delete",color:"error",children:e.jsx(E,{})}),e.jsx(o,{onClick:n,"aria-label":"cancel",color:"primary",children:"Cancel"})]})]})})]})};export{ie as default};
