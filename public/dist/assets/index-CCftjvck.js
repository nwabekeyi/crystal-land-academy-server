import{r as x,j as n,a as q,e as O,s as V,v as he,w as ge,x as K,y as B,f as ye,u as xe}from"./index-C9iRgkSz.js";import{L as ve}from"./loadingButton-RxVQSDD4.js";import{u as be,M as z}from"./MenuItem-CVHzzFfg.js";import{A as ne,C as Se,_ as A,D as ke,b as u,E as je,F as Ce,G as we,H as Te,J as Re,K as Me,R as Pe,N as Ee,k as Le,d as re,m as Q,l as H,O as Fe,Q as Ae,S as Ie,e as ae,g as ie,U as X,V as Z,u as Y,W as Oe,s as le,a as _e,X as ee,i as Ve,Y as De,p as $e,h as ce,T as F,c as N,Z as Ne,w as T,$ as U,a0 as Be,a1 as ze,z as se}from"./TextField-BaBylmdg.js";import{I as W}from"./IconButton-DmrQh4qH.js";const He=["ownerState"],Ue=["variants"],We=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Ge(e){return Object.keys(e).length===0}function qe(e){return typeof e=="string"&&e.charCodeAt(0)>96}function G(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Ye=ne(),Je=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function D({defaultTheme:e,theme:s,themeId:t}){return Ge(s)?e:s[t]||s}function Ke(e){return e?(s,t)=>t[e]:null}function $(e,s){let{ownerState:t}=s,o=A(s,He);const r=typeof e=="function"?e(u({ownerState:t},o)):e;if(Array.isArray(r))return r.flatMap(i=>$(i,u({ownerState:t},o)));if(r&&typeof r=="object"&&Array.isArray(r.variants)){const{variants:i=[]}=r;let l=A(r,Ue);return i.forEach(a=>{let c=!0;typeof a.props=="function"?c=a.props(u({ownerState:t},o,t)):Object.keys(a.props).forEach(f=>{(t==null?void 0:t[f])!==a.props[f]&&o[f]!==a.props[f]&&(c=!1)}),c&&(Array.isArray(l)||(l=[l]),l.push(typeof a.style=="function"?a.style(u({ownerState:t},o,t)):a.style))}),l}return r}function Qe(e={}){const{themeId:s,defaultTheme:t=Ye,rootShouldForwardProp:o=G,slotShouldForwardProp:r=G}=e,i=d=>Ce(u({},d,{theme:D(u({},d,{defaultTheme:t,themeId:s}))}));return i.__mui_systemSx=!0,(d,l={})=>{Se(d,y=>y.filter(b=>!(b!=null&&b.__mui_systemSx)));const{name:a,slot:c,skipVariantsResolver:f,skipSx:h,overridesResolver:m=Ke(Je(c))}=l,g=A(l,We),S=f!==void 0?f:c&&c!=="Root"&&c!=="root"||!1,v=h||!1;let R,k=G;c==="Root"||c==="root"?k=o:c?k=r:qe(d)&&(k=void 0);const p=ke(d,u({shouldForwardProp:k,label:R},g)),C=y=>typeof y=="function"&&y.__emotion_real!==y||je(y)?b=>$(y,u({},b,{theme:D({theme:b.theme,defaultTheme:t,themeId:s})})):y,E=(y,...b)=>{let L=C(y);const P=b?b.map(C):[];a&&m&&P.push(w=>{const j=D(u({},w,{defaultTheme:t,themeId:s}));if(!j.components||!j.components[a]||!j.components[a].styleOverrides)return null;const I=j.components[a].styleOverrides,_={};return Object.entries(I).forEach(([me,pe])=>{_[me]=$(pe,u({},w,{theme:j}))}),m(w,_)}),a&&!S&&P.push(w=>{var j;const I=D(u({},w,{defaultTheme:t,themeId:s})),_=I==null||(j=I.components)==null||(j=j[a])==null?void 0:j.variants;return $({variants:_},u({},w,{theme:I}))}),v||P.push(i);const M=P.length-b.length;if(Array.isArray(y)&&M>0){const w=new Array(M).fill("");L=[...y,...w],L.raw=[...y.raw,...w]}const J=p(L,...P);return d.muiName&&(J.muiName=d.muiName),J};return p.withConfig&&(E.withConfig=p.withConfig),E}}const Xe=Qe();function Ze(e){const{theme:s,name:t,props:o}=e;return!s||!s.components||!s.components[t]||!s.components[t].defaultProps?o:we(s.components[t].defaultProps,o)}function es({props:e,name:s,defaultTheme:t,themeId:o}){let r=Te(t);return o&&(r=r[o]||r),Ze({theme:r,name:s,props:e})}const ue=x.createContext(null);function de(){return x.useContext(ue)}const ss=typeof Symbol=="function"&&Symbol.for,ts=ss?Symbol.for("mui.nested"):"__THEME_NESTED__";function os(e,s){return typeof s=="function"?s(e):u({},e,s)}function ns(e){const{children:s,theme:t}=e,o=de(),r=x.useMemo(()=>{const i=o===null?t:os(o,t);return i!=null&&(i[ts]=o!==null),i},[t,o]);return n.jsx(ue.Provider,{value:r,children:s})}const te={};function oe(e,s,t,o=!1){return x.useMemo(()=>{const r=e&&s[e]||s;if(typeof t=="function"){const i=t(r),d=e?u({},s,{[e]:i}):i;return o?()=>d:d}return e?u({},s,{[e]:t}):u({},s,t)},[e,s,t,o])}function rs(e){const{children:s,theme:t,themeId:o}=e,r=Re(te),i=de()||te,d=oe(o,r,t),l=oe(o,i,t,!0),a=d.direction==="rtl";return n.jsx(ns,{theme:l,children:n.jsx(Me.Provider,{value:d,children:n.jsx(Pe,{value:a,children:n.jsx(Ee,{value:d==null?void 0:d.components,children:s})})})})}const as=["component","direction","spacing","divider","children","className","useFlexGap"],is=ne(),ls=Xe("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,s)=>s.root});function cs(e){return es({props:e,name:"MuiStack",defaultTheme:is})}function us(e,s){const t=x.Children.toArray(e).filter(Boolean);return t.reduce((o,r,i)=>(o.push(r),i<t.length-1&&o.push(x.cloneElement(s,{key:`separator-${i}`})),o),[])}const ds=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],fs=({ownerState:e,theme:s})=>{let t=u({display:"flex",flexDirection:"column"},Q({theme:s},H({values:e.direction,breakpoints:s.breakpoints.values}),o=>({flexDirection:o})));if(e.spacing){const o=Fe(s),r=Object.keys(s.breakpoints.values).reduce((a,c)=>((typeof e.spacing=="object"&&e.spacing[c]!=null||typeof e.direction=="object"&&e.direction[c]!=null)&&(a[c]=!0),a),{}),i=H({values:e.direction,base:r}),d=H({values:e.spacing,base:r});typeof i=="object"&&Object.keys(i).forEach((a,c,f)=>{if(!i[a]){const m=c>0?i[f[c-1]]:"column";i[a]=m}}),t=Ae(t,Q({theme:s},d,(a,c)=>e.useFlexGap?{gap:X(o,a)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${ds(c?i[c]:e.direction)}`]:X(o,a)}}))}return t=Ie(s.breakpoints,t),t};function ms(e={}){const{createStyledComponent:s=ls,useThemeProps:t=cs,componentName:o="MuiStack"}=e,r=()=>ae({root:["root"]},a=>ie(o,a),{}),i=s(fs);return x.forwardRef(function(a,c){const f=t(a),h=Le(f),{component:m="div",direction:g="column",spacing:S=0,divider:v,children:R,className:k,useFlexGap:p=!1}=h,C=A(h,as),E={direction:g,spacing:S,useFlexGap:p},y=r();return n.jsx(i,u({as:m,ownerState:E,ref:c,className:re(y.root,k)},C,{children:v?us(R,v):R}))})}const ps=["theme"];function hs(e){let{theme:s}=e,t=A(e,ps);const o=s[Z];let r=o||s;return typeof s!="function"&&(o&&!o.vars?r=u({},o,{vars:null}):s&&!s.vars&&(r=u({},s,{vars:null}))),n.jsx(rs,u({},t,{themeId:o?Z:void 0,theme:r}))}const gs=(e,s)=>u({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},s&&!e.vars&&{colorScheme:e.palette.mode}),ys=e=>u({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),xs=(e,s=!1)=>{var t;const o={};s&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(([d,l])=>{var a;o[e.getColorSchemeSelector(d).replace(/\s*&/,"")]={colorScheme:(a=l.palette)==null?void 0:a.mode}});let r=u({html:gs(e,s),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:u({margin:0},ys(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},o);const i=(t=e.components)==null||(t=t.MuiCssBaseline)==null?void 0:t.styleOverrides;return i&&(r=[r,i]),r};function vs(e){const s=Y({props:e,name:"MuiCssBaseline"}),{children:t,enableColorScheme:o=!1}=s;return n.jsxs(x.Fragment,{children:[n.jsx(Oe,{styles:r=>xs(r,o)}),t]})}const bs=ms({createStyledComponent:le("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,s)=>s.root}),useThemeProps:e=>Y({props:e,name:"MuiStack"})});function Ss(e){return ie("MuiLink",e)}const ks=_e("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),fe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},js=e=>fe[e]||e,Cs=({theme:e,ownerState:s})=>{const t=js(s.color),o=ee(e,`palette.${t}`,!1)||s.color,r=ee(e,`palette.${t}Channel`);return"vars"in e&&r?`rgba(${r} / 0.4)`:Ve(o,.4)},ws=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Ts=e=>{const{classes:s,component:t,focusVisible:o,underline:r}=e,i={root:["root",`underline${ce(r)}`,t==="button"&&"button",o&&"focusVisible"]};return ae(i,Ss,s)},Rs=le(F,{name:"MuiLink",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:t}=e;return[s.root,s[`underline${ce(t.underline)}`],t.component==="button"&&s.button]}})(({theme:e,ownerState:s})=>u({},s.underline==="none"&&{textDecoration:"none"},s.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},s.underline==="always"&&u({textDecoration:"underline"},s.color!=="inherit"&&{textDecorationColor:Cs({theme:e,ownerState:s})},{"&:hover":{textDecorationColor:"inherit"}}),s.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ks.focusVisible}`]:{outline:"auto"}})),Ms=x.forwardRef(function(s,t){const o=Y({props:s,name:"MuiLink"}),{className:r,color:i="primary",component:d="a",onBlur:l,onFocus:a,TypographyClasses:c,underline:f="always",variant:h="inherit",sx:m}=o,g=A(o,ws),{isFocusVisibleRef:S,onBlur:v,onFocus:R,ref:k}=De(),[p,C]=x.useState(!1),E=$e(t,k),y=M=>{v(M),S.current===!1&&C(!1),l&&l(M)},b=M=>{R(M),S.current===!0&&C(!0),a&&a(M)},L=u({},o,{color:i,component:d,focusVisible:p,underline:f,variant:h}),P=Ts(L);return n.jsx(Rs,u({color:i,className:re(P.root,r),classes:c,component:d,onBlur:y,onFocus:b,ref:E,ownerState:L,variant:h,sx:[...Object.keys(fe).includes(i)?[]:[{color:i}],...Array.isArray(m)?m:[m]]},g))}),Ps=N(n.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),Es=N(n.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.43c0-.6.36-1.15.92-1.39.64-.28 1.34-.43 2.08-.43s1.44.15 2.08.43c.55.24.92.78.92 1.39zm1-9h-2V4h2zm4.25 7.5h-2.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75m0-3h-2.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75"}),"BadgeRounded"),Ls=N(n.jsx("path",{d:"M11.01 3.05C6.51 3.54 3 7.36 3 12c0 4.97 4.03 9 9 9 4.63 0 8.45-3.5 8.95-8 .09-.79-.78-1.42-1.54-.95-.84.54-1.84.85-2.91.85-2.98 0-5.4-2.42-5.4-5.4 0-1.06.31-2.06.84-2.89.45-.67-.04-1.63-.93-1.56"}),"DarkModeRounded"),Fs=N(n.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5M2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1m18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1M11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1m0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1M5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0z"}),"LightModeRounded"),As=()=>{const e=be(),{user:s}=q(l=>l.users),{loading:t,error:o}=q(l=>l.ui),r=async(l,a,c)=>{e(K(!0)),e(V(null));try{if(!c)throw new Error("User role is required for login");let f;switch(c.toLowerCase()){case"admin":f=O.LOGIN.ADMIN;break;case"teacher":f=O.LOGIN.TEACHER;break;case"student":f=O.LOGIN.STUDENT;break;default:throw new Error("Invalid user role")}const h=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,password:a}),credentials:"include"}),m=h.headers.get("content-type");if(!h.ok){const S=m!=null&&m.includes("application/json")?(await h.json()).message||"Login failed":await h.text();throw new Error(`Login failed: ${S}`)}if(!(m!=null&&m.includes("application/json")))throw new Error("Invalid server response format");const g=await h.json();g.data.token?(sessionStorage.setItem("accessToken",g.data.token),console.log("Access token stored in sessionStorage")):console.warn("No access token found in response"),c.toLowerCase()==="student"?(e(B(g.data.student)),console.log("Logged in:",g.data.student)):c.toLowerCase()==="teacher"?(e(B(g.data.teacher)),console.log("Logged in:",g.data.teacher)):(e(B(g.data.user)),console.log("Logged in:",g.data.user))}catch(f){e(V(f.message))}finally{e(K(!1))}},i=async()=>{try{const l=await fetch(O.REFRESH_TOKEN,{method:"POST",credentials:"include"}),a=l.headers.get("content-type");if(!l.ok){const f=a!=null&&a.includes("application/json")?(await l.json()).message||"Failed to refresh token":await l.text();throw new Error(`Failed to refresh access token: ${f}`)}if(!(a!=null&&a.includes("application/json")))throw new Error("Invalid refresh token response format");const c=await l.json();c.token?(sessionStorage.setItem("accessToken",c.token),console.log("Access token refreshed and stored in sessionStorage")):console.warn("No access token found in refresh response")}catch(l){e(V(l.message)),console.error(l)}};return x.useEffect(()=>{const l=setInterval(()=>{i()},84e4);return()=>clearInterval(l)},[]),{user:s,login:r,logout:async()=>{try{await fetch(O.LOGOUT,{method:"POST",credentials:"include"}),e(he()),sessionStorage.removeItem("accessToken"),console.log("Access token removed from sessionStorage"),await ge("Messages"),console.log("Messages store deleted after logout.")}catch(l){e(V(l.message))}},loading:t,error:o}},Is="/assets/signinBg-RilISOAr.jpeg",Os="/assets/login_muslim_image-n9SwmIkJ.png",Bs=()=>{const{loading:e,error:s,login:t}=As(),[o,r]=x.useState(""),[i,d]=x.useState(""),[l,a]=x.useState(""),[c,f]=x.useState(!1),h=ye(),m=xe().pathname,g=q(p=>p.users.user);x.useEffect(()=>{g&&h("/dashboard")},[g,h]);const S=async p=>{if(p.preventDefault(),!o||!i||!l){alert("Please enter email, password, and select a role.");return}f(!0);try{await t(o,i,l)}catch(C){console.error("Error during login:",C)}finally{f(!1)}},[v,R]=x.useState("dark"),k=Ne({palette:{mode:v,...v==="light"?{background:{default:"#f5f5f5"},primary:{main:"#1976d2"},text:{primary:"#000000"}}:{background:{default:"#121212"},primary:{main:"#90caf9"},text:{primary:"#ffffff"}}}});return n.jsxs(hs,{theme:k,children:[n.jsx(vs,{}),n.jsxs(T,{sx:{display:"flex",justifyContent:"end",alignItems:"center",minHeight:"100vh",backgroundImage:`url(${v==="light"?Is:Os})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",position:"relative"},children:[n.jsx(T,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",opacity:v==="light"?.4:.2}}),n.jsxs(T,{sx:{width:{xs:"100%",md:"40%"},height:"100vh",backdropFilter:"blur(12px)",backgroundColor:v==="light"?"rgba(255, 255, 255, 0.2)":"rgba(18, 18, 18, 0.8)",p:4,display:"flex",flexDirection:"column",justifyContent:"space-between",zIndex:1},children:[n.jsxs(T,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[n.jsx(W,{onClick:()=>h(-1),color:"primary",children:n.jsx(Ps,{sx:{color:"#fff"}})}),n.jsx(W,{onClick:()=>R(p=>p==="light"?"dark":"light"),children:v==="light"?n.jsx(Ls,{sx:{color:"#fff"}}):n.jsx(Fs,{})})]}),m==="/dashboard"&&n.jsx(T,{sx:{display:"flex",justifyContent:"center"},children:n.jsx(F,{variant:"h6",children:"You are not logged in, Kindly Login."})}),n.jsxs(T,{children:[n.jsx(T,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:n.jsxs(T,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsx(W,{size:"small",color:"primary",children:n.jsx(Es,{sx:{color:"#fff"}})}),n.jsx(F,{variant:"h6",children:"Crystal Land Academy"})]})}),n.jsx(F,{variant:"h4",sx:{mb:2},children:"Sign in"}),n.jsx("form",{onSubmit:S,children:n.jsxs(bs,{spacing:2,children:[n.jsxs(U,{fullWidth:!0,children:[n.jsx(Be,{id:"role-label",children:"Sign in as"}),n.jsxs(ze,{labelId:"role-label",value:l,label:"Sign in as",onChange:p=>a(p.target.value),required:!0,children:[n.jsx(z,{value:"student",children:"Student"}),n.jsx(z,{value:"teacher",children:"Teacher"}),n.jsx(z,{value:"admin",children:"Admin"})]})]}),n.jsx(U,{fullWidth:!0,children:n.jsx(se,{label:"Email",type:"email",value:o,onChange:p=>r(p.target.value),required:!0})}),n.jsx(U,{fullWidth:!0,children:n.jsx(se,{label:"Password",type:"password",value:i,onChange:p=>d(p.target.value),required:!0})}),s&&n.jsx(F,{color:"error",children:s}),n.jsx(ve,{type:"submit",variant:"contained",color:"primary",isLoading:c||e,fullWidth:!0,children:"Continue"}),n.jsx(Ms,{href:"/forgot-password",underline:"hover",children:"Forgot password?"})]})})]}),n.jsx(T,{sx:{textAlign:"center",mt:3},children:n.jsxs(F,{variant:"body2",children:["© Crystal Land Academy ",new Date().getFullYear()]})})]})]})]})};export{vs as C,Bs as S,hs as T,bs as a,Ze as g,As as u};
