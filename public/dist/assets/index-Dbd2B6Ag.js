import{r as n,j as e,a as Ce}from"./index-BC37bsQa.js";import{t as me,M as ie,D as ae,a as oe,b as re,c as de}from"./modal-GEZs9M28.js";import{H as he}from"./Header-B8AhHNUH.js";import{T as pe}from"./table-B7mrHx2s.js";import{d as xe}from"./Visibility-BnlQ7AwW.js";import{A as De,C as be}from"./confirmationModal-jYsKQ6Iz.js";import{j as ge,v as c,T as i,y as L,x as D,Z as H,$ as V,a0 as Y}from"./TextField-DJHC7RPB.js";import{T as ce}from"./Tooltip-8sJJSA7E.js";import{I as Ie}from"./IconButton-FKrVB40t.js";import{C as Ae}from"./accordion-B4gRbrmF.js";import{M as W}from"./MenuItem-Boxsdccj.js";import{w as ve}from"./dasboardPagesContainer-BPvvQ7M3.js";import"./index-D_NzLyvY.js";import"./useApi-CayfBA9a.js";import"./index-C3bpa2xi.js";import"./loadingButton-DWigVCde.js";import"./CircularProgress-D3qA5W-A.js";import"./crystal-land-log-removebg-DVF-nlbN.js";import"./useSlot-Br8NJCec.js";import"./useMediaQuery-BLrmJgPF.js";const ye=[{id:"asst_1",title:"Algebra Worksheet",dueDate:"2025-06-10",description:"Solve 20 algebra problems covering linear equations.",submissions:[{studentId:"stu_1"}]},{id:"asst_2",title:"English Essay",dueDate:"2025-06-12",description:"Write a 500-word essay on Shakespeare’s Macbeth.",submissions:[]},{id:"asst_3",title:"Science Lab Report",dueDate:"2025-06-15",description:"Submit a report on the recent chemistry experiment.",submissions:[{studentId:"stu_2"}]},{id:"asst_4",title:"History Timeline",dueDate:"2025-06-17",description:"Create a timeline of World War II events.",submissions:[]},{id:"asst_5",title:"PE Fitness Plan",dueDate:"2025-06-20",description:"Design a personal fitness plan for the semester.",submissions:[{studentId:"stu_1"}]}],we=()=>{const I=ge();me(I.palette.mode);const[A]=n.useState(ye),[l,f]=n.useState(null),[p,E]=n.useState(!1),[v,x]=n.useState(!1),[j,y]=n.useState(!1),[u,w]=n.useState(null),[O,M]=n.useState("id"),[$,_]=n.useState("asc"),[q,b]=n.useState(0),[J,T]=n.useState(5),[a,r]=n.useState({error:null,message:null}),h="stu_1",P=A.map((t,m)=>({id:m+1,title:t.title,dueDate:t.dueDate?new Date(t.dueDate).toLocaleDateString():"N/A",description:String(t.description||"N/A"),assignmentId:t.id,hasSubmitted:t.submissions.some(d=>d.studentId===h)})),g=(t=null)=>{f(t),E(!0)},k=()=>{E(!1),f(null)},F=(t=null)=>{f(t),y(!0)},R=()=>{y(!1),w(null),f(null)},B=()=>{x(!1),r({error:null,message:null})},z=t=>{w(t.target.files[0])},U=t=>{u?(setAssignments(m=>m.map(d=>d.id===t?{...d,submissions:[...d.submissions,{studentId:h}]}:d)),r({error:null,message:"Assignment submitted successfully!"}),x(!0)):(r({error:"No file selected",message:null}),x(!0)),R()},C=t=>{u?(setAssignments(m=>m.map(d=>d.id===t?{...d,submissions:[...d.submissions.filter(Q=>Q.studentId!==h),{studentId:h}]}:d)),r({error:null,message:"Assignment resubmitted successfully!"}),x(!0)):(r({error:"No file selected",message:null}),x(!0)),R()},K={columns:[{id:"id",label:"ID",flex:.5},{id:"title",label:"Title",flex:1,renderCell:t=>e.jsx(i,{children:String(t.title||"N/A")})},{id:"dueDate",label:"Due Date",flex:1,renderCell:t=>e.jsx(i,{children:t.dueDate||"N/A"})},{id:"description",label:"Description",flex:2,renderCell:t=>e.jsx(i,{children:String(t.description||"N/A")})},{id:"actions",label:"Actions",flex:1,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:"View assignment",children:e.jsx(Ie,{onClick:()=>g(t),children:e.jsx(xe,{})})}),e.jsx(ce,{title:t.hasSubmitted?"Resubmit assignment":"Submit assignment",children:e.jsx(D,{onClick:()=>F(t),variant:"contained",color:"primary",children:t.hasSubmitted?"Resubmit":"Submit"})})]})}],tableHeader:"Overview of Assignments",data:P,sortBy:O,sortDirection:$,onSortChange:t=>{_(O===t&&$==="asc"?"desc":"asc"),M(t)},page:q,rowsPerPage:J,onPageChange:(t,m)=>{b(m)},onRowsPerPageChange:t=>{T(parseInt(t.target.value,10)),b(0)},onRowClick:t=>{console.log("Row clicked:",t)},hiddenColumnsSmallScreen:["dueDate","description"]};return e.jsxs(c,{children:[e.jsx(he,{title:"ASSIGNMENTS",subtitle:"Overview of Assignments"}),e.jsx(c,{height:"75vh",children:e.jsx(pe,{...K})}),e.jsx(ie,{open:p,onClose:k,title:"View Assignment Details",onConfirm:k,children:l&&e.jsxs(c,{children:[e.jsxs(i,{variant:"h6",children:["Title: ",l.title]}),e.jsxs(i,{variant:"body1",children:["Due Date: ",l.dueDate]}),e.jsxs(i,{variant:"body2",children:["Description: ",l.description]})]})}),e.jsx(ie,{open:j,onClose:R,title:`Submit assignment for ${l==null?void 0:l.title}`,noConfirm:!0,children:e.jsxs(c,{display:"flex",children:[e.jsx(L,{type:"file",onChange:z,fullWidth:!0}),e.jsx(De,{onClick:()=>l!=null&&l.hasSubmitted?C(l==null?void 0:l.assignmentId):U(l==null?void 0:l.assignmentId),content:l!=null&&l.hasSubmitted?"Resubmit":"Submit",sx:{margin:"10px"}})]})}),e.jsx(be,{open:v,onClose:B,isLoading:!1,title:"Assignment Submission Confirmation",message:a.message||a.error})]})},Me=[{id:"asst_1",session:"2024-2025",term:"First Term",classId:"class_1",title:"Algebra Worksheet",dueDate:"2024-09-10",description:"Solve 20 algebra problems covering linear equations.",submissions:[{studentId:"stu_1",name:"John Doe",cloudinaryLink:"https://res.cloudinary.com/demo/sample.pdf",submissionDate:"2024-09-08",comments:[{id:"comm_1",text:"Good work, but check problem 5.",date:"2024-09-09"}]}]},{id:"asst_2",session:"2024-2025",term:"First Term",classId:"class_2",title:"English Essay",dueDate:"2024-09-12",description:"Write a 500-word essay on Shakespeare’s Macbeth.",submissions:[]},{id:"asst_3",session:"2024-2025",term:"Second Term",classId:"class_1",title:"Science Lab Report",dueDate:"2025-01-15",description:"Submit a report on the recent chemistry experiment.",submissions:[{studentId:"stu_2",name:"Jane Smith",cloudinaryLink:"https://res.cloudinary.com/demo/lab_report.pdf",submissionDate:"2025-01-13",comments:[]}]},{id:"asst_4",session:"2024-2025",term:"Second Term",classId:"class_2",title:"History Timeline",dueDate:"2025-01-17",description:"Create a timeline of World War II events.",submissions:[]}],G=[{classId:"class_1",name:"Primary 1A",session:"2024-2025"},{classId:"class_2",name:"Secondary 1B",session:"2024-2025"}],ue=["2024-2025","2025-2026"],X=["First Term","Second Term","Third Term"],Te=()=>{var le;const I=ge(),A=me(I.palette.mode),[l,f]=n.useState(Me),[p,E]=n.useState(ue[0]),[v,x]=n.useState(X[0]),[j,y]=n.useState(""),[u,w]=n.useState(null),[O,M]=n.useState(!1),[$,_]=n.useState(!1),[q,b]=n.useState(!1),[J,T]=n.useState(""),[a,r]=n.useState({title:"",dueDate:"",description:"",classId:""}),[h,P]=n.useState(""),[g,k]=n.useState(null),[F,R]=n.useState("id"),[B,z]=n.useState("asc"),[U,C]=n.useState(0),[ee,se]=n.useState(5),Z=l.filter(s=>s.session===p&&s.term===v&&(!j||s.classId===j)).map((s,o)=>{var S;return{id:o+1,title:s.title,dueDate:s.dueDate?new Date(s.dueDate).toLocaleDateString():"N/A",description:String(s.description||"N/A"),className:((S=G.find(N=>N.classId===s.classId))==null?void 0:S.name)||"N/A",assignmentId:s.id,submissions:s.submissions}}),te=()=>{if(!a.title||!a.dueDate||!a.description||!a.classId){T("Please fill all fields."),b(!0);return}const o={id:`asst_${l.length+1}`,session:p,term:v,classId:a.classId,title:a.title,dueDate:a.dueDate,description:a.description,submissions:[]};f([...l,o]),T("Assignment added successfully!"),b(!0),r({title:"",dueDate:"",description:"",classId:""}),M(!1)},ne=s=>{if(!h.trim()){T("Comment cannot be empty."),b(!0);return}const o=l.map(S=>S.id===u.assignmentId?{...S,submissions:S.submissions.map(N=>N.studentId===s.studentId?{...N,comments:[...N.comments,{id:`comm_${S.submissions.reduce((fe,je)=>fe+je.comments.length,0)+1}`,text:h,date:new Date().toISOString().split("T")[0]}]}:N)}:S);f(o),P(""),T("Comment added successfully!"),b(!0)},K=[{id:"id",label:"ID",flex:.5},{id:"title",label:"Title",flex:1,renderCell:s=>e.jsx(i,{children:String(s.title||"N/A")})},{id:"className",label:"Class",flex:1,renderCell:s=>e.jsx(i,{children:s.className})},{id:"dueDate",label:"Due Date",flex:1,renderCell:s=>e.jsx(i,{children:s.dueDate||"N/A"})},{id:"description",label:"Description",flex:2,renderCell:s=>e.jsx(i,{children:String(s.description||"N/A")})},{id:"submissions",label:"Submissions",flex:1,renderCell:s=>e.jsx(i,{children:s.submissions.length>0?`${s.submissions.length} student(s) submitted`:"No submissions"})},{id:"actions",label:"Actions",flex:1,renderCell:s=>e.jsx(D,{variant:"contained",color:"primary",size:"small",onClick:()=>{w(s),_(!0)},startIcon:e.jsx(xe,{}),children:"View"})}],t=s=>{z(F===s&&B==="asc"?"desc":"asc"),R(s)},m=(s,o)=>{C(o)},d=s=>{se(parseInt(s.target.value,10)),C(0)},Q=s=>{console.log("Row clicked:",s)},Se={columns:K,tableHeader:`Assignments for ${p}, ${v}${j?`, ${(le=G.find(s=>s.classId===j))==null?void 0:le.name}`:""}`,data:Z,sortBy:F,sortDirection:B,onSortChange:t,page:U,rowsPerPage:ee,onPageChange:m,onRowsPerPageChange:d,onRowClick:Q,hiddenColumnsSmallScreen:["description","submissions"]};return e.jsxs(c,{py:"20px",children:[e.jsx(he,{title:"TEACHER ASSIGNMENTS",subtitle:"Manage Assignments for Classes"}),e.jsxs(c,{mb:"20px",display:"flex",gap:"20px",alignItems:"center",children:[e.jsxs(H,{sx:{minWidth:150},children:[e.jsx(V,{id:"session-select-label",children:"Session"}),e.jsx(Y,{labelId:"session-select-label",value:p,label:"Session",onChange:s=>{E(s.target.value),x(X[0]),y(""),C(0)},children:ue.map(s=>e.jsx(W,{value:s,children:s},s))})]}),e.jsxs(H,{sx:{minWidth:150},children:[e.jsx(V,{id:"term-select-label",children:"Term"}),e.jsx(Y,{labelId:"term-select-label",value:v,label:"Term",onChange:s=>{x(s.target.value),y(""),C(0)},children:X.map(s=>e.jsx(W,{value:s,children:s},s))})]}),e.jsxs(H,{sx:{minWidth:150},children:[e.jsx(V,{id:"class-select-label",children:"Class"}),e.jsxs(Y,{labelId:"class-select-label",value:j,label:"Class",onChange:s=>{y(s.target.value),C(0)},children:[e.jsx(W,{value:"",children:"All Classes"}),G.filter(s=>s.session===p).map(s=>e.jsx(W,{value:s.classId,children:s.name},s.classId))]})]}),e.jsx(D,{variant:"contained",color:"secondary",onClick:()=>M(!0),sx:{ml:"auto"},children:"Add Assignment"})]}),e.jsx(c,{children:Z.length>0?e.jsx(pe,{...Se}):e.jsx(i,{children:"No assignments available for the selected filters."})}),e.jsxs(ae,{open:O,onClose:()=>{M(!1),r({title:"",dueDate:"",description:"",classId:""})},children:[e.jsx(oe,{children:"Add New Assignment"}),e.jsx(re,{children:e.jsxs(c,{display:"flex",flexDirection:"column",gap:"16px",mt:"10px",children:[e.jsxs(H,{fullWidth:!0,children:[e.jsx(V,{id:"add-class-select-label",children:"Class"}),e.jsx(Y,{labelId:"add-class-select-label",value:a.classId,label:"Class",onChange:s=>r({...a,classId:s.target.value}),children:G.filter(s=>s.session===p).map(s=>e.jsx(W,{value:s.classId,children:s.name},s.classId))})]}),e.jsx(L,{label:"Title",value:a.title,onChange:s=>r({...a,title:s.target.value}),fullWidth:!0}),e.jsx(L,{label:"Due Date (YYYY-MM-DD)",value:a.dueDate,onChange:s=>r({...a,dueDate:s.target.value}),fullWidth:!0}),e.jsx(L,{label:"Description",value:a.description,onChange:s=>r({...a,description:s.target.value}),multiline:!0,rows:4,fullWidth:!0})]})}),e.jsxs(de,{children:[e.jsx(D,{onClick:()=>{M(!1),r({title:"",dueDate:"",description:"",classId:""})},children:"Cancel"}),e.jsx(D,{onClick:te,color:"primary",disabled:!a.title||!a.dueDate||!a.description||!a.classId,children:"Add"})]})]}),e.jsxs(ae,{open:$,onClose:()=>{_(!1),w(null),k(null),P("")},children:[e.jsx(oe,{children:"Assignment Details"}),e.jsx(re,{children:u&&e.jsxs(c,{display:"flex",flexDirection:"column",gap:"16px",children:[e.jsxs(i,{variant:"h6",children:["Title: ",u.title]}),e.jsxs(i,{variant:"body1",children:["Class: ",u.className]}),e.jsxs(i,{variant:"body1",children:["Due Date: ",u.dueDate]}),e.jsxs(i,{variant:"body2",children:["Description: ",u.description]}),e.jsx(i,{variant:"h6",sx:{mt:2},children:"Submissions"}),u.submissions.length>0?u.submissions.map(s=>e.jsx(Ae,{title:`${s.name} (Submitted: ${new Date(s.submissionDate).toLocaleDateString()})`,details:e.jsxs(c,{display:"flex",flexDirection:"column",gap:"16px",children:[e.jsxs(i,{variant:"body1",children:["Submission Link:"," ",e.jsx("a",{href:s.cloudinaryLink,target:"_blank",rel:"noopener noreferrer",style:{color:A.blueAccent[500]},children:"View Submission"})]}),e.jsxs(i,{variant:"body2",children:["Submitted on: ",new Date(s.submissionDate).toLocaleDateString()]}),e.jsxs(c,{children:[e.jsx(i,{variant:"h6",children:"Comments"}),s.comments.length>0?s.comments.map(o=>e.jsxs(c,{sx:{mb:1},children:[e.jsx(i,{variant:"body2",children:o.text}),e.jsx(i,{variant:"caption",color:A.grey[500],children:new Date(o.date).toLocaleDateString()})]},o.id)):e.jsx(i,{variant:"body2",children:"No comments yet."})]}),e.jsxs(c,{children:[e.jsx(L,{label:"Add Comment",value:(g==null?void 0:g.studentId)===s.studentId?h:"",onChange:o=>{k(s),P(o.target.value)},fullWidth:!0,multiline:!0,rows:2,sx:{mb:2}}),e.jsx(D,{variant:"contained",color:"primary",onClick:()=>ne(s),disabled:!h.trim()||(g==null?void 0:g.studentId)!==s.studentId,children:"Add Comment"})]})]}),defaultExpanded:!1},s.studentId)):e.jsx(i,{children:"No submissions"})]})}),e.jsx(de,{children:e.jsx(D,{onClick:()=>{_(!1),w(null),k(null),P("")},children:"Close"})})]}),e.jsx(be,{open:q,onClose:()=>b(!1),isLoading:!1,title:"Assignment Action",message:J})]})},Pe=()=>{const I=Ce(l=>l.users.user),A=I.role;return e.jsx("div",{children:A==="student"?e.jsx(we,{}):e.jsx(Te,{babtechUser:I})})},Ke=ve(Pe);export{Ke as default};
