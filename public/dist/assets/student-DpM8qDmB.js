import{r as c,j as e}from"./index-Dia3dXnv.js";import{t as he,D as xe,a as be,b as je,c as Se}from"./modal-CRceNtXl.js";import{H as _e}from"./Header-BKDrWR6o.js";import{T as ge}from"./table-BuC3jVNb.js";import{C as Ie}from"./accordion-DCS8W_7Y.js";import{C as ye}from"./confirmationModal-CIDTnzxs.js";import{g as Y,a as $,u as Z,_ as z,az as Ce,aA as ve,b as v,s as F,d as G,e as P,c as ee,a4 as se,aa as Re,h as E,i as Te,af as we,o as Me,K as ke,j as Ne,v as M,a1 as J,a2 as Ae,a3 as qe,T as f,x as B}from"./TextField-CiACpH9R.js";import{M as Fe}from"./MenuItem-9u3wVos-.js";import{S as Be,F as Ee}from"./FormControlLabel-0VzAR65E.js";import"./IconButton-BeQuUMyU.js";import"./index-HCkcCK1E.js";import"./index-B_m23NjE.js";import"./loadingButton-Dn6lZ4mI.js";import"./CircularProgress-Du6yAQTu.js";import"./useApi-CcDc2KeG.js";import"./crystal-land-log-removebg-DVF-nlbN.js";import"./useSlot-BVdpsmmF.js";import"./useMediaQuery-D2Chhg5w.js";function Ye(s){return Y("MuiFormGroup",s)}$("MuiFormGroup",["root","row","error"]);const $e=["className","row"],ze=s=>{const{classes:o,row:a,error:n}=s;return P({root:["root",a&&"row",n&&"error"]},Ye,o)},Ge=F("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:a}=s;return[o.root,a.row&&o.row]}})(({ownerState:s})=>v({display:"flex",flexDirection:"column",flexWrap:"wrap"},s.row&&{flexDirection:"row"})),Pe=c.forwardRef(function(o,a){const n=Z({props:o,name:"MuiFormGroup"}),{className:d,row:j=!1}=n,R=z(n,$e),u=Ce(),h=ve({props:n,muiFormControl:u,states:["error"]}),S=v({},n,{row:j,error:h.error}),_=ze(S);return e.jsx(Ge,v({className:G(_.root,d),ownerState:S,ref:a},R))}),De=ee(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),Oe=ee(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),Ue=F("span",{name:"MuiRadioButtonIcon",shouldForwardProp:se})({position:"relative",display:"flex"}),We=F(De,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),Le=F(Oe,{name:"MuiRadioButtonIcon"})(({theme:s,ownerState:o})=>v({left:0,position:"absolute",transform:"scale(0)",transition:s.transitions.create("transform",{easing:s.transitions.easing.easeIn,duration:s.transitions.duration.shortest})},o.checked&&{transform:"scale(1)",transition:s.transitions.create("transform",{easing:s.transitions.easing.easeOut,duration:s.transitions.duration.shortest})}));function te(s){const{checked:o=!1,classes:a={},fontSize:n}=s,d=v({},s,{checked:o});return e.jsxs(Ue,{className:a.root,ownerState:d,children:[e.jsx(We,{fontSize:n,className:a.background,ownerState:d}),e.jsx(Le,{fontSize:n,className:a.dot,ownerState:d})]})}const oe=c.createContext(void 0);function He(){return c.useContext(oe)}function Ve(s){return Y("MuiRadio",s)}const Q=$("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Je=["checked","checkedIcon","color","icon","name","onChange","size","className"],Qe=s=>{const{classes:o,color:a,size:n}=s,d={root:["root",`color${E(a)}`,n!=="medium"&&`size${E(n)}`]};return v({},o,P(d,Ve,o))},Ke=F(Be,{shouldForwardProp:s=>se(s)||s==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:a}=s;return[o.root,a.size!=="medium"&&o[`size${E(a.size)}`],o[`color${E(a.color)}`]]}})(({theme:s,ownerState:o})=>v({color:(s.vars||s).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:s.vars?`rgba(${o.color==="default"?s.vars.palette.action.activeChannel:s.vars.palette[o.color].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:Te(o.color==="default"?s.palette.action.active:s.palette[o.color].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.color!=="default"&&{[`&.${Q.checked}`]:{color:(s.vars||s).palette[o.color].main}},{[`&.${Q.disabled}`]:{color:(s.vars||s).palette.action.disabled}}));function Xe(s,o){return typeof o=="object"&&o!==null?s===o:String(s)===String(o)}const K=e.jsx(te,{checked:!0}),X=e.jsx(te,{}),Ze=c.forwardRef(function(o,a){var n,d;const j=Z({props:o,name:"MuiRadio"}),{checked:R,checkedIcon:u=K,color:h="primary",icon:S=X,name:_,onChange:g,size:I="medium",className:x}=j,y=z(j,Je),p=v({},j,{color:h,size:I}),C=Qe(p),T=He();let l=R;const k=Re(g,T&&T.onChange);let q=_;return T&&(typeof l>"u"&&(l=Xe(T.value,j.value)),typeof q>"u"&&(q=T.name)),e.jsx(Ke,v({type:"radio",icon:c.cloneElement(S,{fontSize:(n=X.props.fontSize)!=null?n:I}),checkedIcon:c.cloneElement(u,{fontSize:(d=K.props.fontSize)!=null?d:I}),ownerState:p,classes:C,name:q,checked:l,onChange:k,ref:a,className:G(C.root,x)},y))});function es(s){return Y("MuiRadioGroup",s)}$("MuiRadioGroup",["root","row","error"]);const ss=["actions","children","className","defaultValue","name","onChange","value"],ts=s=>{const{classes:o,row:a,error:n}=s;return P({root:["root",a&&"row",n&&"error"]},es,o)},os=c.forwardRef(function(o,a){const{actions:n,children:d,className:j,defaultValue:R,name:u,onChange:h,value:S}=o,_=z(o,ss),g=c.useRef(null),I=ts(o),[x,y]=we({controlled:S,default:R,name:"RadioGroup"});c.useImperativeHandle(n,()=>({focus:()=>{let l=g.current.querySelector("input:not(:disabled):checked");l||(l=g.current.querySelector("input:not(:disabled)")),l&&l.focus()}}),[]);const p=Me(a,g),C=ke(u),T=c.useMemo(()=>({name:C,onChange(l){y(l.target.value),h&&h(l,l.target.value)},value:x}),[C,h,y,x]);return e.jsx(oe.Provider,{value:T,children:e.jsx(Pe,v({role:"radiogroup",ref:p,className:G(I.root,j)},_,{children:d}))})}),b={academicYears:[{_id:"year_1",name:"2023–2024"},{_id:"year_2",name:"2024–2025"}],classes:[{_id:"class_1",academicYearId:"year_2",section:"Primary",displayName:"Primary 1A",students:["stu_1","stu_2"],subjectsTaught:["Mathematics","English"]},{_id:"class_2",academicYearId:"year_2",section:"Secondary",displayName:"Secondary 1B",students:["stu_3"],subjectsTaught:["Science"]}],students:[{_id:"stu_1",firstName:"John",lastName:"Doe",classId:"class_1",subjects:["Mathematics","English"]},{_id:"stu_2",firstName:"Jane",lastName:"Smith",classId:"class_1",subjects:["Mathematics"]},{_id:"stu_3",firstName:"Alice",lastName:"Brown",classId:"class_2",subjects:["Science"]}],testQuestions:[{id:"q_1",classId:"class_1",subject:"Mathematics",question:"What is the solution to 2x + 3 = 7?",options:["x = 1","x = 2","x = 3","x = 4"],correctAnswer:"x = 2"},{id:"q_2",classId:"class_1",subject:"Mathematics",question:"What is 3 + 5?",options:["6","7","8","9"],correctAnswer:"8"},{id:"q_3",classId:"class_1",subject:"English",question:'What is a synonym for "happy"?',options:["Sad","Joyful","Angry","Tired"],correctAnswer:"Joyful"},{id:"q_4",classId:"class_1",subject:"English",question:'What is the past tense of "run"?',options:["Ran","Run","Running","Runs"],correctAnswer:"Ran"},{id:"q_5",classId:"class_2",subject:"Science",question:"What gas do plants absorb during photosynthesis?",options:["Oxygen","Nitrogen","Carbon Dioxide","Hydrogen"],correctAnswer:"Carbon Dioxide"},{id:"q_6",classId:"class_2",subject:"Science",question:"What is the chemical symbol for water?",options:["H2O","CO2","O2","N2"],correctAnswer:"H2O"}],tests:[{id:"test_1",classId:"class_1",subject:"Mathematics",questionIds:["q_1","q_2"],duration:300},{id:"test_2",classId:"class_1",subject:"English",questionIds:["q_3","q_4"],duration:300},{id:"test_3",classId:"class_2",subject:"Science",questionIds:["q_5","q_6"],duration:300}],testScores:[{id:"score_1",testId:"test_1",studentId:"stu_1",score:100,date:"2024-09-20",academicYearId:"year_2"},{id:"score_2",testId:"test_2",studentId:"stu_1",score:50,date:"2024-09-21",academicYearId:"year_2"}],examScores:[{id:"exam_1",studentId:"stu_1",subject:"Mathematics",score:85,academicYearId:"year_2",term:"First Term"},{id:"exam_2",studentId:"stu_1",subject:"English",score:90,academicYearId:"year_2",term:"First Term"},{id:"exam_3",studentId:"stu_1",subject:"Mathematics",score:80,academicYearId:"year_1",term:"First Term"}]},Is=()=>{var W;const s=Ne();he(s.palette.mode);const o="stu_1",a=b.students.find(t=>t._id===o),[n,d]=c.useState("year_2"),[j,R]=c.useState(!1),[u,h]=c.useState(null),[S,_]=c.useState({}),[g,I]=c.useState(0),[x,y]=c.useState(!1),[p,C]=c.useState(!1),[T,l]=c.useState(null),[k,q]=c.useState(b.testScores),[ae,D]=c.useState(!1),[re,ne]=c.useState("");c.useEffect(()=>{let t;return x&&g>0&&!p&&(t=setInterval(()=>{I(r=>r<=1?(O(),0):r-1)},1e3)),()=>clearInterval(t)},[x,g,p]);const N=b.classes.find(t=>t.students.includes(o)),ce=b.tests.filter(t=>t.classId===(N==null?void 0:N._id)&&a.subjects.includes(t.subject)),ie=t=>{const r=b.tests.filter(i=>i.classId===(N==null?void 0:N._id)&&a.subjects.includes(i.subject)),m=k.filter(i=>i.studentId===o&&i.academicYearId===t),A=b.examScores.filter(i=>i.studentId===o&&i.academicYearId===t);return a.subjects.map(i=>{var H,V;const me=r.filter(w=>w.subject===i),pe=m.filter(w=>me.some(fe=>fe.id===w.testId)),L=A.filter(w=>w.subject===i);return{subject:i,testScores:pe.map(w=>({testId:w.testId,score:w.score,date:new Date(w.date).toLocaleDateString()})),examScore:((H=L[0])==null?void 0:H.score)||"N/A",examTerm:((V=L[0])==null?void 0:V.term)||"N/A"}})},le=t=>{h(t),I(t.duration),_({}),y(!1),C(!1),l(null),R(!0)},de=(t,r)=>{_(m=>({...m,[t]:r}))},O=()=>{if(!x||p)return;let t=0;const r=b.testQuestions.filter(i=>u.questionIds.includes(i.id));r.forEach(i=>{S[i.id]===i.correctAnswer&&(t+=1)});const m=t/r.length*100;l(m),C(!0),y(!1);const A={id:`score_${k.length+1}`,testId:u.id,studentId:o,score:m,date:new Date().toISOString().split("T")[0],academicYearId:n};q([...k,A]),ne(`Test submitted! Your score: ${m}%`),D(!0)},ue=[{id:"subject",label:"Subject",flex:2},{id:"tests",label:"Available Tests",flex:2,renderCell:t=>e.jsx(f,{children:t.tests.length>0?`${t.tests.length} test(s) available`:"No tests available"})},{id:"actions",label:"Actions",flex:1,renderCell:t=>e.jsx(B,{variant:"contained",color:"primary",size:"small",onClick:()=>le(t.tests[0]),disabled:t.tests.length===0||k.some(r=>{var m;return r.testId===((m=t.tests[0])==null?void 0:m.id)}),children:"Take Test"})}],U=a.subjects.map((t,r)=>({id:r+1,subject:t,tests:ce.filter(m=>m.subject===t)}));return e.jsxs(M,{py:"20px",children:[e.jsx(_e,{title:"STUDENT TESTS & EXAMS",subtitle:"Take Tests and View Scores"}),e.jsxs(M,{mb:"20px",children:[e.jsxs(J,{sx:{minWidth:200,mb:3},children:[e.jsx(Ae,{id:"academic-year-select-label",children:"Academic Year"}),e.jsx(qe,{labelId:"academic-year-select-label",value:n,label:"Academic Year",onChange:t=>d(t.target.value),children:b.academicYears.map(t=>e.jsx(Fe,{value:t._id,children:t.name},t._id))})]}),e.jsx(f,{variant:"h5",sx:{mb:2},children:"Subjects and Tests"}),U.length>0?e.jsx(ge,{columns:ue,tableHeader:`Subjects for ${(W=b.academicYears.find(t=>t._id===n))==null?void 0:W.name}`,data:U,page:0,rowsPerPage:5,sortBy:"subject",sortDirection:"asc",hiddenColumnsSmallScreen:["tests"]}):e.jsx(f,{children:"No subjects assigned."}),e.jsx(f,{variant:"h5",sx:{mt:4,mb:2},children:"Scores Breakdown"}),b.academicYears.map(t=>e.jsx(Ie,{title:t.name,details:e.jsx(M,{children:ie(t._id).map((r,m)=>e.jsxs(M,{sx:{mb:2},children:[e.jsx(f,{variant:"h6",children:r.subject}),e.jsx(f,{variant:"body1",children:"Test Scores:"}),r.testScores.length>0?e.jsx("ul",{children:r.testScores.map((A,i)=>e.jsx("li",{children:e.jsxs(f,{variant:"body2",children:["Test ",i+1,": ",A.score,"% (",A.date,")"]})},i))}):e.jsx(f,{variant:"body2",children:"No test scores available."}),e.jsxs(f,{variant:"body1",sx:{mt:1},children:["Exam Score: ",r.examScore," ",r.examScore!=="N/A"?`(${r.examTerm})`:""]})]},m))}),defaultExpanded:t._id===n},t._id))]}),e.jsxs(xe,{open:j,onClose:()=>{R(!1),h(null),_({}),I(0),y(!1),C(!1),l(null)},children:[e.jsxs(be,{children:[u==null?void 0:u.subject," Test",x&&!p&&e.jsxs(f,{variant:"body2",display:"inline",sx:{ml:2},children:["Time Left: ",Math.floor(g/60),":",(g%60).toString().padStart(2,"0")]})]}),e.jsxs(je,{children:[u&&!p&&e.jsxs(M,{display:"flex",flexDirection:"column",gap:"16px",children:[b.testQuestions.filter(t=>u.questionIds.includes(t.id)).map(t=>e.jsxs(M,{children:[e.jsx(f,{variant:"body1",sx:{mb:1},children:t.question}),e.jsx(J,{component:"fieldset",children:e.jsx(os,{value:S[t.id]||"",onChange:r=>de(t.id,r.target.value),children:t.options.map((r,m)=>e.jsx(Ee,{value:r,control:e.jsx(Ze,{}),label:r,disabled:p},m))})})]},t.id)),!x&&e.jsx(B,{variant:"contained",color:"primary",onClick:()=>y(!0),children:"Start Test"})]}),p&&e.jsxs(M,{children:[e.jsx(f,{variant:"h6",children:"Test Submitted!"}),e.jsxs(f,{variant:"body1",children:["Your Score: ",T,"%"]})]})]}),e.jsxs(Se,{children:[x&&!p&&e.jsx(B,{variant:"contained",color:"primary",onClick:O,disabled:Object.keys(S).length<(u==null?void 0:u.questionIds.length),children:"Submit Test"}),e.jsx(B,{onClick:()=>{R(!1),h(null),_({}),I(0),y(!1),C(!1),l(null)},children:"Close"})]})]}),e.jsx(ye,{open:ae,onClose:()=>D(!1),isLoading:!1,title:"Test Result",message:re})]})};export{Is as default};
