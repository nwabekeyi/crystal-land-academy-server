import{r as b,f as B,j as d}from"./index-BgVW12L4.js";import{H as Re}from"./Header-CogA_8fZ.js";import{a as ke,b as We,T as ht}from"./table-D9OC5aph.js";import{P as He}from"./PieChart-Batz48qO.js";import{C as ft}from"./accordion-D5e2Uz4A.js";import{A as dt}from"./actionButton-Bx_NG6Vl.js";import{X as Fe}from"./nivo-bar-BUUPF7qO.js";import{p as Ee}from"./nivo-line.es-DEtZMq9O.js";import{d as ut}from"./Download-DtIgek1B.js";import{w as Le}from"./dasboardPagesContainer-p6UpWRgj.js";import{E as ze}from"./index-CjZWgTm8.js";import{u as M}from"./useApi-TIUFMcqH.js";import{t as Be}from"./modal-BA-eVLt_.js";import{j as re,v as D,a1 as At,a2 as Tt,a3 as jt,T as H}from"./TextField-NDbbILhh.js";import{C as Me}from"./CircularProgress-ELwt6FEm.js";import{A as Ne}from"./Alert-D4LgS88T.js";import{M as yt}from"./MenuItem-B4LKlkvK.js";import"./useMediaQuery-DmlQxk2V.js";import"./index-D41-9XSs.js";import"./loadingButton-DGhAAS35.js";import"./IconButton-4sz3Qd6x.js";import"./nivo-pie-DayFCmia.js";import"./isEqual-CHJkiDyc.js";import"./_baseIsEqual-CPX2ChVj.js";import"./useSlot-DfBjlVf_.js";import"./_baseForOwn-h0lgWM6z.js";import"./_baseSlice-z0Zd1-Ev.js";import"./confirmationModal-CMKhpNuH.js";import"./crystal-land-log-removebg-DVF-nlbN.js";function ne(e,t,r,a,n){a=a||{};var i=1.15,s=n.internal.scaleFactor,l=n.internal.getFontSize()/s,h=n.getLineHeightFactor?n.getLineHeightFactor():i,o=l*h,f=/\r\n|\r|\n/g,u="",g=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(u=typeof e=="string"?e.split(f):e,g=u.length||1),r+=l*(2-i),a.valign==="middle"?r-=g/2*o:a.valign==="bottom"&&(r-=g*o),a.halign==="center"||a.halign==="right"){var p=l;if(a.halign==="center"&&(p*=.5),u&&g>=1){for(var v=0;v<u.length;v++)n.text(u[v],t-n.getStringUnitWidth(u[v])*p,r),r+=o;return n}t-=n.getStringUnitWidth(e)*p}return a.halign==="justify"?n.text(e,t,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(e,t,r),n}var Jt={},Q=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:Jt=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var a,n,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,h=s.fontName;if(t.font&&(h=t.font),t.fontStyle){l=t.fontStyle;var o=this.getFontList()[h];o&&o.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(o[0]),l=o[0])}if(this.jsPDFDocument.setFont(h,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var f=e.unifyColor(t.fillColor);f&&(a=this.jsPDFDocument).setFillColor.apply(a,f),f=e.unifyColor(t.textColor),f&&(n=this.jsPDFDocument).setTextColor.apply(n,f),f=e.unifyColor(t.lineColor),f&&(i=this.jsPDFDocument).setDrawColor.apply(i,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,a){return this.jsPDFDocument.splitTextToSize(t,r,a)},e.prototype.rect=function(t,r,a,n,i){return this.jsPDFDocument.rect(t,r,a,n,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return Jt||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),Ht=function(e,t){return Ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Ht(e,t)};function ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ht(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var oe=function(e){ie(t,e);function t(r){var a=e.call(this)||this;return a._element=r,a}return t}(Array);function Ie(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Ye(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function xt(e,t,r){r.applyStyles(t,!0);var a=Array.isArray(e)?e:[e],n=a.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return n}function se(e,t,r,a){var n=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:n,lineColor:i});var s=le(n,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),a.y-r.y,s)}function le(e,t){var r=e>0,a=t||t===0;return r&&a?"DF":r?"S":a?"F":null}function Ct(e,t){var r,a,n,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(a=e.top)!==null&&a!==void 0?a:t,right:(n=e.right)!==null&&n!==void 0?n:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function he(e,t){var r=Ct(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Oe(e,t,r,a,n){var i={},s=1.3333333333333333,l=Dt(t,function(R){return n.getComputedStyle(R).backgroundColor});l!=null&&(i.fillColor=l);var h=Dt(t,function(R){return n.getComputedStyle(R).color});h!=null&&(i.textColor=h);var o=_e(a,r);o&&(i.cellPadding=o);var f="borderTopColor",u=s*r,g=a.borderTopWidth;if(a.borderBottomWidth===g&&a.borderRightWidth===g&&a.borderLeftWidth===g){var p=(parseFloat(g)||0)/u;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/u,right:(parseFloat(a.borderRightWidth)||0)/u,bottom:(parseFloat(a.borderBottomWidth)||0)/u,left:(parseFloat(a.borderLeftWidth)||0)/u},i.lineWidth.top||(i.lineWidth.right?f="borderRightColor":i.lineWidth.bottom?f="borderBottomColor":i.lineWidth.left&&(f="borderLeftColor"));var v=Dt(t,function(R){return n.getComputedStyle(R)[f]});v!=null&&(i.lineColor=v);var P=["left","right","center","justify"];P.indexOf(a.textAlign)!==-1&&(i.halign=a.textAlign),P=["middle","bottom","top"],P.indexOf(a.verticalAlign)!==-1&&(i.valign=a.verticalAlign);var x=parseInt(a.fontSize||"");isNaN(x)||(i.fontSize=x/s);var A=$e(a);A&&(i.fontStyle=A);var j=(a.fontFamily||"").toLowerCase();return e.indexOf(j)!==-1&&(i.font=j),i}function $e(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Dt(e,t){var r=fe(e,t);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],i=parseInt(a[4]);return i===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function fe(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:fe(e.parentElement,t):r}function _e(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],a=96/(72/t),n=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(l){return parseInt(l||"0")/a}),s=Ct(i,0);return n>s.top&&(s.top=n),n>s.bottom&&(s.bottom=n),s}function de(e,t,r,a,n){var i,s;a===void 0&&(a=!1),n===void 0&&(n=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var h=Object.keys(e.getFontList()),o=e.scaleFactor(),f=[],u=[],g=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:f,body:u,foot:g};for(var p=0;p<l.rows.length;p++){var v=l.rows[p],P=(s=(i=v==null?void 0:v.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),x=Ke(h,o,r,v,a,n);x&&(P==="thead"?f.push(x):P==="tfoot"?g.push(x):u.push(x))}return{head:f,body:u,foot:g}}function Ke(e,t,r,a,n,i){for(var s=new oe(a),l=0;l<a.cells.length;l++){var h=a.cells[l],o=r.getComputedStyle(h);if(n||o.display!=="none"){var f=void 0;i&&(f=Oe(e,h,t,o,r)),s.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:f,_element:h,content:Ge(h)})}}var u=r.getComputedStyle(a);if(s.length>0&&(n||u.display!=="none"))return s}function Ge(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Xe(e,t,r){for(var a=0,n=[e,t,r];a<n.length;a++){var i=n[a];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function N(e,t,r,a,n){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(i[h]=l[h])}return i}function ue(e,t){var r=new Q(e),a=r.getDocumentOptions(),n=r.getGlobalOptions();Xe(n,a,t);var i=N({},n,a,t),s;typeof window<"u"&&(s=window);var l=qe(n,a,t),h=Ue(n,a,t),o=Je(r,i),f=Ze(r,i,s);return{id:t.tableId,content:f,hooks:h,styles:l,settings:o}}function qe(e,t,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(h){if(h==="columnStyles"){var o=e[h],f=t[h],u=r[h];a.columnStyles=N({},o,f,u)}else{var g=[e,t,r],p=g.map(function(v){return v[h]||{}});a[h]=N({},p[0],p[1],p[2])}},i=0,s=Object.keys(a);i<s.length;i++){var l=s[i];n(l)}return a}function Ue(e,t,r){for(var a=[e,t,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=a;i<s.length;i++){var l=s[i];l.didParseCell&&n.didParseCell.push(l.didParseCell),l.willDrawCell&&n.willDrawCell.push(l.willDrawCell),l.didDrawCell&&n.didDrawCell.push(l.didDrawCell),l.willDrawPage&&n.willDrawPage.push(l.willDrawPage),l.didDrawPage&&n.didDrawPage.push(l.didDrawPage)}return n}function Je(e,t){var r,a,n,i,s,l,h,o,f,u,g,p,v=Ct(t.margin,40/e.scaleFactor()),P=(r=Qe(e,t.startY))!==null&&r!==void 0?r:v.top,x;t.showFoot===!0?x="everyPage":t.showFoot===!1?x="never":x=(a=t.showFoot)!==null&&a!==void 0?a:"everyPage";var A;t.showHead===!0?A="everyPage":t.showHead===!1?A="never":A=(n=t.showHead)!==null&&n!==void 0?n:"everyPage";var j=(i=t.useCss)!==null&&i!==void 0?i:!1,R=t.theme||(j?"plain":"striped"),k=!!t.horizontalPageBreak,Z=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:j,theme:R,startY:P,margin:v,pageBreak:(h=t.pageBreak)!==null&&h!==void 0?h:"auto",rowPageBreak:(o=t.rowPageBreak)!==null&&o!==void 0?o:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:A,showFoot:x,tableLineWidth:(u=t.tableLineWidth)!==null&&u!==void 0?u:0,tableLineColor:(g=t.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:k,horizontalPageBreakRepeat:Z,horizontalPageBreakBehaviour:(p=t.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function Qe(e,t){var r=e.getLastAutoTable(),a=e.scaleFactor(),n=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===n}return typeof t=="number"?t:(t==null||t===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/a:null}function Ze(e,t,r){var a=t.head||[],n=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var l=de(e,t.html,r,s,t.useCss)||{};a=l.head||a,n=l.body||a,i=l.foot||a}else console.error("Cannot parse html in non browser environment")}var h=t.columns||Ve(a,n,i);return{columns:h,head:a,body:n,foot:i}}function Ve(e,t,r){var a=e[0]||t[0]||r[0]||[],n=[];return Object.keys(a).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,l;Array.isArray(a)?l=a[parseInt(i)]:l=a[i],typeof l=="object"&&!Array.isArray(l)&&(s=(l==null?void 0:l.colSpan)||1);for(var h=0;h<s;h++){var o=void 0;Array.isArray(a)?o=n.length:o=i+(h>0?"_".concat(h):"");var f={dataKey:o};n.push(f)}}),n}var Ft=function(){function e(t,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=t.getDocument()}return e}(),ta=function(e){ie(t,e);function t(r,a,n,i,s,l){var h=e.call(this,r,a,l)||this;return h.cell=n,h.row=i,h.column=s,h.section=i.section,h}return t}(Ft),ea=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,a,n,i,s){for(var l=0,h=r;l<h.length;l++){var o=h[l],f=new ta(t,this,a,n,i,s),u=o(f)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],u)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var i=n[a];i(new Ft(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var i=n[a];i(new Ft(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,i){return n+i.wrappedWidth},0);return r}else{var a=this.settings.margin;return t-a.left-a.right}},e}(),ge=function(){function e(t,r,a,n,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof oe&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(a,n){var i;return Math.max(a,((i=r.cells[n.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var a=this;return t.reduce(function(n,i){var s=a.cells[i.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),h=s.padding("vertical"),o=h+l;return o>n?o:n},0)},e}(),ce=function(){function e(t,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(n=t.content)!==null&&n!==void 0?n:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/t*r,i=a*n+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Ct(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),aa=function(){function e(t,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=a}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,a=0,n=t.allRows();a<n.length;a++){var i=n[a],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e}();function ra(e,t){na(e,t);var r=[],a=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),a+=i.width});var n=t.getWidth(e.pageSize().width)-a;n&&(n=Et(r,n,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),n&&(n=Et(r,n,function(i){return i.minWidth})),n=Math.abs(n),!t.settings.horizontalPageBreak&&n>.1/e.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),oa(t),sa(t,e),ia(t)}function na(e,t){var r=e.scaleFactor(),a=t.settings.horizontalPageBreak,n=he(e,t);t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var h=l[s],o=i.cells[h.index];if(o){var f=t.hooks.didParseCell;t.callCellHooks(e,f,o,i,h,null);var u=o.padding("horizontal");o.contentWidth=xt(o.text,o.styles,e)+u;var g=xt(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,e);if(o.minReadableWidth=g+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||a===!0)o.contentWidth>n?(o.minWidth=n,o.wrappedWidth=n):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var p=10/r;o.minWidth=o.styles.minCellWidth||p,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var h=l[s],o=i.cells[h.index];if(o&&o.colSpan===1)h.wrappedWidth=Math.max(h.wrappedWidth,o.wrappedWidth),h.minWidth=Math.max(h.minWidth,o.minWidth),h.minReadableWidth=Math.max(h.minReadableWidth,o.minReadableWidth);else{var f=t.styles.columnStyles[h.dataKey]||t.styles.columnStyles[h.index]||{},u=f.cellWidth||f.minCellWidth;u&&typeof u=="number"&&(h.minWidth=u,h.wrappedWidth=u)}o&&(o.colSpan>1&&!h.minWidth&&(h.minWidth=o.minWidth),o.colSpan>1&&!h.wrappedWidth&&(h.wrappedWidth=o.minWidth))}})}function Et(e,t,r){for(var a=t,n=e.reduce(function(p,v){return p+v.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],l=s.wrappedWidth/n,h=a*l,o=s.width+h,f=r(s),u=o<f?f:o;t-=u-s.width,s.width=u}if(t=Math.round(t*1e10)/1e10,t){var g=e.filter(function(p){return t<0?p.width>r(p):!0});g.length&&(t=Et(g,t,r))}return t}function ia(e){for(var t={},r=1,a=e.allRows(),n=0;n<a.length;n++)for(var i=a[n],s=0,l=e.columns;s<l.length;s++){var h=l[s],o=t[h.index];if(r>1)r--,delete i.cells[h.index];else if(o)o.cell.height+=i.height,r=o.cell.colSpan,delete i.cells[h.index],o.left--,o.left<=1&&delete t[h.index];else{var f=i.cells[h.index];if(!f)continue;if(f.height=i.height,f.rowSpan>1){var u=a.length-n,g=f.rowSpan>u?u:f.rowSpan;t[h.index]={cell:f,left:g,row:i}}}}}function oa(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var a=t[r],n=null,i=0,s=0,l=0;l<e.columns.length;l++){var h=e.columns[l];if(s-=1,s>1&&e.columns[l+1])i+=h.width,delete a.cells[h.index];else if(n){var o=n;delete a.cells[h.index],n=null,o.width=h.width+i}else{var o=a.cells[h.index];if(!o)continue;if(s=o.colSpan,i=0,o.colSpan>1){n=o,i+=h.width;continue}o.width=h.width+i}}}function sa(e,t){for(var r={count:0,height:0},a=0,n=e.allRows();a<n.length;a++){for(var i=n[a],s=0,l=e.columns;s<l.length;s++){var h=l[s],o=i.cells[h.index];if(o){t.applyStyles(o.styles,!0);var f=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=t.splitTextToSize(o.text,f+1/t.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=Qt(o.text,f,o.styles,t,"...");else if(o.styles.overflow==="hidden")o.text=Qt(o.text,f,o.styles,t,"");else if(typeof o.styles.overflow=="function"){var u=o.styles.overflow(o.text,f);typeof u=="string"?o.text=[u]:o.text=u}o.contentHeight=o.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var g=o.contentHeight/o.rowSpan;o.rowSpan>1&&r.count*r.height<g*o.rowSpan?r={height:g,count:o.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>i.height&&(i.height=g)}}r.count--}}function Qt(e,t,r,a,n){return e.map(function(i){return la(i,t,r,a,n)})}function la(e,t,r,a,n){var i=1e4*a.scaleFactor();if(t=Math.ceil(t*i)/i,t>=xt(e,r,a))return e;for(;t<xt(e+n,r,a)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+n}function pe(e,t){var r=new Q(e),a=ha(t,r.scaleFactor()),n=new ea(t,a);return ra(r,n),r.applyStyles(r.userStyles),n}function ha(e,t){var r=e.content,a=da(r.columns);if(r.head.length===0){var n=Zt(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=Zt(a,"foot");n&&r.foot.push(n)}var i=e.settings.theme,s=e.styles;return{columns:a,head:Rt("head",r.head,a,s,i,t),body:Rt("body",r.body,a,s,i,t),foot:Rt("foot",r.foot,a,s,i,t)}}function Rt(e,t,r,a,n,i){var s={},l=t.map(function(h,o){for(var f=0,u={},g=0,p=0,v=0,P=r;v<P.length;v++){var x=P[v];if(s[x.index]==null||s[x.index].left===0)if(p===0){var A=void 0;Array.isArray(h)?A=h[x.index-g-f]:A=h[x.dataKey];var j={};typeof A=="object"&&!Array.isArray(A)&&(j=(A==null?void 0:A.styles)||{});var R=ua(e,x,o,n,a,i,j),k=new ce(A,R,e);u[x.dataKey]=k,u[x.index]=k,p=k.colSpan-1,s[x.index]={left:k.rowSpan-1,times:p}}else p--,g++;else s[x.index].left--,p=s[x.index].times,f++}return new ge(h,o,e,u)});return l}function Zt(e,t){var r={};return e.forEach(function(a){if(a.raw!=null){var n=fa(t,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function fa(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function da(e){return e.map(function(t,r){var a,n;return typeof t=="object"?n=(a=t.dataKey)!==null&&a!==void 0?a:r:n=r,new aa(n,t,r)})}function ua(e,t,r,a,n,i,s){var l=Ye(a),h;e==="head"?h=n.headStyles:e==="body"?h=n.bodyStyles:e==="foot"&&(h=n.footStyles);var o=N({},l.table,l[e],n.styles,h),f=n.columnStyles[t.dataKey]||n.columnStyles[t.index]||{},u=e==="body"?f:{},g=e==="body"&&r%2===0?N({},l.alternateRow,n.alternateRowStyles):{},p=Ie(i),v=N({},p,o,g,u);return N(v,s)}function ga(e,t,r){var a;r===void 0&&(r={});var n=he(e,t),i=new Map,s=[],l=[],h=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?h=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(h=[t.settings.horizontalPageBreakRepeat]),h.forEach(function(g){var p=t.columns.find(function(v){return v.dataKey===g||v.index===g});p&&!i.has(p.index)&&(i.set(p.index,!0),s.push(p.index),l.push(t.columns[p.index]),n-=p.wrappedWidth)});for(var o=!0,f=(a=r==null?void 0:r.start)!==null&&a!==void 0?a:0;f<t.columns.length;){if(i.has(f)){f++;continue}var u=t.columns[f].wrappedWidth;if(o||n>=u)o=!1,s.push(f),l.push(t.columns[f]),n-=u;else break;f++}return{colIndexes:s,columns:l,lastIndex:f-1}}function ca(e,t){for(var r=[],a=0;a<t.columns.length;a++){var n=ga(e,t,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function ve(e,t){var r=t.settings,a=r.startY,n=r.margin,i={x:n.left,y:a},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=a+n.bottom+s;if(r.pageBreak==="avoid"){var h=t.body,o=h.reduce(function(g,p){return g+p.height},0);l+=o}var f=new Q(e);(r.pageBreak==="always"||r.startY!=null&&l>f.pageSize().height)&&(ye(f),i.y=n.top),t.callWillDrawPageHooks(f,i);var u=N({},i);t.startPageNumber=f.pageNumber(),r.horizontalPageBreak?pa(f,t,u,i):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(g){return I(f,t,g,i,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(g,p){var v=p===t.body.length-1;St(f,t,g,v,u,i,t.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(g){return I(f,t,g,i,t.columns)})),se(f,t,u,i),t.callEndPageHooks(f,i),t.finalY=i.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function pa(e,t,r,a){var n=ca(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(o,f){e.applyStyles(e.userStyles),f>0?gt(e,t,r,a,o.columns,!0):Vt(e,t,a,o.columns),va(e,t,r,a,o.columns),kt(e,t,a,o.columns)});else for(var s=-1,l=n[0],h=function(){var o=s;if(l){e.applyStyles(e.userStyles);var f=l.columns;s>=0?gt(e,t,r,a,f,!0):Vt(e,t,a,f),o=te(e,t,s+1,a,f),kt(e,t,a,f)}var u=o-s;n.slice(1).forEach(function(g){e.applyStyles(e.userStyles),gt(e,t,r,a,g.columns,!0),te(e,t,s+1,a,g.columns,u),kt(e,t,a,g.columns)}),s=o};s<t.body.length-1;)h()}function Vt(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&t.head.forEach(function(i){return I(e,t,i,r,a)})}function va(e,t,r,a,n){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var l=s===t.body.length-1;St(e,t,i,l,r,a,n)})}function te(e,t,r,a,n,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),l=-1;return t.body.slice(r,s).forEach(function(h,o){var f=r+o===t.body.length-1,u=me(e,t,f,a);h.canEntireRowFit(u,n)&&(I(e,t,h,a,n),l=r+o)}),l}function kt(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&t.foot.forEach(function(i){return I(e,t,i,r,a)})}function ma(e,t,r){var a=r.getLineHeight(e.styles.fontSize),n=e.padding("vertical"),i=Math.floor((t-n)/a);return Math.max(0,i)}function ya(e,t,r,a){var n={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,l=r.columns;s<l.length;s++){var h=l[s],o=e.cells[h.index];if(o){Array.isArray(o.text)||(o.text=[o.text]);var f=new ce(o.raw,o.styles,o.section);f=N(f,o),f.text=[];var u=ma(o,t,a);o.text.length>u&&(f.text=o.text.splice(u,o.text.length));var g=a.scaleFactor(),p=a.getLineHeightFactor();o.contentHeight=o.getContentHeight(g,p),o.contentHeight>=t&&(o.contentHeight=t,f.styles.minCellHeight-=t),o.contentHeight>e.height&&(e.height=o.contentHeight),f.contentHeight=f.getContentHeight(g,p),f.contentHeight>i&&(i=f.contentHeight),n[h.index]=f}}var v=new ge(e.raw,-1,e.section,n,!0);v.height=i;for(var P=0,x=r.columns;P<x.length;P++){var h=x[P],f=v.cells[h.index];f&&(f.height=v.height);var o=e.cells[h.index];o&&(o.height=e.height)}return v}function xa(e,t,r,a){var n=e.pageSize().height,i=a.settings.margin,s=i.top+i.bottom,l=n-s;t.section==="body"&&(l-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var h=t.getMinimumRowHeight(a.columns,e),o=h<r;if(h>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var f=t.hasRowSpan(a.columns),u=t.getMaxCellHeight(a.columns)>l;return u?(f&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||a.settings.rowPageBreak==="avoid")}function St(e,t,r,a,n,i,s){var l=me(e,t,a,i);if(r.canEntireRowFit(l,s))I(e,t,r,i,s);else if(xa(e,r,l,t)){var h=ya(r,l,t,e);I(e,t,r,i,s),gt(e,t,n,i,s),St(e,t,h,a,n,i,s)}else gt(e,t,n,i,s),St(e,t,r,a,n,i,s)}function I(e,t,r,a,n){a.x=t.settings.margin.left;for(var i=0,s=n;i<s.length;i++){var l=s[i],h=r.cells[l.index];if(!h){a.x+=l.width;continue}e.applyStyles(h.styles),h.x=a.x,h.y=a.y;var o=t.callCellHooks(e,t.hooks.willDrawCell,h,r,l,a);if(o===!1){a.x+=l.width;continue}Sa(e,h,a);var f=h.getTextPos();ne(h.text,f.x,f.y,{halign:h.styles.halign,valign:h.styles.valign,maxWidth:Math.ceil(h.width-h.padding("left")-h.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,h,r,l,a),a.x+=l.width}a.y+=r.height}function Sa(e,t,r){var a=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=le(a.lineWidth,a.fillColor);n&&e.rect(t.x,r.y,t.width,t.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),Ca(e,t,r,a.lineWidth))}function Ca(e,t,r,a){var n,i,s,l;a.top&&(n=r.x,i=r.y,s=r.x+t.width,l=r.y,a.right&&(s+=.5*a.right),a.left&&(n-=.5*a.left),h(a.top,n,i,s,l)),a.bottom&&(n=r.x,i=r.y+t.height,s=r.x+t.width,l=r.y+t.height,a.right&&(s+=.5*a.right),a.left&&(n-=.5*a.left),h(a.bottom,n,i,s,l)),a.left&&(n=r.x,i=r.y,s=r.x,l=r.y+t.height,a.top&&(i-=.5*a.top),a.bottom&&(l+=.5*a.bottom),h(a.left,n,i,s,l)),a.right&&(n=r.x+t.width,i=r.y,s=r.x+t.width,l=r.y+t.height,a.top&&(i-=.5*a.top),a.bottom&&(l+=.5*a.bottom),h(a.right,n,i,s,l));function h(o,f,u,g,p){e.getDocument().setLineWidth(o),e.getDocument().line(f,u,g,p,"S")}}function me(e,t,r,a){var n=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(n+=t.getFootHeight(t.columns)),e.pageSize().height-a.y-n}function gt(e,t,r,a,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(l){return I(e,t,l,a,n)}),t.callEndPageHooks(e,a);var s=t.settings.margin;se(e,t,r,a),ye(e),t.pageNumber++,a.x=s.left,a.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,a),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return I(e,t,l,a,n)}),e.applyStyles(e.userStyles))}function ye(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function ba(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=t[0],n=ue(this,a),i=pe(this,n);return ve(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,a,n){ne(t,r,a,n,this)},e.API.autoTableSetDefaults=function(t){return Q.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){Q.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new Q(this),i=de(n,t,window,r,!1),s=i.head,l=i.body,h=((a=s[0])===null||a===void 0?void 0:a.map(function(o){return o.content}))||[];return{columns:h,rows:l,data:l}}}var Wt;function J(e,t){var r=ue(e,t),a=pe(e,r);ve(e,a)}try{if(typeof window<"u"&&window){var ee=window,ae=ee.jsPDF||((Wt=ee.jspdf)===null||Wt===void 0?void 0:Wt.jsPDF);ae&&ba(ae)}}catch(e){console.error("Could not apply autoTable plugin",e)}const wa=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,a])=>{a&&t.append(r,a)}),t.toString()},Pa=()=>{var Ut;const e=re(),t=b.useMemo(()=>{var c;return Be(((c=e==null?void 0:e.palette)==null?void 0:c.mode)||"light")},[(Ut=e==null?void 0:e.palette)==null?void 0:Ut.mode]),[r,a]=b.useState(0),[n,i]=b.useState("id"),[s,l]=b.useState("asc"),[h,o]=b.useState(0),[f,u]=b.useState(20),[g,p]=b.useState({classPopulations:[],studentToTeacherRatio:"1:0",feePaymentCompliance:0}),[v,P]=b.useState([]),[x,A]=b.useState([]),[j,R]=b.useState({monthlyTrends:[],classParticipation:[]}),[k,Z]=b.useState({avgTeacherWorkload:0,examCompletionRate:0,studentToTeacherRatio:"1:0"}),[W,V]=b.useState(null),[E,G]=b.useState(null),[X,q]=b.useState(""),[$,m]=b.useState([]),[bt,wt]=b.useState([]),[Pt,_]=b.useState([]),[ct,K]=b.useState(null),{loading:pt,data:L,error:tt,callApi:et}=M(),{loading:vt,data:z,error:at,callApi:w}=M(),{loading:mt,data:Y,error:rt,callApi:nt}=M(),{loading:xe,data:it,error:Lt,callApi:zt}=M(),{loading:Se,data:ot,error:Bt,callApi:Mt}=M(),{loading:Ce,data:st,error:Nt,callApi:It}=M(),{loading:be,data:lt,error:Yt,callApi:Ot}=M(),{loading:we,data:O,error:$t,callApi:_t}=M(),{loading:Pe,data:U,error:Kt,callApi:Gt}=M();b.useEffect(()=>{(async()=>{try{await et(`${B.ACADEMIC_YEARS}/minimal`),await w(B.CURRENT_ACADEMIC_TERM),await Gt(`${B.CLASS_LEVEL}`)}catch(y){K(y.message||"Failed to fetch academic years/term/class levels")}})()},[et,w,Gt]),b.useEffect(()=>{W&&_t(`${B.ACADEMIC_TERM}/year/${W}`)},[W,_t]),b.useEffect(()=>{var c;if((L==null?void 0:L.status)==="success"&&((c=L.data)!=null&&c.length)){m(L.data);const y=L.data.find(T=>T.isCurrent)||L.data[0];y!=null&&y._id&&!W&&V(y._id)}},[L,W]),b.useEffect(()=>{var c,y;if((z==null?void 0:z.status)==="success"&&((c=z.data)!=null&&c._id)&&!E&&G(z.data._id),(O==null?void 0:O.status)==="success"&&((y=O.data)!=null&&y.length)){wt(O.data);const T=O.data.find(S=>S.isCurrent)||O.data[0];T!=null&&T._id&&!E&&G(T._id)}},[z,O,E]),b.useEffect(()=>{var c;(U==null?void 0:U.status)==="success"&&((c=U.data)!=null&&c.length)&&_(U.data.map(y=>({id:y._id,name:y.name})))},[U]);const Xt=b.useCallback(async c=>{if(!W)return;const y=wa({academicYearId:W,academicTermId:E});try{switch(c){case 0:await nt(`${B.ANALYTICS}/overview?${y}`);break;case 1:await zt(`${B.ANALYTICS}/class-performance?${y}`);break;case 2:await Mt(`${B.ANALYTICS}/teacher-performance?${y}`);break;case 3:await It(`${B.ANALYTICS}/attendance?${y}`);break;case 4:await Ot(`${B.ANALYTICS}/other-kpis?${y}`);break;default:break}}catch(T){K(T.message||`Failed to fetch analytics data for tab ${c}`)}},[W,E,nt,zt,Mt,It,Ot]);b.useEffect(()=>{(Y==null?void 0:Y.status)==="success"&&p(Y.data),(it==null?void 0:it.status)==="success"&&P(it.data),(ot==null?void 0:ot.status)==="success"&&A(ot.data),(st==null?void 0:st.status)==="success"&&R(st.data),(lt==null?void 0:lt.status)==="success"&&Z(lt.data)},[Y,it,ot,st,lt]),b.useEffect(()=>{const c=[tt,at,rt,Lt,Bt,Nt,Yt,$t,Kt].filter(Boolean);c.length>0?K(c.join("; ")):K(null)},[tt,at,rt,Lt,Bt,Nt,Yt,$t,Kt]),b.useEffect(()=>{W&&Xt(r)},[r,W,E,Xt]);const qt=b.useMemo(()=>{var y;const c=(y=g.classPopulations)==null?void 0:y.reduce((T,S)=>{const F=S.className.split(" ")[0]+" "+S.className.split(" ")[1];return T[F]||(T[F]={className:F,studentCount:0,sn:S.sn}),T[F].studentCount+=S.studentCount||0,T},{});return Object.values(c||{}).map(T=>({id:T.className,label:T.className,value:T.studentCount||0}))},[g.classPopulations]),Ae=b.useMemo(()=>v.map(c=>({class:c.class,Math:c.mathAvg||0,English:c.englishAvg||0})),[v]),Te=b.useMemo(()=>{const c=j.monthlyTrends||[];if(!c.length)return[];const y=j.classParticipation.reduce((S,F)=>{const C=F.class.split(" ")[0]+" "+F.class.split(" ")[1];return S[F.class]=C,S},{});return(X?Object.keys(y).filter(S=>y[S]===X):Object.keys(y)).map(S=>({id:S,data:c.map(F=>({x:F.month,y:F.classes[S]||0}))}))},[j.monthlyTrends,j.classParticipation,X]);return{tabIndex:r,setTabIndex:a,sortBy:n,setSortBy:i,sortDirection:s,setSortDirection:l,page:h,setPage:o,rowsPerPage:f,setRowsPerPage:u,overviewData:g,classPerformanceData:v,teacherPerformanceData:x,attendanceData:j,otherKPIs:k,classPopulationPieData:qt,subjectBarData:Ae,attendanceTrends:Te,academicYears:$,academicTerms:bt,classLevelId:X,classLevels:Pt,academicYearId:W,academicTermId:E,handleAcademicYearChange:c=>{V(c.target.value),G(null),q("")},handleAcademicTermChange:c=>{G(c.target.value),q("")},handleClassLevelChange:c=>{q(c.target.value)},loading:pt||vt||mt||xe||Se||Ce||be||we||Pe,error:ct,handleSortChange:c=>{l(n===c&&s==="asc"?"desc":"asc"),i(c)},handlePageChange:(c,y)=>{o(y)},handleRowsPerPageChange:c=>{u(parseInt(c.target.value,10)),o(0)},handleTabChange:(c,y)=>{a(y),o(0),q("")},handleExportReport:()=>{const c=new ze,y=10,T=c.internal.pageSize.getWidth();let S=y;(()=>{c.setFontSize(16),c.setFont("helvetica","bold");const C=r===0?"School Analytics Overview Report":r===1?"Class Performance Report":r===2?"Teacher Performance Report":r===3?"Attendance Report":"Other KPIs Report";c.text(C,y,S),c.setFontSize(10),c.setFont("helvetica","normal"),c.text(`Generated on: ${new Date().toLocaleDateString()}`,T-y-50,S),S+=10})(),r===0?(J(c,{startY:S,head:[["Class Level","Student Count"]],body:qt.map(C=>[C.label,C.value]),theme:"grid",styles:{fontSize:10}}),S=c.lastAutoTable.finalY+10,c.text(`Student-to-Teacher Ratio: ${g.studentToTeacherRatio}`,y,S),S+=10,c.text(`Fee Payment Compliance: ${g.feePaymentCompliance}%`,y,S)):r===1?J(c,{startY:S,head:[["S/N","Class","Avg Grade","Pass Rate","Math Avg","English Avg","Date"]],body:v.map(C=>[C.sn,C.class,C.avgGrade,C.passRate,C.mathAvg||"N/A",C.englishAvg||"N/A",C.date]),theme:"grid",styles:{fontSize:10}}):r===2?J(c,{startY:S,head:[["S/N","Name","Subject","Attendance Rate","Classes Taught","Date"]],body:x.map(C=>[C.sn,C.name,C.subject,C.attendanceRate,Array.isArray(C.classesTaught)?C.classesTaught.join(", "):C.classesTaught||"N/A",C.date]),theme:"grid",styles:{fontSize:10}}):r===3?(J(c,{startY:S,head:[["S/N","Class","Participation Rate","Date"]],body:j.classParticipation.map(C=>[C.sn,C.class,C.participationRate,C.date]),theme:"grid",styles:{fontSize:10}}),S=c.lastAutoTable.finalY+10,c.text("Monthly Attendance Trends",y,S),S+=10,j.monthlyTrends.forEach(C=>{J(c,{startY:S,head:[[`Month ${C.month}`,"Attendance Rate"]],body:Object.entries(C.classes||{}).map(([je,De])=>[je,De]),theme:"grid",styles:{fontSize:10}}),S=c.lastAutoTable.finalY+10})):r===4&&J(c,{startY:S,head:[["Metric","Value"]],body:[["Average Teacher Workload (Periods/Week)",k.avgTeacherWorkload||0],["Exam Completion Rate (%)",k.examCompletionRate||0],["Student-to-Teacher Ratio",k.studentToTeacherRatio||"1:0"]],theme:"grid",styles:{fontSize:10}}),c.save(`analytics_report_${new Date().toISOString()}.pdf`)},colors:t}},Aa=()=>{var ct,K,pt,L,tt,et,vt,z,at;re();const{tabIndex:e,handleTabChange:t,sortBy:r,sortDirection:a,page:n,rowsPerPage:i,overviewData:s,classPerformanceData:l,teacherPerformanceData:h,attendanceData:o,otherKPIs:f,classPopulationPieData:u,subjectBarData:g,attendanceTrends:p,academicYears:v,academicTerms:P,academicYearId:x,academicTermId:A,classLevelId:j,classLevels:R,handleAcademicYearChange:k,handleAcademicTermChange:Z,handleClassLevelChange:W,loading:V,error:E,handleSortChange:G,handlePageChange:X,handleRowsPerPageChange:q,handleExportReport:$,colors:m}=Pa();console.log(P);const bt=()=>{switch(e){case 0:return[{id:"sn",label:"S/N",sortable:!0},{id:"className",label:"Class Level",sortable:!0},{id:"studentCount",label:"Student Count",sortable:!0}];case 1:return[{id:"sn",label:"S/N",sortable:!0},{id:"class",label:"Class",sortable:!0},{id:"avgGrade",label:"Average Grade",sortable:!0},{id:"passRate",label:"Pass Rate (%)",sortable:!0},{id:"mathAvg",label:"Math Avg",sortable:!0},{id:"englishAvg",label:"English Avg",sortable:!0},{id:"date",label:"Date",sortable:!0}];case 2:return[{id:"sn",label:"S/N",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"subject",label:"Subject",sortable:!0},{id:"attendanceRate",label:"Attendance Rate (%)",sortable:!0},{id:"classesTaught",label:"Classes Taught",sortable:!1},{id:"date",label:"Date",sortable:!0}];case 3:return[{id:"sn",label:"S/N",sortable:!0},{id:"class",label:"Class",sortable:!0},{id:"participationRate",label:"Participation Rate (%)",sortable:!0},{id:"date",label:"Date",sortable:!0}];case 4:return[{id:"metric",label:"Metric",sortable:!0},{id:"value",label:"Value",sortable:!0}];default:return[]}},wt=()=>{switch(e){case 0:return"Class Level Populations";case 1:return"Class Performance";case 2:return"Teacher Performance";case 3:return"Class Participation Rates";case 4:return"Key Performance Indicators";default:return""}},Pt=()=>{switch(e){case 0:return s.classPopulations||[];case 1:return l;case 2:return h.map(w=>({...w,classesTaught:Array.isArray(w.classesTaught)?w.classesTaught.join(", "):w.classesTaught||"N/A"}));case 3:return o.classParticipation;case 4:return[{metric:"Average Teacher Workload (Periods/Week)",value:f.avgTeacherWorkload||0},{metric:"Exam Completion Rate (%)",value:f.examCompletionRate||0},{metric:"Student-to-Teacher Ratio",value:f.studentToTeacherRatio||"1:0"}];default:return[]}},_={columns:bt(),tableHeader:wt(),data:Pt(),sortBy:r,sortDirection:a,onSortChange:G,page:n,rowsPerPage:i,onPageChange:X,onRowsPerPageChange:q};return d.jsxs(D,{children:[d.jsx(Re,{title:"SCHOOL ANALYTICS & REPORTING",subtitle:"Performance metrics for classes, teachers, and attendance"}),V&&d.jsx(D,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:d.jsx(Me,{})}),E&&d.jsx(D,{m:"20px",children:d.jsx(Ne,{severity:"error",children:E})}),!V&&!E&&d.jsxs(d.Fragment,{children:[d.jsxs(D,{display:"flex",gap:2,mb:2,children:[d.jsxs(At,{sx:{minWidth:200},children:[d.jsx(Tt,{children:"Academic Year"}),d.jsx(jt,{value:x||"",onChange:k,label:"Academic Year",children:v.map(w=>d.jsxs(yt,{value:w._id,children:[w.name," ",w.isCurrent&&"(Current)"]},w._id))})]}),d.jsxs(At,{sx:{minWidth:200},children:[d.jsx(Tt,{children:"Academic Term"}),d.jsx(jt,{value:A||"",onChange:Z,label:"Academic Term",disabled:!x,children:P.map(w=>d.jsxs(yt,{value:w._id,children:[w.name," ",w.isCurrent&&"(Current)"]},w._id))})]}),e===3&&d.jsxs(At,{sx:{minWidth:200},children:[d.jsx(Tt,{children:"Class Level"}),d.jsxs(jt,{value:j||"",onChange:W,label:"Class Level",children:[d.jsx(yt,{value:"",children:"All Classes"}),R.map(w=>d.jsx(yt,{value:w.id,children:w.name},w.id))]})]})]}),d.jsx(ke,{value:e,onChange:t,"aria-label":"analytics dashboard tabs",sx:{backgroundColor:((ct=m==null?void 0:m.primary)==null?void 0:ct[400])||"#1F2A44","& .MuiTabs-indicator":{backgroundColor:((K=m==null?void 0:m.blueAccent)==null?void 0:K[700])||"#3da58a"}},children:["Overview","Class Performance","Teacher Performance","Attendance","Other KPIs"].map(w=>{var mt,Y,rt,nt;return d.jsx(We,{label:w,sx:{color:((mt=m==null?void 0:m.grey)==null?void 0:mt[100])||"#fff",textTransform:"none",fontWeight:"bold","&.Mui-selected":{color:((Y=m==null?void 0:m.grey)==null?void 0:Y[100])||"#fff",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.3)",backgroundColor:((rt=m==null?void 0:m.blueAccent)==null?void 0:rt[700])||"#3da58a"},boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)",backgroundColor:((nt=m==null?void 0:m.primary)==null?void 0:nt[400])||"#1F2A44"}},w)})}),d.jsxs(D,{m:"40px 0 0 0",height:"75vh",children:[e===0&&d.jsx(D,{children:d.jsx(ft,{title:"School Overview",details:d.jsxs(D,{children:[d.jsx(H,{variant:"h6",children:"Student Population by Class Level"}),d.jsx(D,{height:"300px",mt:2,children:u.length>0?d.jsx(He,{data:u}):d.jsx(H,{children:"No population data available"})}),d.jsxs(H,{children:["Student-to-Teacher Ratio: ",s.studentToTeacherRatio||"1:0"]}),d.jsxs(H,{children:["Fee Payment Compliance: ",s.feePaymentCompliance||0,"%"]}),((pt=s.classPopulations)==null?void 0:pt.length)>0?d.jsx(ht,{..._}):d.jsx(H,{mt:2,children:"No class population data available"}),d.jsx(dt,{onClick:$,icon:d.jsx(ut,{}),title:"Export Overview Report",sx:{mt:2}})]}),defaultExpanded:!0})}),e===1&&d.jsx(D,{children:d.jsx(ft,{title:"Class Performance Insights",details:d.jsxs(D,{children:[d.jsx(D,{height:"300px",mb:2,children:g.length>0?d.jsx(Fe,{data:g,keys:["Math","English"],indexBy:"class",margin:{top:50,right:130,bottom:50,left:60},padding:.3,colors:{scheme:"nivo"},animate:!0,motionConfig:"default",theme:{axis:{ticks:{text:{fill:((L=m==null?void 0:m.grey)==null?void 0:L[100])||"#fff"}},legend:{text:{fill:((tt=m==null?void 0:m.grey)==null?void 0:tt[100])||"#fff"}}},legends:{text:{fill:((et=m==null?void 0:m.grey)==null?void 0:et[100])||"#fff"}}},axisBottom:{tickSize:5,tickPadding:5,tickRotation:0,legend:"Class",legendPosition:"middle",legendOffset:32},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:"Average Score (%)",legendPosition:"middle",legendOffset:-40},legends:[{dataFrom:"keys",anchor:"bottom-right",direction:"column",justify:!1,translateX:120,translateY:0,itemsSpacing:2,itemWidth:100,itemHeight:20}]}):d.jsx(H,{children:"No class performance data available"})}),l.length>0?d.jsx(ht,{..._}):d.jsx(H,{children:"No class performance data available"}),d.jsx(dt,{onClick:$,icon:d.jsx(ut,{}),title:"Export Class Performance Report",sx:{mt:2}})]}),defaultExpanded:!0})}),e===2&&d.jsx(D,{children:d.jsx(ft,{title:"Teacher Performance Insights",details:d.jsxs(D,{children:[h.length>0?d.jsx(ht,{..._}):d.jsx(H,{children:"No teacher performance data available"}),d.jsx(dt,{onClick:$,icon:d.jsx(ut,{}),title:"Export Teacher Performance Report",sx:{mt:2}})]}),defaultExpanded:!0})}),e===3&&d.jsx(D,{children:d.jsx(ft,{title:"Attendance Trends",details:d.jsxs(D,{children:[d.jsx(D,{height:"300px",mb:2,children:p.length>0?d.jsx(Ee,{data:p,animate:!0,motionConfig:"default",margin:{top:50,right:110,bottom:50,left:60},xScale:{type:"point"},yScale:{type:"linear",min:0,max:100,stacked:!1,reverse:!1},axisBottom:{tickSize:5,tickPadding:5,tickRotation:45,legend:"Month",legendPosition:"middle",legendOffset:36},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:"Attendance Rate (%)",legendPosition:"middle",legendOffset:-40},colors:{scheme:"nivo"},theme:{axis:{ticks:{text:{fill:((vt=m==null?void 0:m.grey)==null?void 0:vt[100])||"#fff"}},legend:{text:{fill:((z=m==null?void 0:m.grey)==null?void 0:z[100])||"#fff"}}},legends:{text:{fill:((at=m==null?void 0:m.grey)==null?void 0:at[100])||"#fff"}}},legends:[{anchor:"bottom-right",direction:"column",justify:!1,translateX:100,translateY:0,itemsSpacing:0,itemWidth:80,itemHeight:20}],pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},enablePoints:!0,enableGridX:!1,enableGridY:!0}):d.jsx(H,{children:"No attendance trends available"})}),o.classParticipation.length>0?d.jsx(ht,{..._}):d.jsx(H,{children:"No class participation data available"}),d.jsx(dt,{onClick:$,icon:d.jsx(ut,{}),title:"Export Attendance Report",sx:{mt:2}})]}),defaultExpanded:!0})}),e===4&&d.jsx(D,{children:d.jsx(ft,{title:"Other KPIs",details:d.jsxs(D,{children:[d.jsxs(H,{children:["Average Teacher Workload: ",f.avgTeacherWorkload||0," periods/week"]}),d.jsxs(H,{children:["Exam Completion Rate: ",f.examCompletionRate||0,"%"]}),d.jsxs(H,{children:["Student-to-Teacher Ratio: ",f.studentToTeacherRatio||"1:0"]}),d.jsx(ht,{..._}),d.jsx(dt,{onClick:$,icon:d.jsx(ut,{}),title:"Export KPI Report",sx:{mt:2}})]}),defaultExpanded:!0})})]})]})]})},hr=Le(Aa);export{hr as default};
