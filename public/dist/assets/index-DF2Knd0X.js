import{r as y,j as n,a as q,s as K,q as V,v as B,w as he,x as ge,e as xe,u as ye}from"./index-22HUb1_z.js";import{L as ve}from"./loadingButton-DUprIo-A.js";import{D as ne,E as be,b as A,F as Se,_ as d,G as ke,H as je,J as Ce,K as we,N as Te,O as Re,R as Me,Q as Pe,m as Q,l as z,S as Ee,U as Le,V as Fe,k as Ae,d as re,W as X,e as ae,a as ie,X as Z,u as Y,Y as Ie,s as ce,g as Oe,Z as ee,i as _e,T as F,f as le,$ as Ve,p as De,c as N,A as O,a0 as $e,w as T,a1 as H,a2 as Ne,a3 as Be,z as se}from"./constants-BJW4J9P5.js";import{u as ze,M as U}from"./MenuItem-38XN_-vW.js";import{I as W}from"./IconButton-xWupQFdG.js";const He=["ownerState"],Ue=["variants"],We=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Ge(e){return Object.keys(e).length===0}function qe(e){return typeof e=="string"&&e.charCodeAt(0)>96}function G(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Ye=ne(),Je=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function D({defaultTheme:e,theme:s,themeId:t}){return Ge(s)?e:s[t]||s}function Ke(e){return e?(s,t)=>t[e]:null}function $(e,s){let{ownerState:t}=s,o=A(s,He);const a=typeof e=="function"?e(d({ownerState:t},o)):e;if(Array.isArray(a))return a.flatMap(i=>$(i,d({ownerState:t},o)));if(a&&typeof a=="object"&&Array.isArray(a.variants)){const{variants:i=[]}=a;let c=A(a,Ue);return i.forEach(r=>{let l=!0;typeof r.props=="function"?l=r.props(d({ownerState:t},o,t)):Object.keys(r.props).forEach(f=>{(t==null?void 0:t[f])!==r.props[f]&&o[f]!==r.props[f]&&(l=!1)}),l&&(Array.isArray(c)||(c=[c]),c.push(typeof r.style=="function"?r.style(d({ownerState:t},o,t)):r.style))}),c}return a}function Qe(e={}){const{themeId:s,defaultTheme:t=Ye,rootShouldForwardProp:o=G,slotShouldForwardProp:a=G}=e,i=u=>ke(d({},u,{theme:D(d({},u,{defaultTheme:t,themeId:s}))}));return i.__mui_systemSx=!0,(u,c={})=>{be(u,x=>x.filter(b=>!(b!=null&&b.__mui_systemSx)));const{name:r,slot:l,skipVariantsResolver:f,skipSx:h,overridesResolver:m=Ke(Je(l))}=c,g=A(c,We),S=f!==void 0?f:l&&l!=="Root"&&l!=="root"||!1,v=h||!1;let R,k=G;l==="Root"||l==="root"?k=o:l?k=a:qe(u)&&(k=void 0);const p=Se(u,d({shouldForwardProp:k,label:R},g)),C=x=>typeof x=="function"&&x.__emotion_real!==x||je(x)?b=>$(x,d({},b,{theme:D({theme:b.theme,defaultTheme:t,themeId:s})})):x,E=(x,...b)=>{let L=C(x);const P=b?b.map(C):[];r&&m&&P.push(w=>{const j=D(d({},w,{defaultTheme:t,themeId:s}));if(!j.components||!j.components[r]||!j.components[r].styleOverrides)return null;const I=j.components[r].styleOverrides,_={};return Object.entries(I).forEach(([me,pe])=>{_[me]=$(pe,d({},w,{theme:j}))}),m(w,_)}),r&&!S&&P.push(w=>{var j;const I=D(d({},w,{defaultTheme:t,themeId:s})),_=I==null||(j=I.components)==null||(j=j[r])==null?void 0:j.variants;return $({variants:_},d({},w,{theme:I}))}),v||P.push(i);const M=P.length-b.length;if(Array.isArray(x)&&M>0){const w=new Array(M).fill("");L=[...x,...w],L.raw=[...x.raw,...w]}const J=p(L,...P);return u.muiName&&(J.muiName=u.muiName),J};return p.withConfig&&(E.withConfig=p.withConfig),E}}const Xe=Qe();function Ze(e){const{theme:s,name:t,props:o}=e;return!s||!s.components||!s.components[t]||!s.components[t].defaultProps?o:Ce(s.components[t].defaultProps,o)}function es({props:e,name:s,defaultTheme:t,themeId:o}){let a=we(t);return o&&(a=a[o]||a),Ze({theme:a,name:s,props:e})}const ue=y.createContext(null);function de(){return y.useContext(ue)}const ss=typeof Symbol=="function"&&Symbol.for,ts=ss?Symbol.for("mui.nested"):"__THEME_NESTED__";function os(e,s){return typeof s=="function"?s(e):d({},e,s)}function ns(e){const{children:s,theme:t}=e,o=de(),a=y.useMemo(()=>{const i=o===null?t:os(o,t);return i!=null&&(i[ts]=o!==null),i},[t,o]);return n.jsx(ue.Provider,{value:a,children:s})}const te={};function oe(e,s,t,o=!1){return y.useMemo(()=>{const a=e&&s[e]||s;if(typeof t=="function"){const i=t(a),u=e?d({},s,{[e]:i}):i;return o?()=>u:u}return e?d({},s,{[e]:t}):d({},s,t)},[e,s,t,o])}function rs(e){const{children:s,theme:t,themeId:o}=e,a=Te(te),i=de()||te,u=oe(o,a,t),c=oe(o,i,t,!0),r=u.direction==="rtl";return n.jsx(ns,{theme:c,children:n.jsx(Re.Provider,{value:u,children:n.jsx(Me,{value:r,children:n.jsx(Pe,{value:u==null?void 0:u.components,children:s})})})})}const as=["component","direction","spacing","divider","children","className","useFlexGap"],is=ne(),cs=Xe("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,s)=>s.root});function ls(e){return es({props:e,name:"MuiStack",defaultTheme:is})}function us(e,s){const t=y.Children.toArray(e).filter(Boolean);return t.reduce((o,a,i)=>(o.push(a),i<t.length-1&&o.push(y.cloneElement(s,{key:`separator-${i}`})),o),[])}const ds=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],fs=({ownerState:e,theme:s})=>{let t=d({display:"flex",flexDirection:"column"},Q({theme:s},z({values:e.direction,breakpoints:s.breakpoints.values}),o=>({flexDirection:o})));if(e.spacing){const o=Ee(s),a=Object.keys(s.breakpoints.values).reduce((r,l)=>((typeof e.spacing=="object"&&e.spacing[l]!=null||typeof e.direction=="object"&&e.direction[l]!=null)&&(r[l]=!0),r),{}),i=z({values:e.direction,base:a}),u=z({values:e.spacing,base:a});typeof i=="object"&&Object.keys(i).forEach((r,l,f)=>{if(!i[r]){const m=l>0?i[f[l-1]]:"column";i[r]=m}}),t=Le(t,Q({theme:s},u,(r,l)=>e.useFlexGap?{gap:X(o,r)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${ds(l?i[l]:e.direction)}`]:X(o,r)}}))}return t=Fe(s.breakpoints,t),t};function ms(e={}){const{createStyledComponent:s=cs,useThemeProps:t=ls,componentName:o="MuiStack"}=e,a=()=>ae({root:["root"]},r=>ie(o,r),{}),i=s(fs);return y.forwardRef(function(r,l){const f=t(r),h=Ae(f),{component:m="div",direction:g="column",spacing:S=0,divider:v,children:R,className:k,useFlexGap:p=!1}=h,C=A(h,as),E={direction:g,spacing:S,useFlexGap:p},x=a();return n.jsx(i,d({as:m,ownerState:E,ref:l,className:re(x.root,k)},C,{children:v?us(R,v):R}))})}const ps=["theme"];function hs(e){let{theme:s}=e,t=A(e,ps);const o=s[Z];return n.jsx(rs,d({},t,{themeId:o?Z:void 0,theme:o||s}))}const gs=(e,s)=>d({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},s&&!e.vars&&{colorScheme:e.palette.mode}),xs=e=>d({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),ys=(e,s=!1)=>{var t;const o={};s&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(([u,c])=>{var r;o[e.getColorSchemeSelector(u).replace(/\s*&/,"")]={colorScheme:(r=c.palette)==null?void 0:r.mode}});let a=d({html:gs(e,s),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:d({margin:0},xs(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},o);const i=(t=e.components)==null||(t=t.MuiCssBaseline)==null?void 0:t.styleOverrides;return i&&(a=[a,i]),a};function vs(e){const s=Y({props:e,name:"MuiCssBaseline"}),{children:t,enableColorScheme:o=!1}=s;return n.jsxs(y.Fragment,{children:[n.jsx(Ie,{styles:a=>ys(a,o)}),t]})}const bs=ms({createStyledComponent:ce("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,s)=>s.root}),useThemeProps:e=>Y({props:e,name:"MuiStack"})});function Ss(e){return ie("MuiLink",e)}const ks=Oe("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),fe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},js=e=>fe[e]||e,Cs=({theme:e,ownerState:s})=>{const t=js(s.color),o=ee(e,`palette.${t}`,!1)||s.color,a=ee(e,`palette.${t}Channel`);return"vars"in e&&a?`rgba(${a} / 0.4)`:_e(o,.4)},ws=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Ts=e=>{const{classes:s,component:t,focusVisible:o,underline:a}=e,i={root:["root",`underline${le(a)}`,t==="button"&&"button",o&&"focusVisible"]};return ae(i,Ss,s)},Rs=ce(F,{name:"MuiLink",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:t}=e;return[s.root,s[`underline${le(t.underline)}`],t.component==="button"&&s.button]}})(({theme:e,ownerState:s})=>d({},s.underline==="none"&&{textDecoration:"none"},s.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},s.underline==="always"&&d({textDecoration:"underline"},s.color!=="inherit"&&{textDecorationColor:Cs({theme:e,ownerState:s})},{"&:hover":{textDecorationColor:"inherit"}}),s.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ks.focusVisible}`]:{outline:"auto"}})),Ms=y.forwardRef(function(s,t){const o=Y({props:s,name:"MuiLink"}),{className:a,color:i="primary",component:u="a",onBlur:c,onFocus:r,TypographyClasses:l,underline:f="always",variant:h="inherit",sx:m}=o,g=A(o,ws),{isFocusVisibleRef:S,onBlur:v,onFocus:R,ref:k}=Ve(),[p,C]=y.useState(!1),E=De(t,k),x=M=>{v(M),S.current===!1&&C(!1),c&&c(M)},b=M=>{R(M),S.current===!0&&C(!0),r&&r(M)},L=d({},o,{color:i,component:u,focusVisible:p,underline:f,variant:h}),P=Ts(L);return n.jsx(Rs,d({color:i,className:re(P.root,a),classes:l,component:u,onBlur:x,onFocus:b,ref:E,ownerState:L,variant:h,sx:[...Object.keys(fe).includes(i)?[]:[{color:i}],...Array.isArray(m)?m:[m]]},g))}),Ps=N(n.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),Es=N(n.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.43c0-.6.36-1.15.92-1.39.64-.28 1.34-.43 2.08-.43s1.44.15 2.08.43c.55.24.92.78.92 1.39zm1-9h-2V4h2zm4.25 7.5h-2.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75m0-3h-2.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75"}),"BadgeRounded"),Ls=N(n.jsx("path",{d:"M11.01 3.05C6.51 3.54 3 7.36 3 12c0 4.97 4.03 9 9 9 4.63 0 8.45-3.5 8.95-8 .09-.79-.78-1.42-1.54-.95-.84.54-1.84.85-2.91.85-2.98 0-5.4-2.42-5.4-5.4 0-1.06.31-2.06.84-2.89.45-.67-.04-1.63-.93-1.56"}),"DarkModeRounded"),Fs=N(n.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5M2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1m18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1M11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1m0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1M5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0z"}),"LightModeRounded"),As=()=>{const e=ze(),{user:s}=q(c=>c.users),{loading:t,error:o}=q(c=>c.ui),a=async(c,r,l)=>{e(K(!0)),e(V(null));try{if(!l)throw new Error("User role is required for login");let f;switch(l.toLowerCase()){case"admin":f=O.LOGIN.ADMIN;break;case"teacher":f=O.LOGIN.TEACHER;break;case"student":f=O.LOGIN.STUDENT;break;default:throw new Error("Invalid user role")}const h=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c,password:r}),credentials:"include"}),m=h.headers.get("content-type");if(!h.ok){const S=m!=null&&m.includes("application/json")?(await h.json()).message||"Login failed":await h.text();throw new Error(`Login failed: ${S}`)}if(!(m!=null&&m.includes("application/json")))throw new Error("Invalid server response format");const g=await h.json();g.data.token?(sessionStorage.setItem("accessToken",g.data.token),console.log("Access token stored in sessionStorage")):console.warn("No access token found in response"),l.toLowerCase()==="student"?(e(B(g.data.student)),console.log("Logged in:",g.data.student)):l.toLowerCase()==="teacher"?(e(B(g.data.teacher)),console.log("Logged in:",g.data.teacher)):(e(B(g.data.user)),console.log("Logged in:",g.data.user))}catch(f){e(V(f.message))}finally{e(K(!1))}},i=async()=>{try{const c=await fetch(O.REFRESH_TOKEN,{method:"POST",credentials:"include"}),r=c.headers.get("content-type");if(!c.ok){const f=r!=null&&r.includes("application/json")?(await c.json()).message||"Failed to refresh token":await c.text();throw new Error(`Failed to refresh access token: ${f}`)}if(!(r!=null&&r.includes("application/json")))throw new Error("Invalid refresh token response format");const l=await c.json();l.token?(sessionStorage.setItem("accessToken",l.token),console.log("Access token refreshed and stored in sessionStorage")):console.warn("No access token found in refresh response")}catch(c){e(V(c.message)),console.error(c)}};return y.useEffect(()=>{const c=setInterval(()=>{i()},84e4);return()=>clearInterval(c)},[]),{user:s,login:a,logout:async()=>{try{await fetch(O.LOGOUT,{method:"POST",credentials:"include"}),e(he()),sessionStorage.removeItem("accessToken"),console.log("Access token removed from sessionStorage"),await ge("Messages"),console.log("Messages store deleted after logout.")}catch(c){e(V(c.message))}},loading:t,error:o}},Is="/assets/signinBg-RilISOAr.jpeg",Os="/assets/login_muslim_image-n9SwmIkJ.png",Bs=()=>{const{loading:e,error:s,login:t}=As(),[o,a]=y.useState(""),[i,u]=y.useState(""),[c,r]=y.useState(""),[l,f]=y.useState(!1),h=xe(),m=ye().pathname,g=q(p=>p.users.user);y.useEffect(()=>{g&&h("/dashboard")},[g,h]);const S=async p=>{if(p.preventDefault(),!o||!i||!c){alert("Please enter email, password, and select a role.");return}f(!0);try{await t(o,i,c)}catch(C){console.error("Error during login:",C)}finally{f(!1)}},[v,R]=y.useState("dark"),k=$e({palette:{mode:v,...v==="light"?{background:{default:"#f5f5f5"},primary:{main:"#1976d2"},text:{primary:"#000000"}}:{background:{default:"#121212"},primary:{main:"#90caf9"},text:{primary:"#ffffff"}}}});return n.jsxs(hs,{theme:k,children:[n.jsx(vs,{}),n.jsxs(T,{sx:{display:"flex",justifyContent:"end",alignItems:"center",minHeight:"100vh",backgroundImage:`url(${v==="light"?Is:Os})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",position:"relative"},children:[n.jsx(T,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",opacity:v==="light"?.4:.2}}),n.jsxs(T,{sx:{width:{xs:"100%",md:"40%"},height:"100vh",backdropFilter:"blur(12px)",backgroundColor:v==="light"?"rgba(255, 255, 255, 0.2)":"rgba(18, 18, 18, 0.8)",p:4,display:"flex",flexDirection:"column",justifyContent:"space-between",zIndex:1},children:[n.jsxs(T,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[n.jsx(W,{onClick:()=>h(-1),color:"primary",children:n.jsx(Ps,{sx:{color:"#fff"}})}),n.jsx(W,{onClick:()=>R(p=>p==="light"?"dark":"light"),children:v==="light"?n.jsx(Ls,{sx:{color:"#fff"}}):n.jsx(Fs,{})})]}),m==="/dashboard"&&n.jsx(T,{sx:{display:"flex",justifyContent:"center"},children:n.jsx(F,{variant:"h6",children:"You are not logged in, Kindly Login."})}),n.jsxs(T,{children:[n.jsx(T,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:n.jsxs(T,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsx(W,{size:"small",color:"primary",children:n.jsx(Es,{sx:{color:"#fff"}})}),n.jsx(F,{variant:"h6",children:"Crystal Land Academy"})]})}),n.jsx(F,{variant:"h4",sx:{mb:2},children:"Sign in"}),n.jsx("form",{onSubmit:S,children:n.jsxs(bs,{spacing:2,children:[n.jsxs(H,{fullWidth:!0,children:[n.jsx(Ne,{id:"role-label",children:"Sign in as"}),n.jsxs(Be,{labelId:"role-label",value:c,label:"Sign in as",onChange:p=>r(p.target.value),required:!0,children:[n.jsx(U,{value:"student",children:"Student"}),n.jsx(U,{value:"teacher",children:"Teacher"}),n.jsx(U,{value:"admin",children:"Admin"})]})]}),n.jsx(H,{fullWidth:!0,children:n.jsx(se,{label:"Email",type:"email",value:o,onChange:p=>a(p.target.value),required:!0})}),n.jsx(H,{fullWidth:!0,children:n.jsx(se,{label:"Password",type:"password",value:i,onChange:p=>u(p.target.value),required:!0})}),s&&n.jsx(F,{color:"error",children:s}),n.jsx(ve,{type:"submit",variant:"contained",color:"primary",isLoading:l||e,fullWidth:!0,children:"Continue"}),n.jsx(Ms,{href:"/forgot-password",underline:"hover",children:"Forgot password?"})]})})]}),n.jsx(T,{sx:{textAlign:"center",mt:3},children:n.jsxs(F,{variant:"body2",children:["© Crystal Land Academy ",new Date().getFullYear()]})})]})]})]})};export{vs as C,Bs as S,hs as T,bs as a,Ze as g,As as u};
