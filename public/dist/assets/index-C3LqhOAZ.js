import{r as x,j as e,i as j}from"./index-B-gfigdE.js";import{t as se,D as Ne,a as Pe,b as $e,c as Re,M as v}from"./modal-CjM-E6bY.js";import{a1 as Le,a2 as Je,a3 as He,j as oe,x as Y,T as S,v as f}from"./TextField-CvoFiyNY.js";import{M as Z}from"./MenuItem-Cq1E3Tk4.js";import{S as D,u as y}from"./index-B4vdsszY.js";import{H as Ke}from"./Header-C7TPBC1M.js";import{a as ze,b as $,T as R}from"./table-DoKeEdmi.js";import{w as Ve}from"./dasboardPagesContainer-BIwYn5ot.js";import{A as E}from"./actionButton-1Z_EoPmr.js";import{U as _e}from"./index-DvYUmvmj.js";import"./IconButton-DXPrO4pt.js";import"./useApi-BpL-F3eV.js";import"./confirmationModal-BhSIITCd.js";import"./CircularProgress-Cjpv5aMd.js";import"./Edit-BCwQhRjj.js";import"./Visibility-BmI7sSES.js";import"./Alert-D6gA0BSD.js";import"./useSlot-DYcMRowa.js";import"./useMediaQuery-MbFwq1kw.js";import"./index-CfhEgBJ4.js";import"./loadingButton-B4jIQRMH.js";import"./crystal-land-log-removebg-DVF-nlbN.js";const w=({label:l,options:d,onSelect:p})=>{const[u,t]=x.useState(""),m=r=>{const o=r.target.value;t(o),p(o)};return e.jsxs(Le,{sx:{width:"170px",paddingBottom:"2%"},variant:"outlined",children:[e.jsx(Je,{id:`${l}-select-label`,children:l}),e.jsxs(He,{labelId:`${l}-select-label`,value:u,onChange:m,label:l,children:[e.jsx(Z,{value:"",disabled:!0,children:`Select ${l}`}),d.map(r=>e.jsx(Z,{value:r.value,children:r.label},r.value))]})]})},qe=()=>e.jsx(D,{role:"student"}),Ge=()=>e.jsx(D,{role:"teacher"}),Qe=()=>e.jsx(D,{role:"admin"}),ee=({confirm:l,buttonLabel:d,dialogTitle:p,dialogContent:u,scrollType:t="paper",actionText1:m="Cancel",actionText2:r="Confirm",open:o=!1,onClose:i,onConfirm:a,maxWidth:C="md"})=>{const[U,k]=x.useState(t),n=x.useRef(null),O=oe(),g=se(O.palette.mode);return x.useEffect(()=>{if(o){const{current:I}=n;I!==null&&I.focus()}},[o]),e.jsx(x.Fragment,{children:e.jsxs(Ne,{open:o,onClose:i,scroll:U,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",maxWidth:C,fullWidth:!0,children:[e.jsx(Pe,{id:"scroll-dialog-title",children:p}),e.jsx($e,{dividers:U==="paper",children:e.jsx("div",{id:"scroll-dialog-description",ref:n,tabIndex:-1,children:u})}),e.jsxs(Re,{children:[e.jsx(Y,{sx:{color:g.redAccent[500],border:`solid 2px ${g.redAccent[500]}`},onClick:i,children:m}),l&&r&&e.jsx(Y,{sx:{color:g.greenAccent[500],border:`solid 2px ${g.greenAccent[500]}`},onClick:a,children:r})]})]})})},Xe=({selectedRole:l,editDialogOpen:d,setEditDialogOpen:p,handleUpdateUser:u,userDetails:t})=>{const{updateUserLoading:m}=y(),[r,o]=x.useState(t||{});return x.useEffect(()=>{o(t||{})},[t]),e.jsx(v,{open:d,onClose:()=>{p(!1),sessionStorage.removeItem("selectedUser")},title:"Edit User",confirmMessage:"Confirm",onConfirm:()=>{r&&(t!=null&&t._id)&&u(t._id,r,l)},disabled:m,children:e.jsxs("div",{style:{position:"relative"},children:[m&&e.jsx(j,{}),t?e.jsx(D,{role:l,selectedUser:t,onChange:i=>o(i)}):e.jsx(S,{children:"No user selected for editing."})]})})},Ye=({open:l,onClose:d,onConfirm:p})=>{const{deleteLoading:u,selectedUser:t}=y(),[m,r]=x.useState(!1);x.useEffect(()=>{sessionStorage.getItem("confirmModal")&&r(!0)},[l]);const o=()=>{r(!1),sessionStorage.removeItem("confirmModal"),sessionStorage.removeItem("deleteResult")},i=JSON.parse(sessionStorage.getItem("deleteResult")||"{}");return e.jsxs(e.Fragment,{children:[e.jsx(v,{open:l,onClose:d,title:"Confirm Delete",onConfirm:()=>{p(t),sessionStorage.setItem("confirmModal","true")},confirmMessage:"Confirm",disabled:u,children:e.jsxs("div",{style:{position:"relative"},children:[u&&e.jsx(j,{}),e.jsxs(S,{children:["Confirm deletion of user."," ",e.jsx("span",{style:{color:"#EB433D",fontWeight:"900",fontSize:"large"},children:"Kindly note that this cannot be reversed"})]})]})}),e.jsx(v,{open:m,onClose:o,title:"Delete Confirmation",onConfirm:o,confirmMessage:"OK",disabled:u,children:e.jsxs("div",{style:{position:"relative"},children:[u&&e.jsx(j,{}),e.jsx(S,{children:(i==null?void 0:i.status)==="success"?"User successfully deleted":(i==null?void 0:i.message)||"An error occurred"})]})})]})},Ze=({open:l,onClose:d,onConfirm:p,userName:u})=>{var C;const{withdrawLoading:t}=y(),[m,r]=x.useState(!1),o=((C=JSON.parse(sessionStorage.getItem("selectedUser")))==null?void 0:C.role)||"user";x.useEffect(()=>{sessionStorage.getItem("confirmWithdrawModal")&&r(!0)},[l]);const i=()=>{r(!1),sessionStorage.removeItem("confirmWithdrawModal"),sessionStorage.removeItem("withdrawResult")},a=JSON.parse(sessionStorage.getItem("withdrawResult")||"{}");return e.jsxs(e.Fragment,{children:[e.jsx(v,{open:l,onClose:d,title:`Confirm ${o.charAt(0).toUpperCase()+o.slice(1)} Withdrawal`,onConfirm:()=>{p(),sessionStorage.setItem("confirmWithdrawModal","true")},confirmMessage:"Confirm",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsxs(S,{children:["Are you sure you want to withdraw ",e.jsx("strong",{children:u}),"?"," ",e.jsxs("span",{style:{color:"#EB433D",fontWeight:"900",fontSize:"large"},children:["This action will mark the ",o," as withdrawn and remove them from their class and academic year."]})]})]})}),e.jsx(v,{open:m,onClose:i,title:"Withdraw Confirmation",onConfirm:i,confirmMessage:"OK",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsx(S,{children:(a==null?void 0:a.status)==="success"?`${o.charAt(0).toUpperCase()+o.slice(1)} successfully withdrawn`:(a==null?void 0:a.message)||"An error occurred"})]})})]})},es=({open:l,onClose:d,onConfirm:p,userName:u})=>{var C;const{suspendLoading:t}=y(),[m,r]=x.useState(!1),o=((C=JSON.parse(sessionStorage.getItem("selectedUser")))==null?void 0:C.role)||"user";x.useEffect(()=>{sessionStorage.getItem("confirmSuspendModal")&&r(!0)},[l]);const i=()=>{r(!1),sessionStorage.removeItem("confirmSuspendModal"),sessionStorage.removeItem("suspendResult")},a=JSON.parse(sessionStorage.getItem("suspendResult")||"{}");return e.jsxs(e.Fragment,{children:[e.jsx(v,{open:l,onClose:d,title:`Confirm ${o.charAt(0).toUpperCase()+o.slice(1)} Suspension`,onConfirm:()=>{p(),sessionStorage.setItem("confirmSuspendModal","true")},confirmMessage:"Confirm",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsxs(S,{children:["Are you sure you want to suspend ",e.jsx("strong",{children:u}),"?"," ",e.jsxs("span",{style:{color:"#EB433D",fontWeight:"900",fontSize:"large"},children:["This action will mark the ",o," as suspended."]})]})]})}),e.jsx(v,{open:m,onClose:i,title:"Suspend Confirmation",onConfirm:i,confirmMessage:"OK",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsx(S,{children:(a==null?void 0:a.status)==="success"?`${o.charAt(0).toUpperCase()+o.slice(1)} successfully suspended`:(a==null?void 0:a.message)||"An error occurred"})]})})]})},ss=({open:l,onClose:d,onConfirm:p,userName:u})=>{var C;const{unsuspendLoading:t}=y(),[m,r]=x.useState(!1),o=((C=JSON.parse(sessionStorage.getItem("selectedUser")))==null?void 0:C.role)||"user";x.useEffect(()=>{sessionStorage.getItem("confirmUnsuspendModal")&&r(!0)},[l]);const i=()=>{r(!1),sessionStorage.removeItem("confirmUnsuspendModal"),sessionStorage.removeItem("unsuspendResult")},a=JSON.parse(sessionStorage.getItem("unsuspendResult")||"{}");return e.jsxs(e.Fragment,{children:[e.jsx(v,{open:l,onClose:d,title:`Confirm ${o.charAt(0).toUpperCase()+o.slice(1)} Unsuspension`,onConfirm:()=>{p(),sessionStorage.setItem("confirmUnsuspendModal","true")},confirmMessage:"Confirm",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsxs(S,{children:["Are you sure you want to unsuspend ",e.jsx("strong",{children:u}),"?"," ",e.jsxs("span",{style:{color:"#4CAF50",fontWeight:"900",fontSize:"large"},children:["This action will mark the ",o," as active."]})]})]})}),e.jsx(v,{open:m,onClose:i,title:"Unsuspend Confirmation",onConfirm:i,confirmMessage:"OK",disabled:t,children:e.jsxs("div",{style:{position:"relative"},children:[t&&e.jsx(j,{}),e.jsx(S,{children:(a==null?void 0:a.status)==="success"?`${o.charAt(0).toUpperCase()+o.slice(1)} successfully unsuspended`:(a==null?void 0:a.message)||"An error occurred"})]})})]})},os=()=>{const l=oe(),d=se(l.palette.mode),{studentData:p,teacherData:u,adminData:t,selectedRole:m,setSelectedRole:r,sortBy:o,sortDirection:i,studentPage:a,teacherPage:C,adminPage:U,rowsPerPage:k,selectedUser:n,setSelectedUser:O,editUserDetailsState:g,openDeleteModal:I,setOpenDeleteModal:L,editDialogOpen:te,setEditDialogOpen:ne,signUpDialogOpen:re,setSignUpDialogOpen:ae,handleRoleSelect:le,handleSortChange:B,handleStudentPageChange:ie,handleTeacherPageChange:de,handleAdminPageChange:ce,handleRowsPerPageChange:F,handleEdit:J,onDelete:ue,onWithdraw:me,onSuspend:pe,onUnsuspend:ge,handleWithdrawOpen:he,handleWithdrawClose:xe,handleSuspendOpen:Ce,handleSuspendClose:fe,handleUnsuspendOpen:Se,handleUnsuspendClose:be,onAddUser:W,onUpdateUser:je,columns:N,tabIndex:M,handleTabChange:ve,loading:c,studentsError:H,teachersError:K,adminsError:z,deleteError:V,withdrawError:_,suspendError:q,unsuspendError:G,addUserError:Q,studentSections:we,teacherSections:Ue,selectedStudentSection:Me,selectedTeacherSection:Ae,studentFilters:b,teacherFilters:h,handleStudentFilterChange:T,handleTeacherFilterChange:P,studentClassNames:ye,teacherClassNames:Ee,boardingStatuses:ke,studentStatuses:Ie,teacherStatuses:Te,viewUserDetails:X,setViewUserDetails:De,locateUserByIdAndRole:Oe,withdrawModalOpen:Be,suspendModalOpen:Fe,unsuspendModalOpen:We}=y(),A=n?Oe(n._id,n.role):null;return e.jsxs(f,{sx:{position:"relative"},children:[e.jsx(Ke,{title:"User Management",subtitle:"Manage users"}),e.jsx(w,{label:"Add Users",options:[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"},{value:"admin",label:"Admin"}],onSelect:le}),e.jsx(f,{mt:2,children:e.jsxs(ze,{value:M,onChange:ve,"aria-label":"user role tabs",sx:{backgroundColor:d.primary[400],"& .MuiTabs-indicator":{backgroundColor:d.blueAccent[700]}},children:[e.jsx($,{label:"Students",sx:{color:"white !important",textTransform:"none",fontWeight:"bold","&.Mui-selected":{color:"white !important",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.3)",backgroundColor:d.blueAccent[700]},boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)",backgroundColor:d.primary[400]}}),e.jsx($,{label:"Teachers",sx:{color:"white !important",textTransform:"none",fontWeight:"bold","&.Mui-selected":{color:"white !important",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.3)",backgroundColor:d.blueAccent[700]},boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)",backgroundColor:d.primary[400]}}),e.jsx($,{label:"Admins",sx:{color:"white !important",textTransform:"none",fontWeight:"bold","&.Mui-selected":{color:"white !important",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.3)",backgroundColor:d.blueAccent[700]},boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)",backgroundColor:d.primary[400]}})]})}),M===0&&e.jsxs(f,{sx:{display:"flex",gap:2,mt:2,flexWrap:"wrap"},children:[e.jsx(w,{label:"Section",options:we.map(s=>({value:s,label:s})),value:Me,onSelect:s=>T("section",s),disabled:c}),e.jsx(w,{label:"Class",options:ye.map(s=>({value:s,label:s})),value:(b==null?void 0:b.className)||"All",onSelect:s=>T("className",s),disabled:c}),e.jsx(w,{label:"Boarding Status",options:ke.map(s=>({value:s,label:s})),value:(b==null?void 0:b.boardingStatus)||"All",onSelect:s=>T("boardingStatus",s),disabled:c}),e.jsx(w,{label:"Status",options:Ie.map(s=>({vigilant:s,label:s})),value:(b==null?void 0:b.status)||"All",onSelect:s=>T("status",s),disabled:c})]}),M===1&&e.jsxs(f,{sx:{display:"flex",gap:2,mt:2,flexWrap:"wrap"},children:[e.jsx(w,{label:"Section",options:Ue.map(s=>({value:s,label:s})),value:Ae,onSelect:s=>P("section",s),disabled:c}),e.jsx(w,{label:"Class",options:Ee.map(s=>({value:s,label:s})),value:(h==null?void 0:h.className)||"All",onSelect:s=>P("className",s),disabled:c}),e.jsx(w,{label:"Status",options:Te.map(s=>({value:s,label:s})),value:(h==null?void 0:h.isSuspended)==="true"?"Suspended":(h==null?void 0:h.isWithdrawn)==="true"?"Withdrawn":(h==null?void 0:h.isSuspended)==="false"&&(h==null?void 0:h.isWithdrawn)==="false"?"Active":"All",onSelect:s=>P("status",s),disabled:c})]}),M===0&&e.jsx(f,{m:"20px 0 0 0",height:"75vh",children:e.jsx(R,{columns:N,tableHeader:"Student Management",data:p,sortBy:o,sortDirection:i,onSortChange:B,page:a,rowsPerPage:k,onPageChange:ie,onRowsPerPageChange:F,hiddenColumnsSmallScreen:["email","createdAt"],hiddenColumnsTabScreen:["createdAt","details"],count:p.length,getRowStyle:s=>s.rowStyle,getColumnStyle:s=>{switch(s){case"id":return{backgroundColor:"#E0F7FA"};case"name":return{backgroundColor:"#F0F4C3"};case"email":return{backgroundColor:"#FFECB3"};case"details":return{backgroundColor:"#BBDEFB"};case"createdAt":return{backgroundColor:"#C8E6C9"};case"actions":return{backgroundColor:"#FFCCBC"};default:return{}}},disabled:c})}),M===1&&e.jsx(f,{m:"20px 0 0 0",height:"75vh",children:e.jsx(R,{columns:N,tableHeader:"Teacher Management",data:u,sortBy:o,sortDirection:i,onSortChange:B,page:C,rowsPerPage:k,onPageChange:de,onRowsPerPageChange:F,hiddenColumnsSmallScreen:["email","createdAt"],hiddenColumnsTabScreen:["createdAt","details"],count:u.length,getRowStyle:s=>s.rowStyle,getColumnStyle:s=>{switch(s){case"id":return{backgroundColor:"#E0F7FA"};case"name":return{backgroundColor:"#F0F4C3"};case"email":return{backgroundColor:"#FFECB3"};case"details":return{backgroundColor:"#BBDEFB"};case"createdAt":return{backgroundColor:"#C8E6C9"};case"actions":return{backgroundColor:"#FFCCBC"};default:return{}}},disabled:c})}),M===2&&e.jsx(f,{m:"20px 0 0 0",height:"75vh",children:e.jsx(R,{columns:N,tableHeader:"Admin Management",data:t,sortBy:o,sortDirection:i,onSortChange:B,page:U,rowsPerPage:k,onPageChange:ce,onRowsPerPageChange:F,hiddenColumnsSmallScreen:["email","createdAt"],hiddenColumnsTabScreen:["createdAt","details"],count:t.length,getRowStyle:s=>s.rowStyle||{},getColumnStyle:s=>{switch(s){case"id":return{backgroundColor:"#E0F7FA"};case"name":return{backgroundColor:"#F0F4C3"};case"email":return{backgroundColor:"#FFECB3"};case"details":return{backgroundColor:"#BBDEFB"};case"createdAt":return{backgroundColor:"#C8E6C9"};case"actions":return{backgroundColor:"#FFCCBC"};default:return{}}},disabled:c})}),X&&n&&A&&e.jsx(ee,{buttonLabel:"View User Details",dialogTitle:"User Details",dialogContent:e.jsxs(f,{children:[e.jsx(_e,{userDetails:{...A,role:n.role}}),!A.isWithdrawn&&e.jsxs(f,{mt:2,display:"flex",gap:2,children:[(n.role==="student"||n.role==="teacher")&&(A.isSuspended&&(n.role==="student"||n.role==="teacher")?e.jsx(E,{content:`Unsuspend ${n.role}`,onClick:()=>Se(n),disabled:c}):e.jsx(E,{content:`Suspend ${n.role.charAt(0).toUpperCase()+n.role.slice(1)}`,onClick:()=>Ce(n),disabled:c})),(n.role==="student"||n.role==="teacher")&&e.jsx(E,{content:`Withdraw ${n.role.charAt(0).toUpperCase()+n.role.slice(1)}`,onClick:()=>he(n),disabled:c}),e.jsx(E,{content:"Edit User",onClick:()=>J(n),disabled:c}),e.jsx(E,{content:"Delete User",onClick:()=>{sessionStorage.setItem("selectedUser",JSON.stringify(A)),setEditUserDetailsState(A),L(!0)},disabled:c})]})]}),scrollType:"paper",actionText1:"Close",actionText2:"Edit",open:X,onClose:()=>{De(!1),O(null),sessionStorage.removeItem("selectedUser")},onAction2:()=>J(n),disabled:c}),e.jsx(Ye,{open:I,onClose:()=>{L(!1),sessionStorage.removeItem("selectedUser"),sessionStorage.removeItem("confirmModal"),sessionStorage.removeItem("deleteResult")},onConfirm:()=>ue(n)}),e.jsx(Ze,{open:Be,onClose:xe,onConfirm:()=>me(n),userName:g?`${g.firstName} ${g.lastName}`:""}),e.jsx(es,{open:Fe,onClose:fe,onConfirm:()=>pe(n),userName:g?`${g.firstName} ${g.lastName}`:""}),e.jsx(ss,{open:We,onClose:be,onConfirm:()=>ge(n),userName:g?`${g.firstName} ${g.lastName}`:""}),e.jsx(Xe,{selectedRole:m,editDialogOpen:te,setEditDialogOpen:s=>{ne(s),s||sessionStorage.removeItem("selectedUser")},handleUpdateUser:je,userDetails:g}),e.jsx(ee,{buttonLabel:"Sign Up",dialogTitle:"Sign Up User",dialogContent:m==="student"?e.jsx(qe,{onSubmit:s=>{W(s,"student")},disabled:c}):m==="teacher"?e.jsx(Ge,{onSubmit:s=>W(s,"teacher"),disabled:c}):m==="admin"?e.jsx(Qe,{onSubmit:s=>W(s,"admin"),disabled:c}):null,scrollType:"body",actionText1:"Cancel",actionText2:"Confirm",open:re,onClose:()=>{ae(!1),r("")},onAction2:()=>{},disabled:c}),(H||K||z||V||_||q||G||Q)&&e.jsx(f,{mt:2,children:e.jsx(S,{color:"error",children:H||K||z||V||_||q||G||Q})})]})},Ms=Ve(os);export{Ms as default};
