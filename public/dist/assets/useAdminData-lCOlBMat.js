import{r,a as Y,e as a,S as $,T as u,P as K,Q as W,U as X,V as Z}from"./index-CLJpG2dk.js";import{u as m}from"./useApi-D9NfFDCx.js";import{u as ee}from"./MenuItem-BK6LVNsx.js";const oe=()=>{const[se,k]=r.useState([]),[re,_]=r.useState([]),[I,q]=r.useState(0),s=ee(),z=Y(e=>e.adminData.academicYears)||[],J=Y(e=>e.adminData.currentAcademicYear),j=Y(e=>e.adminData.classLevels)||[],x=Y(e=>e.adminData.subjects)||[];console.log("Redux classLevels:",j);const{loading:M,data:c,error:E,callApi:y}=m(),{loading:O,data:o,error:f,callApi:F}=m(),{loading:V,data:l,error:g,callApi:v}=m(),{loading:B,data:i,error:C,callApi:w}=m(),G=r.useCallback(async()=>{try{const e=await fetch(`${a.ENQUIRIES}?status=unread`);if(!e.ok)throw new Error("Failed to fetch unread enquiries");const n=(await e.json()).data||[];q(n.length)}catch(e){console.error("Error fetching unread enquiries:",e)}},[]),{loading:H,data:t,error:h,callApi:R}=m(),{loading:Q,data:d,error:A,callApi:U}=m(),N=r.useCallback(()=>(console.log("Fetching students from:",a.STUDENTS),y(a.STUDENTS,"GET")),[y]),D=r.useCallback(()=>(console.log("Fetching teachers from:",a.TEACHERS),F(a.TEACHERS,"GET")),[F]),L=r.useCallback(()=>(console.log("Fetching academic years from:",a.ACADEMIC_YEARS),v(a.ACADEMIC_YEARS,"GET")),[v]),T=r.useCallback(()=>(console.log("Fetching current academic year from:",a.CURRENT_ACADEMIC_YEAR),w(a.CURRENT_ACADEMIC_YEAR,"GET")),[w]),b=r.useCallback(()=>(console.log("Fetching class levels from:",a.CLASS_LEVEL),R(a.CLASS_LEVEL,"GET")),[R]),p=r.useCallback(()=>(console.log("Fetching subjects from:",a.SUBJECT),U(a.SUBJECT,"GET")),[U]);r.useEffect(()=>{N(),D(),L(),T(),G(),b(),p()},[N,D,L,T,G,b,p]),r.useEffect(()=>{if(c||o){console.log("Students Data:",c),console.log("Teachers Data:",o);const e=(c==null?void 0:c.data)||[],S=(o==null?void 0:o.data)||[];k(n=>JSON.stringify(n)!==JSON.stringify(e)?e:n),_(n=>JSON.stringify(n)!==JSON.stringify(S)?S:n),s($({students:e,teachers:S}))}E&&(console.error("Students Error:",E),s(u(E.message||"Failed to fetch students."))),f&&(console.error("Teachers Error:",f),s(u(f.message||"Failed to fetch teachers.")))},[c,o,E,f,s]),r.useEffect(()=>{if(l){console.log("Academic Years Data:",l);const e=(l==null?void 0:l.data)||[];s(K(e))}g&&(console.error("Academic Years Error:",g),s(u(g.message||"Failed to fetch academic years.")))},[l,g,s]),r.useEffect(()=>{if(i){console.log("Current Academic Year Data:",i);const e=(i==null?void 0:i.data)||null;s(W(e))}C&&(console.error("Current Academic Year Error:",C),s(u(C.message||"Failed to fetch current academic year.")))},[i,C,s]),r.useEffect(()=>{if(console.log("Class Levels Data:",t),t){const e=Array.isArray(t)?t:(t==null?void 0:t.data)||(t==null?void 0:t.classLevels)||[];console.log("New Class Levels to Dispatch:",e),e.length===0&&console.warn("Class levels data is empty. Is this expected?"),s(X(e))}h&&(console.error("Class Levels Error:",h),s(u(h.message||"Failed to fetch class levels.")))},[t,h,s]),r.useEffect(()=>{if(d){console.log("Subjects Data:",d);const e=(d==null?void 0:d.data)||[];s(Z(e))}A&&(console.error("Subjects Error:",A),s(u(A.message||"Failed to fetch subjects.")))},[d,A,s]);const P=[E,f,g,C,h,A].find(e=>e)||null;return{usersData:{students:(c==null?void 0:c.data)||[],teachers:(o==null?void 0:o.data)||[]},academicYears:z,currentAcademicYear:J,unreadEnquiriesCount:I,classLevels:j,subjects:x,loading:M||O||V||B||H||Q,error:P,refetchAcademicYears:L,refetchCurrentYear:T,refetchClassLevels:b,refetchSubjects:p}};export{oe as u};
