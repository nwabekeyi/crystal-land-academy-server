import{j as e,a as I,r as t,G as p,f}from"./index-BO-TmkzE.js";import{d as E}from"./confirmationModal-DjrrgVpa.js";import{d as $}from"./Visibility-C7LaGjKB.js";import{q as T}from"./TextField-CigEBK4R.js";import{r as W,M as C}from"./modal-CG0C6vpP.js";import{T as H}from"./table-vaeRJyjp.js";import{H as U}from"./Header-DSApfQWn.js";import{u as y}from"./useApi-bPe3HYn1.js";import{I as o}from"./IconButton-DnpiNGo6.js";import{u as L}from"./index-nsUM-GnQ.js";import"./CircularProgress-oo0vmEJK.js";import"./useMediaQuery-CPLNVO1b.js";import"./index-BJVcWxQk.js";import"./MenuItem-Cm8_Zc8l.js";import"./crystal-land-log-removebg-DVF-nlbN.js";import"./useSlot-DtaxXO1z.js";import"./loadingButton-CiJH9dFC.js";var x={},z=T;Object.defineProperty(x,"__esModule",{value:!0});var v=x.default=void 0,Q=z(W()),B=e;v=x.default=(0,Q.default)((0,B.jsx)("path",{d:"M12 19c0-3.87 3.13-7 7-7 1.08 0 2.09.25 3 .68V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h8.08c-.05-.33-.08-.66-.08-1M4 6l8 5 8-5v2l-8 5-8-5zm13.34 16-3.54-3.54 1.41-1.41 2.12 2.12 4.24-4.24L23 16.34z"}),"MarkEmailRead");const de=()=>{const i=L(),{enquiries:l,loading:c,error:d}=I(r=>r.enquiries),[s,m]=t.useState(null),[h,u]=t.useState(!1),[b,j]=t.useState(0),[R,q]=t.useState(10),{callApi:M}=y(),{callApi:P}=y();t.useEffect(()=>{i(p())},[i]),console.log("Redux Enquiries:",l);const D=[{id:"sn",label:"S/N",minWidth:50},{id:"name",label:"Name",minWidth:100},{id:"phone",label:"Phone No.",minWidth:50},{id:"email",label:"Email",minWidth:100},{id:"status",label:"Status",minWidth:50},{id:"actions",label:"Actions",minWidth:150,renderCell:r=>r.actions}],g=l.map((r,a)=>({sn:a+1,_id:r._id,name:r.name,phone:r.phone,email:r.email,status:r.status==="read"?"Read":"Unread",actions:e.jsxs(e.Fragment,{children:[e.jsx(o,{onClick:()=>_(r),"aria-label":"view",style:{marginRight:"10px"},children:e.jsx($,{})}),e.jsx(o,{onClick:()=>N(r),"aria-label":"delete",color:"error",children:e.jsx(E,{})})]})}));console.log("Table Rows:",g);const S=(r,a)=>{j(a)},k=r=>{q(parseInt(r.target.value,10)),j(0)},_=r=>{m(r),u(!1)},N=r=>{m(r),u(!0)},n=()=>{m(null),u(!1)},w=async r=>{try{const a=`${f.ENQUIRIES}/${r}`;console.log("Marking as read:",a);const F=await M(a,"PATCH",{status:"read"});i(p())}catch(a){console.error("Error marking enquiry as read:",a)}},A=async r=>{try{const a=`${f.ENQUIRIES}/${r}`;console.log("Deleting enquiry:",a),await P(a,"DELETE"),i(p()),n()}catch(a){console.error("Error deleting enquiry:",a)}};return e.jsxs("div",{children:[e.jsx(U,{title:"Enquiries",subtitle:"Enquiries from prospects"}),c&&e.jsx("p",{children:"Loading..."}),d&&e.jsx("p",{style:{color:"red"},children:d}),!c&&!d&&l.length===0&&e.jsx("p",{children:"No enquiries found."}),!c&&!d&&l.length>0&&e.jsx(H,{columns:D,tableHeader:"Enquiries",data:g,page:b,rowsPerPage:R,onPageChange:S,onRowsPerPageChange:k}),s&&!h&&e.jsx(C,{open:!!s,onClose:n,noConfirm:!0,title:"Enquiry Details",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("h2",{children:[e.jsx("strong",{children:"Name: "}),s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Number: "}),s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"E-mail: "}),e.jsx("a",{href:`mailto:${s.email}`,style:{textDecoration:"underline"},children:s.email})]})," ",e.jsxs("p",{children:[e.jsx("strong",{children:"Message: "}),s.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status: "}),s.status==="read"?"Read":"Unread"]}),s.status==="unread"&&e.jsx(o,{onClick:()=>{w(s._id),n()},"aria-label":"mark as read",color:"primary",children:e.jsx(v,{})})]})}),h&&s&&e.jsx(C,{open:h,onClose:n,noConfirm:!0,title:"Confirm Delete",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"Are you sure you want to delete this enquiry?"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name: "}),s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone: "}),s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email: "}),e.jsx("a",{href:`mailto:${s.email}`,style:{color:"blue",textDecoration:"underline"},children:s.email})]})," ",e.jsxs("p",{children:[e.jsx("strong",{children:"Message: "}),s.message]}),e.jsxs("div",{style:{display:"flex",justifyContent:"end",marginTop:"20px"},children:[e.jsx(o,{onClick:()=>A(s._id),"aria-label":"delete",color:"error",children:e.jsx(E,{})}),e.jsx(o,{onClick:n,"aria-label":"cancel",color:"primary",children:"Cancel"})]})]})})]})};export{de as default};
