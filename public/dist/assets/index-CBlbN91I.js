import{r as f,j as t,a as T}from"./index-22HUb1_z.js";import{I as se}from"./index-CvgBkLWp.js";import{M as ne,t as ce}from"./modal-CFzM2TvC.js";import{H as le}from"./Header-CXtHvVsg.js";import{T as ie}from"./table-iQGSzLj8.js";import{u as de}from"./useApi-BivKV4bK.js";import{a as U,g as W,s as M,B as ue,_ as C,r as X,b as V,ac as me,as as Z,d as N,f as L,e as G,c as Q,i as pe,u as ee,at as he,T as z,A as fe,w as F,z as E,j as be}from"./constants-BJW4J9P5.js";import{u as Ce}from"./MenuItem-38XN_-vW.js";import{A as oe}from"./confirmationModal-BxJ-28ob.js";import{a as ge}from"./index-DF2Knd0X.js";import{G as O}from"./index-dxrUZtLq.js";import{w as xe}from"./dasboardPagesContainer-qh7jt9JW.js";import"./IconButton-xWupQFdG.js";import"./useMediaQuery-vabypUKQ.js";import"./loadingButton-DUprIo-A.js";import"./useSlot-Bb0ot7dQ.js";function ke(e){return U("PrivateSwitchBase",e)}W("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Pe=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Ye=e=>{const{classes:o,checked:s,disabled:r,edge:n}=e,a={root:["root",s&&"checked",r&&"disabled",n&&`edge${L(n)}`],input:["input"]};return G(a,ke,o)},ye=M(ue)(({ownerState:e})=>C({padding:9,borderRadius:"50%"},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12})),je=M("input",{shouldForwardProp:X})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),ve=f.forwardRef(function(o,s){const{autoFocus:r,checked:n,checkedIcon:a,className:u,defaultChecked:k,disabled:g,disableFocusRipple:m=!1,edge:P=!1,icon:v,id:l,inputProps:i,inputRef:b,name:x,onBlur:d,onChange:p,onFocus:h,readOnly:S,required:B=!1,tabIndex:Y,type:y,value:R}=o,j=V(o,Pe),[I,_]=me({controlled:n,default:!!k,name:"SwitchBase",state:"checked"}),c=Z(),w=A=>{h&&h(A),c&&c.onFocus&&c.onFocus(A)},te=A=>{d&&d(A),c&&c.onBlur&&c.onBlur(A)},ae=A=>{if(A.nativeEvent.defaultPrevented)return;const K=A.target.checked;_(K),p&&p(A,K)};let $=g;c&&typeof $>"u"&&($=c.disabled);const re=y==="checkbox"||y==="radio",q=C({},o,{checked:I,disabled:$,disableFocusRipple:m,edge:P}),J=Ye(q);return t.jsxs(ye,C({component:"span",className:N(J.root,u),centerRipple:!0,focusRipple:!m,disabled:$,tabIndex:null,role:void 0,onFocus:w,onBlur:te,ownerState:q,ref:s},j,{children:[t.jsx(je,C({autoFocus:r,checked:n,defaultChecked:k,className:J.input,disabled:$,id:re?l:void 0,name:x,onChange:ae,readOnly:S,ref:b,required:B,ownerState:q,tabIndex:Y,type:y},y==="checkbox"&&R===void 0?{}:{value:R},i)),I?a:v]}))}),Se=Q(t.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Ie=Q(t.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Ae=Q(t.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Fe(e){return U("MuiCheckbox",e)}const H=W("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Re=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Be=e=>{const{classes:o,indeterminate:s,color:r,size:n}=e,a={root:["root",s&&"indeterminate",`color${L(r)}`,`size${L(n)}`]},u=G(a,Fe,o);return C({},o,u)},we=M(ve,{shouldForwardProp:e=>X(e)||e==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,s.indeterminate&&o.indeterminate,o[`size${L(s.size)}`],s.color!=="default"&&o[`color${L(s.color)}`]]}})(({theme:e,ownerState:o})=>C({color:(e.vars||e).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${o.color==="default"?e.vars.palette.action.activeChannel:e.vars.palette[o.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:pe(o.color==="default"?e.palette.action.active:e.palette[o.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.color!=="default"&&{[`&.${H.checked}, &.${H.indeterminate}`]:{color:(e.vars||e).palette[o.color].main},[`&.${H.disabled}`]:{color:(e.vars||e).palette.action.disabled}})),Le=t.jsx(Ie,{}),$e=t.jsx(Se,{}),De=t.jsx(Ae,{}),ze=f.forwardRef(function(o,s){var r,n;const a=ee({props:o,name:"MuiCheckbox"}),{checkedIcon:u=Le,color:k="primary",icon:g=$e,indeterminate:m=!1,indeterminateIcon:P=De,inputProps:v,size:l="medium",className:i}=a,b=V(a,Re),x=m?P:g,d=m?P:u,p=C({},a,{color:k,indeterminate:m,size:l}),h=Be(p);return t.jsx(we,C({type:"checkbox",inputProps:C({"data-indeterminate":m},v),icon:f.cloneElement(x,{fontSize:(r=x.props.fontSize)!=null?r:l}),checkedIcon:f.cloneElement(d,{fontSize:(n=d.props.fontSize)!=null?n:l}),ownerState:p,ref:s,className:N(h.root,i)},b,{classes:h}))});function Me(e){return U("MuiFormControlLabel",e)}const D=W("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Te=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Ne=e=>{const{classes:o,disabled:s,labelPlacement:r,error:n,required:a}=e,u={root:["root",s&&"disabled",`labelPlacement${L(r)}`,n&&"error",a&&"required"],label:["label",s&&"disabled"],asterisk:["asterisk",n&&"error"]};return G(u,Me,o)},_e=M("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[{[`& .${D.label}`]:o.label},o.root,o[`labelPlacement${L(s.labelPlacement)}`]]}})(({theme:e,ownerState:o})=>C({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${D.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${D.label}`]:{[`&.${D.disabled}`]:{color:(e.vars||e).palette.text.disabled}}})),qe=M("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,o)=>o.asterisk})(({theme:e})=>({[`&.${D.error}`]:{color:(e.vars||e).palette.error.main}})),Ee=f.forwardRef(function(o,s){var r,n;const a=ee({props:o,name:"MuiFormControlLabel"}),{className:u,componentsProps:k={},control:g,disabled:m,disableTypography:P,label:v,labelPlacement:l="end",required:i,slotProps:b={}}=a,x=V(a,Te),d=Z(),p=(r=m??g.props.disabled)!=null?r:d==null?void 0:d.disabled,h=i??g.props.required,S={disabled:p,required:h};["checked","name","onChange","value","inputRef"].forEach(I=>{typeof g.props[I]>"u"&&typeof a[I]<"u"&&(S[I]=a[I])});const B=he({props:a,muiFormControl:d,states:["error"]}),Y=C({},a,{disabled:p,labelPlacement:l,required:h,error:B.error}),y=Ne(Y),R=(n=b.typography)!=null?n:k.typography;let j=v;return j!=null&&j.type!==z&&!P&&(j=t.jsx(z,C({component:"span"},R,{className:N(y.label,R==null?void 0:R.className),children:j}))),t.jsxs(_e,C({className:N(y.root,u),ownerState:Y,ref:s},x,{children:[f.cloneElement(g,S),h?t.jsxs(ge,{display:"block",children:[j,t.jsxs(qe,{ownerState:Y,"aria-hidden":!0,className:y.asterisk,children:["â€‰","*"]})]}):j]}))}),Oe=()=>{const[e,o]=f.useState({name:"",fromYear:"",toYear:"",isCurrent:!1}),[s,r]=f.useState(""),{loading:n,callApi:a}=de(),u=Ce(),k=T(l=>l.adminData.academicYears)||[],g=T(l=>l.adminData.currentAcademicYear),m=T(l=>{var i;return(i=l.users.user)==null?void 0:i._id});return{formValues:e,handleChange:l=>{const{name:i,value:b,type:x,checked:d}=l.target;o(p=>({...p,[i]:x==="checkbox"?d:b}))},handleCreateAcademicYear:async()=>{var h,S;const{name:l,fromYear:i,toYear:b,isCurrent:x}=e;if(!l.trim()||!i.trim()||!b.trim())return r("Please fill in all required fields."),!1;const d=/^\d{4}-\d{2}-\d{2}$/;if(!d.test(i)||!d.test(b))return r("Dates must be in YYYY-MM-DD format."),!1;if(!m)return r("User not authenticated. Please log in."),!1;const p={name:l,fromYear:new Date(i).toISOString(),toYear:new Date(b).toISOString(),isCurrent:x,createdBy:m};try{if(r(""),await a(fe.ACADEMIC_YEARS,"POST",p))return o({name:"",fromYear:"",toYear:"",isCurrent:!1}),!0}catch(B){const Y=((S=(h=B.response)==null?void 0:h.data)==null?void 0:S.message)||"Failed to create academic year.";return r(Y),u(r(Y)),!1}},academicYears:k,currentYear:g,loading:n,error:s}},He=({open:e,onClose:o,formValues:s,handleChange:r,handleCreateAcademicYear:n,error:a})=>{const u=async()=>{await n()&&o()};return t.jsx(ne,{open:e,onClose:o,title:"Add Academic Year",noConfirm:!0,children:t.jsxs(F,{children:[t.jsx(F,{mb:2,children:t.jsx(E,{label:"Academic Year Name",name:"name",value:s.name,onChange:r,fullWidth:!0,error:!!a,helperText:a})}),t.jsx(F,{mb:2,children:t.jsx(E,{type:"date",label:"From Year",name:"fromYear",value:s.fromYear,onChange:r,fullWidth:!0,error:!!a,helperText:a,InputLabelProps:{shrink:!0}})}),t.jsx(F,{mb:2,children:t.jsx(E,{type:"date",label:"To Year",name:"toYear",value:s.toYear,onChange:r,fullWidth:!0,error:!!a,helperText:a,InputLabelProps:{shrink:!0}})}),t.jsx(F,{mb:2,children:t.jsx(Ee,{control:t.jsx(ze,{checked:s.isCurrent,onChange:r,name:"isCurrent",color:"primary"}),label:"Set as Current Academic Year"})}),t.jsx(oe,{onClick:u,content:"Add Academic Year"})]})})},Ue=()=>{const e=be(),o=ce(e.palette.mode),{academicYears:s,currentYear:r,loading:n,error:a,formValues:u,handleChange:k,handleCreateAcademicYear:g}=Oe(),[m,P]=f.useState(!1),[v,l]=f.useState("name"),[i,b]=f.useState("asc"),[x,d]=f.useState(0),[p,h]=f.useState(5),[S,B]=f.useState(""),Y=[{id:"sn",label:"S/N"},{id:"name",label:"Name"},{id:"fromYear",label:"From Year"},{id:"toYear",label:"To Year"},{id:"isCurrent",label:"Current"}],y=s.map((c,w)=>({sn:w+1,id:c._id,name:c.name,fromYear:new Date(c.fromYear).toLocaleDateString(),toYear:new Date(c.toYear).toLocaleDateString(),isCurrent:c.isCurrent?"Yes":"No"})),R=c=>{const w=v===c&&i==="asc";l(c),b(w?"desc":"asc")},j=(c,w)=>{d(w)},I=c=>{h(parseInt(c.target.value,10)),d(0)},_=y.filter(c=>c.name.toLowerCase().includes(S.toLowerCase()));return t.jsxs(O,{container:!0,children:[t.jsx(O,{item:!0,xs:12,children:t.jsx(le,{title:"Academics Management",subtitle:"Manage Academic Sessions"})}),t.jsx(O,{item:!0,xs:12,children:n?t.jsx(F,{children:"Loading..."}):a?t.jsx(F,{sx:{color:"red"},children:a}):t.jsxs(t.Fragment,{children:[t.jsxs(F,{sx:{mb:3,p:2,backgroundColor:o.primary[400],borderRadius:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(F,{children:[t.jsx(z,{variant:"h5",color:o.grey[100],children:"Current Academic Year"}),r?t.jsxs(z,{variant:"body1",color:o.grey[100],children:[r.name," (",new Date(r.fromYear).toLocaleDateString()," -"," ",new Date(r.toYear).toLocaleDateString(),")"]}):t.jsx(z,{variant:"body1",color:o.redAccent[500],children:"No current academic year set."})]}),t.jsx(oe,{onClick:()=>P(!0),content:"Add Academic Year"})]}),t.jsx(He,{open:m,onClose:()=>P(!1),formValues:u,handleChange:k,handleCreateAcademicYear:g,error:a}),t.jsx(ie,{columns:Y,tableHeader:"Academic Years",data:_,sortBy:v,sortDirection:i,onSortChange:R,page:x,rowsPerPage:p,onPageChange:j,onRowsPerPageChange:I,hiddenColumnsSmallScreen:["fromYear","toYear"],hiddenColumnsTabScreen:["fromYear"]})]})})]})},We=()=>{const e=T(o=>o.users.user.role);return console.log(e),t.jsx("div",{children:e==="teacher"?t.jsx(se,{}):t.jsx(Ue,{})})},io=xe(We);export{io as default};
