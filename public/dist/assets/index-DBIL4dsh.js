var ve=Object.defineProperty;var we=(s,r,l)=>r in s?ve(s,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[r]=l;var me=(s,r,l)=>we(s,typeof r!="symbol"?r+"":r,l);import{j as e,r as j,a as se,e as re,i as Ae,I as ne,J as oe,R as Ie}from"./index-B2VsWHi0.js";import{u as be}from"./useApi-D0p11L1B.js";import{H as xe}from"./Header-BV8z6WDp.js";import{t as De,M as Ce}from"./modal-DX3xw_qP.js";import{c as le,a as ke,g as Ee,u as Fe,_ as Pe,b as ee,s as $e,d as Me,h as ae,e as Be,a3 as _e,i as Re,j as je,v as b,T as A,P as ze,y as G,x as Ye,Z as ue,$ as he,a0 as pe}from"./TextField-D0e7SfFy.js";import{A as Oe,G as ie}from"./index-iDew2wve.js";import{T as Ne}from"./table-D-XNOBG6.js";import{u as Le}from"./useAdminData-BY5CmKRL.js";import{u as qe,M as fe}from"./MenuItem-Cvlvye1h.js";import{S as We,F as Se}from"./FormControlLabel-BsvmXNkn.js";import{A as ye}from"./confirmationModal-B2YGZpqi.js";import{e as Ue,f as He}from"./index.esm-chYf2jgR.js";import{I as ge}from"./IconButton-C4sp_Nok.js";import{w as Ve}from"./dasboardPagesContainer-prID2t-k.js";import"./index-CFeojl79.js";import"./loadingButton-Dl_WVHvC.js";import"./CircularProgress-DYARFY18.js";import"./useSlot-87IwQkO8.js";import"./useMediaQuery-DaTtaMKo.js";const Ge=le(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Qe=le(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Je=le(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Ze(s){return Ee("MuiCheckbox",s)}const ce=ke("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Ke=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Xe=s=>{const{classes:r,indeterminate:l,color:a,size:Y}=s,D={root:["root",l&&"indeterminate",`color${ae(a)}`,`size${ae(Y)}`]},m=Be(D,Ze,r);return ee({},r,m)},et=$e(We,{shouldForwardProp:s=>_e(s)||s==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:l}=s;return[r.root,l.indeterminate&&r.indeterminate,r[`size${ae(l.size)}`],l.color!=="default"&&r[`color${ae(l.color)}`]]}})(({theme:s,ownerState:r})=>ee({color:(s.vars||s).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:s.vars?`rgba(${r.color==="default"?s.vars.palette.action.activeChannel:s.vars.palette[r.color].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:Re(r.color==="default"?s.palette.action.active:s.palette[r.color].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},r.color!=="default"&&{[`&.${ce.checked}, &.${ce.indeterminate}`]:{color:(s.vars||s).palette[r.color].main},[`&.${ce.disabled}`]:{color:(s.vars||s).palette.action.disabled}})),tt=e.jsx(Qe,{}),rt=e.jsx(Ge,{}),at=e.jsx(Je,{}),Te=j.forwardRef(function(r,l){var a,Y;const D=Fe({props:r,name:"MuiCheckbox"}),{checkedIcon:m=tt,color:u="primary",icon:w=rt,indeterminate:C=!1,indeterminateIcon:y=at,inputProps:p,size:o="medium",className:E}=D,R=Pe(D,Ke),B=C?y:w,T=C?y:m,F=ee({},D,{color:u,indeterminate:C,size:o}),P=Xe(F);return e.jsx(et,ee({type:"checkbox",inputProps:ee({"data-indeterminate":C},p),icon:j.cloneElement(B,{fontSize:(a=B.props.fontSize)!=null?a:o}),checkedIcon:j.cloneElement(T,{fontSize:(Y=T.props.fontSize)!=null?Y:o}),ownerState:F,ref:l,className:Me(P.root,E)},R,{classes:P}))}),st=()=>{const[s,r]=j.useState(""),[l,a]=j.useState(""),[Y,D]=j.useState([]),m=se(y=>y.users.user),{loading:u,data:w,callApi:C}=be();return j.useEffect(()=>{C(re.COURSES,"GET")},[]),j.useEffect(()=>{if(w&&w.courses){const y=w.courses.find(p=>p.courseName===m.program);y&&(r(y.courseName),a(y.duration),D(y.curriculum||[]))}},[w]),{courseName:s,courseDuration:l,curriculum:Y,loading:u}},nt=()=>{const s=je(),r=De(s.palette.mode),{courseDuration:l,courseName:a,curriculum:Y,loading:D}=st();return e.jsxs(b,{children:[e.jsx(xe,{title:a||"Primary 2",subtitle:`${l||0} months`}),D?e.jsx(Ae,{}):Y&&Y.length>0?e.jsxs(b,{children:[e.jsx(A,{variant:"h2",gutterBottom:!0,children:"Curriculum"}),e.jsx(b,{sx:{width:"100%"},children:Y.map((m,u)=>e.jsxs(ze,{elevation:3,sx:{backgroundColor:r.primary[400],color:r.blueAccent[500],p:3,mb:2,display:"flex",alignItems:"flex-start",gap:2,borderRadius:"12px",boxShadow:"0 3px 10px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Oe,{sx:{bgcolor:r.primary[500],width:40,height:40,fontSize:"18px",color:"white"},children:u+1}),e.jsxs(b,{children:[e.jsxs(A,{variant:"h3",sx:{color:r.blueAccent[200]},children:[m.topic||"No topic available"," "]}),e.jsxs(A,{variant:"body1",color:"textSecondary",sx:{mb:1},children:[m.description||"No description available"," "]}),e.jsxs(A,{variant:"body1",sx:{fontStyle:"italic"},children:["Duration: ",m.duration||"Unknown"," "]}),e.jsxs(A,{variant:"h6",sx:{color:r.blueAccent[200]},children:["Resources: ",Array.isArray(m.resources)?m.resources.join(", "):"No resources available"]})]})]},m._id||u))})]}):e.jsx(A,{variant:"body1",color:"textSecondary",children:"No curriculum available."})]})},ot=()=>{const s={id:"",name:"",fromYear:"",toYear:"",isCurrent:!1},r={academicYearId:"",terms:[{name:"1st Term",description:"",duration:"3 months",startDate:"",endDate:"",createdBy:"",isCurrent:!1},{name:"2nd Term",description:"",duration:"3 months",startDate:"",endDate:"",createdBy:"",isCurrent:!1},{name:"3rd Term",description:"",duration:"3 months",startDate:"",endDate:"",createdBy:"",isCurrent:!1}]},[l,a]=j.useState(s),[Y,D]=j.useState(r),[m,u]=j.useState({name:"",fromYear:"",toYear:"",general:""}),[w,C]=j.useState({general:"",terms:[{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""}]}),[y,p]=j.useState(!1),[o,E]=j.useState(!1),{loading:R,callApi:B}=be(),T=qe(),{academicYears:F,currentAcademicYear:P,refetchAcademicYears:z,refetchCurrentYear:L}=Le(),I=se(n=>{var i;return(i=n.users.user)==null?void 0:i._id}),W=n=>{const{name:i,value:k,type:f,checked:v}=n.target,t=f==="checkbox"?v:k;a(c=>({...c,[i]:t})),u(c=>({...c,[i]:"",general:""}))},q=(n,i,k=!1)=>{const{name:f,value:v,type:t,checked:c}=n.target,g=t==="checkbox"?c:v;D(d=>{const S=[...d.terms];return S[i]={...S[i],[f]:g,createdBy:I},k&&g&&S.forEach(($,te)=>{te!==i&&($.isCurrent=!1)}),{...d,terms:S}}),C(d=>({...d,terms:d.terms.map((S,$)=>$===i?{...S,[f]:""}:S),general:""}))},O=()=>{const{name:n,fromYear:i,toYear:k}=l,f={name:"",fromYear:"",toYear:"",general:""};return n.trim()?/^\d{4}\/\d{4}$/.test(n.trim())||(f.name="Name must be in format YYYY/YYYY (e.g., 2024/2025)"):f.name="Academic year name is required",i.trim()||(f.fromYear="From year is required"),k.trim()||(f.toYear="To year is required"),u(f),!f.name&&!f.fromYear&&!f.toYear},_=()=>{const{terms:n}=Y,i={general:"",terms:[{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""}]};(!n||n.length!==3||!n.every(t=>["1st Term","2nd Term","3rd Term"].includes(t.name)))&&(i.general="Exactly three terms (1st Term, 2nd Term, 3rd Term) are required"),n.filter(t=>t.isCurrent).length>1&&(i.general="Only one term can be set as current");const f=Array.from({length:10},(t,c)=>`${c+1} month${c+1>1?"s":""}`);n.forEach((t,c)=>{t.description.trim()||(i.terms[c].description="Description is required"),(!t.duration||!f.includes(t.duration))&&(i.terms[c].duration="Duration must be between 1 and 10 months"),t.startDate||(i.terms[c].startDate="Start date is required"),t.endDate||(i.terms[c].endDate="End date is required"),t.startDate&&t.endDate&&new Date(t.startDate)>=new Date(t.endDate)&&(i.terms[c].endDate="End date must be after start date")});const v=n.map(t=>t.duration);new Set(v).size!==v.length&&(i.general="All terms must have unique durations");for(let t=0;t<n.length;t++)for(let c=t+1;c<n.length;c++)n[t].startDate&&n[t].endDate&&n[c].startDate&&n[c].endDate&&new Date(n[t].startDate)<=new Date(n[c].endDate)&&new Date(n[c].startDate)<=new Date(n[t].endDate)&&(i.terms[c].startDate=`Terms ${n[t].name} and ${n[c].name} have overlapping dates`);return C(i),!i.general&&i.terms.every(t=>!t.description&&!t.duration&&!t.startDate&&!t.endDate)},U=async()=>{var t,c;if(!O())return!1;if(!I)return u(g=>({...g,general:"User not authenticated. Please log in."})),!1;const{name:n,fromYear:i,toYear:k,isCurrent:f}=l,v={name:n,fromYear:new Date(i).toISOString(),toYear:new Date(k).toISOString(),isCurrent:f,createdBy:I,academicTerms:[],students:[],teachers:[]};try{E(!0),u(S=>({...S,name:"",fromYear:"",toYear:"",general:""}));const g=await B(re.ACADEMIC_YEARS,"POST",v);if(!g||g.status!=="success")throw new Error((g==null?void 0:g.message)||"Failed to create academic year");const d=g.data;return T(ne([...F,d])),f&&T(oe(d)),await z(),await L(),a(s),p(!1),!0}catch(g){const d=((c=(t=g.response)==null?void 0:t.data)==null?void 0:c.message)||g.message||"Failed to create academic year";return u(S=>({...S,general:d})),T(u(d)),!1}finally{E(!1)}},N=async()=>{var f,v;if(!_())return!1;if(!I)return C(t=>({...t,general:"User not authenticated. Please log in."})),!1;const{terms:n,academicYearId:i}=Y,k={academicYearId:i,terms:n.map(t=>({...t,startDate:t.startDate?new Date(t.startDate).toISOString():void 0,endDate:t.endDate?new Date(t.endDate).toISOString():void 0,createdBy:I}))};try{E(!0),C(d=>({...d,general:"",terms:d.terms.map(()=>({description:"",duration:"",startDate:"",endDate:""}))}));const t=await B(re.ACADEMIC_TERMS,"POST",k);if(!t||t.status!=="success")throw new Error((t==null?void 0:t.message)||"Failed to create academic term");const c=t.data,g=F.map(d=>d._id===i?{...d,academicTerms:[...d.academicTerms||[],c._id]}:d);return T(ne(g)),await z(),D(r),!0}catch(t){const c=((v=(f=t.response)==null?void 0:f.data)==null?void 0:v.message)||t.message||"Failed to create academic term";return C(g=>({...g,general:c})),T(u(c)),!1}finally{E(!1)}},H=async()=>{var c,g;if(!O())return!1;const{id:n,name:i,fromYear:k,toYear:f,isCurrent:v}=l;if(!I)return u(d=>({...d,general:"User not authenticated. Please log in."})),!1;const t={name:i,fromYear:new Date(k).toISOString(),toYear:new Date(f).toISOString(),isCurrent:v,createdBy:I};try{E(!0),u($=>({...$,name:"",fromYear:"",toYear:"",general:""}));const d=await B(`${re.ACADEMIC_YEARS}/${n}`,"PATCH",t);if(!d||d.status!=="success")throw new Error((d==null?void 0:d.message)||"Failed to update academic year");const S=d.data;return T(ne(F.map($=>$._id===n?S:$))),v?T(oe(S)):(P==null?void 0:P._id)===n&&!v&&T(oe(null)),await z(),await L(),a(s),p(!1),!0}catch(d){const S=((g=(c=d.response)==null?void 0:c.data)==null?void 0:g.message)||d.message||"Failed to update academic year";return u($=>({...$,general:S})),T(u(S)),!1}finally{E(!1)}};return{setFormValues:a,formValues:l,handleChange:W,handleTermChange:q,handleSubmit:async()=>y?await H():await U(),handleCreateAcademicTerm:N,startEdit:n=>{a({id:n._id,name:n.name,fromYear:n.fromYear.split("T")[0],toYear:n.toYear.split("T")[0],isCurrent:n.isCurrent}),p(!0),u({name:"",fromYear:"",toYear:"",general:""})},startAddTerm:n=>{D({...r,academicYearId:n,terms:r.terms.map(i=>({...i,createdBy:I}))}),C({general:"",terms:[{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""}]})},editMode:y,setEditMode:p,academicYears:F,currentAcademicYear:P,loading:R,error:m,termError:w,isSubmitting:o,resetForm:()=>{a(s),u({name:"",fromYear:"",toYear:"",general:""}),p(!1)},resetTermForm:()=>{D(r),C({general:"",terms:[{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""},{description:"",duration:"",startDate:"",endDate:""}]})},termFormValues:Y}},it=({open:s,onClose:r,handleSubmit:l,error:a={},editMode:Y=!1,userId:D,formValues:m,handleChange:u,isSubmitting:w=!1})=>{const C=new Date().toISOString().split("T")[0],y=async p=>{p.preventDefault(),console.log("Form submission attempted with values:",m);try{await l(m)?(console.log("Submission successful"),r()):console.log("Submission failed, handleSubmit returned false")}catch(o){console.error("Submission error:",o)}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0);
            opacity: 1;
          }
          input[type="date"] {
            color-scheme: light;
          }
        `}),e.jsx(Ce,{open:s,onClose:r,title:Y?"Edit Academic Year":"Add Academic Year",noConfirm:!0,children:e.jsxs(b,{component:"form",onSubmit:y,children:[e.jsx(b,{mb:2,children:e.jsx(G,{label:"Academic Year Name (e.g., 2024/2025)",name:"name",value:m.name||"",onChange:u,fullWidth:!0,required:!0,error:!!a.name,helperText:a.name||"Format: YYYY/YYYY (e.g., 2024/2025)"})}),e.jsx(b,{mb:2,children:e.jsx(G,{label:"From Year",name:"fromYear",type:"date",value:m.fromYear||"",onChange:u,fullWidth:!0,required:!0,error:!!a.fromYear,helperText:a.fromYear,InputLabelProps:{shrink:!0},inputProps:{min:C}})}),e.jsx(b,{mb:2,children:e.jsx(G,{label:"To Year",name:"toYear",type:"date",value:m.toYear||"",onChange:u,fullWidth:!0,required:!0,error:!!a.toYear,helperText:a.toYear,InputLabelProps:{shrink:!0},inputProps:{min:m.fromYear||C}})}),e.jsx(b,{mb:2,children:e.jsx(Se,{control:e.jsx(Te,{checked:m.isCurrent||!1,onChange:u,name:"isCurrent",color:"primary"}),label:"Set as Current Academic Year"})}),a.general&&e.jsx(A,{variant:"caption",color:"error",mb:2,children:a.general}),e.jsx(Ye,{type:"submit",variant:"contained",color:"primary",disabled:w,fullWidth:!0,children:w?"Submitting...":Y?"Update Academic Year":"Submit"})]})})]})},ct=({open:s,onClose:r,handleSubmit:l,error:a={},userId:Y,formValues:D,handleChange:m,isSubmitting:u=!1})=>{const w=new Date().toISOString().split("T")[0],C=async p=>{p.preventDefault();try{await l()&&r()}catch(o){console.error("Submission error:",o)}},y=Array.from({length:10},(p,o)=>`${o+1} month${o+1>1?"s":""}`);return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0);
            opacity: 1;
          }
          input[type="date"] {
            color-scheme: light;
          }
        `}),e.jsx(Ce,{open:s,onClose:r,title:"Add Academic Term",noConfirm:!0,children:e.jsxs(b,{component:"form",onSubmit:C,children:[D.terms.map((p,o)=>{var E,R,B,T,F,P,z,L,I,W,q,O,_,U,N,H,Q,V,J,Z;return e.jsxs(b,{mb:3,sx:{border:"1px solid #ccc",p:2,borderRadius:1},children:[e.jsx(A,{variant:"h6",children:p.name}),e.jsx(b,{mb:2,children:e.jsxs(ue,{fullWidth:!0,required:!0,error:!!((R=(E=a.terms)==null?void 0:E[o])!=null&&R.name),children:[e.jsx(he,{id:`term-name-label-${o}`,children:"Term Name"}),e.jsx(pe,{labelId:`term-name-label-${o}`,name:"name",value:p.name||"",onChange:x=>m(x,o),label:"Term Name",disabled:!0,children:["1st Term","2nd Term","3rd Term"].map(x=>e.jsx(fe,{value:x,children:x},x))}),((T=(B=a.terms)==null?void 0:B[o])==null?void 0:T.name)&&e.jsx(A,{variant:"caption",color:"error",children:a.terms[o].name})]})}),e.jsx(b,{mb:2,children:e.jsx(G,{label:"Description",name:"description",value:p.description||"",onChange:x=>m(x,o),fullWidth:!0,required:!0,error:!!((P=(F=a.terms)==null?void 0:F[o])!=null&&P.description),helperText:(L=(z=a.terms)==null?void 0:z[o])==null?void 0:L.description})}),e.jsx(b,{mb:2,children:e.jsxs(ue,{fullWidth:!0,required:!0,error:!!((W=(I=a.terms)==null?void 0:I[o])!=null&&W.duration),children:[e.jsx(he,{id:`duration-label-${o}`,children:"Duration"}),e.jsx(pe,{labelId:`duration-label-${o}`,name:"duration",value:p.duration||"3 months",onChange:x=>m(x,o),label:"Duration",children:y.map(x=>e.jsx(fe,{value:x,children:x},x))}),((O=(q=a.terms)==null?void 0:q[o])==null?void 0:O.duration)&&e.jsx(A,{variant:"caption",color:"error",children:a.terms[o].duration})]})}),e.jsx(b,{mb:2,children:e.jsx(G,{label:"Start Date",name:"startDate",type:"date",value:p.startDate||"",onChange:x=>m(x,o),fullWidth:!0,required:!0,error:!!((U=(_=a.terms)==null?void 0:_[o])!=null&&U.startDate),helperText:(H=(N=a.terms)==null?void 0:N[o])==null?void 0:H.startDate,InputLabelProps:{shrink:!0},inputProps:{min:w}})}),e.jsx(b,{mb:2,children:e.jsx(G,{label:"End Date",name:"endDate",type:"date",value:p.endDate||"",onChange:x=>m(x,o),fullWidth:!0,required:!0,error:!!((V=(Q=a.terms)==null?void 0:Q[o])!=null&&V.endDate),helperText:(Z=(J=a.terms)==null?void 0:J[o])==null?void 0:Z.endDate,InputLabelProps:{shrink:!0},inputProps:{min:p.startDate||w}})}),e.jsx(b,{mb:2,children:e.jsx(Se,{control:e.jsx(Te,{checked:p.isCurrent||!1,onChange:x=>m(x,o,!0),name:"isCurrent",color:"primary"}),label:"Set as Current Term"})})]},p.name)}),a.general&&e.jsx(A,{variant:"caption",color:"error",mb:2,children:a.general}),e.jsx(Ye,{type:"submit",variant:"contained",color:"primary",disabled:u,fullWidth:!0,children:u?"Submitting...":"Submit"})]})})]})};class lt extends Ie.Component{constructor(){super(...arguments);me(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,a){console.error("Error caught by boundary:",l,a)}render(){var l;return this.state.hasError?e.jsxs(b,{sx:{p:3,textAlign:"center"},children:[e.jsx(A,{variant:"h5",color:"error",children:"Something went wrong."}),e.jsx(A,{variant:"body1",mt:2,children:((l=this.state.error)==null?void 0:l.message)||"An unexpected error occurred."}),e.jsx(ye,{content:"Reload",onClick:()=>window.location.reload(),sx:{mt:2}})]}):this.props.children}}const dt=()=>{var $,te,de;const s=je(),r=De(s.palette.mode),{academicYears:l,currentAcademicYear:a,loading:Y,error:D,termError:m,handleSubmit:u,handleCreateAcademicTerm:w,startEdit:C,startAddTerm:y,editMode:p,setEditMode:o,formValues:E,termFormValues:R,handleChange:B,handleTermChange:T,isSubmitting:F,resetForm:P,resetTermForm:z}=ot(),[L,I]=j.useState(!1),[W,q]=j.useState(!1),O=se(h=>{var M;return(M=h.users.user)==null?void 0:M._id})||"",[_,U]=j.useState("name"),[N,H]=j.useState("asc"),[Q,V]=j.useState(0),[J,Z]=j.useState(5),[x,n]=j.useState(""),i=[{id:"sn",label:"S/N"},{id:"name",label:"Name"},{id:"fromYear",label:"From Year"},{id:"toYear",label:"To Year"},{id:"isCurrent",label:"Current"},{id:"studentCount",label:"Students"},{id:"teacherCount",label:"Teachers"},{id:"actions",label:"Actions"}],k=l.map((h,M)=>{var K,X;return{sn:M+1,id:h._id,name:h.name,fromYear:new Date(h.fromYear).toLocaleDateString(),toYear:new Date(h.toYear).toLocaleDateString(),isCurrent:h.isCurrent?"Yes":"No",studentCount:((K=h.students)==null?void 0:K.length)||0,teacherCount:((X=h.teachers)==null?void 0:X.length)||0,actions:e.jsxs(b,{children:[e.jsxs(ge,{onClick:()=>{console.log("EditIcon clicked for academicYearId:",h._id),f(h)},children:[e.jsx(Ue,{})," "]}),e.jsxs(ge,{onClick:()=>{console.log("AddCircleIcon clicked for academicYearId:",h._id),v(h._id)},children:[e.jsx(He,{})," "]})]})}}),f=h=>{console.log("handleEdit called with year:",h._id),C(h),I(!0)},v=h=>{console.log("handleAddTerm called with academicYearId:",h);try{y(h),q(!0)}catch(M){console.error("Error in handleAddTerm:",M)}},t=h=>{const M=_===h&&N==="asc";U(h),H(M?"desc":"asc")},c=(h,M)=>{V(M)},g=h=>{Z(parseInt(h.target.value,10)),V(0)},S=[...k.filter(h=>h.name.toLowerCase().includes(x.toLowerCase()))].sort((h,M)=>{const K=h[_],X=M[_];return N==="asc"?K>X?1:-1:K<X?1:-1});return e.jsx(lt,{children:e.jsxs(ie,{container:!0,children:[e.jsx(ie,{item:!0,xs:12,children:e.jsx(xe,{title:"Academics Management",subtitle:"Manage Academic Sessions"})}),e.jsx(ie,{item:!0,xs:12,children:Y?e.jsx(b,{children:"Loading..."}):D.general?e.jsx(b,{sx:{color:"red"},children:D.general}):e.jsxs(e.Fragment,{children:[e.jsxs(b,{sx:{mb:3,p:2,backgroundColor:r.primary[400],borderRadius:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(b,{children:[e.jsx(A,{variant:"h5",color:r.grey[100],children:"Current Academic Year"}),a?e.jsxs(A,{variant:"body1",color:r.grey[100],children:[a.name," (",new Date(a.fromYear).toLocaleDateString()," -"," ",new Date(a.toYear).toLocaleDateString(),") |"," ",(($=a.students)==null?void 0:$.length)||0," Students,"," ",((te=a.teachers)==null?void 0:te.length)||0," Teachers,"," ",((de=a.academicTerms)==null?void 0:de.length)||0," Terms"]}):e.jsx(A,{variant:"body1",color:r.redAccent[500],children:"No current academic year set."})]}),e.jsx(ye,{onClick:()=>{I(!0),o(!1),P()},content:"Add Academic Year"})]}),e.jsx(it,{open:L,onClose:()=>{I(!1),o(!1),P()},handleSubmit:u,error:D,editMode:p,userId:O,formValues:E,handleChange:B,isSubmitting:F}),e.jsx(ct,{open:W,onClose:()=>{q(!1),z()},handleSubmit:w,error:m,userId:O,formValues:R,handleChange:T,isSubmitting:F}),e.jsx(Ne,{columns:i,tableHeader:"Academic Years",data:S,sortBy:_,sortDirection:N,onSortChange:t,page:Q,rowsPerPage:J,onPageChange:c,onRowsPerPageChange:g,hiddenColumnsSmallScreen:["fromYear","toYear","studentCount","teacherCount","academicTermCount","actions"],hiddenColumnsTabScreen:["studentCount","teacherCount","academicTermCount"]})]})})]})})},mt=()=>{const s=se(r=>r.users.user.role);return console.log(s),e.jsx("div",{children:s==="teacher"?e.jsx(nt,{}):e.jsx(dt,{})})},Ft=Ve(mt);export{Ft as default};
