import{r as P,j as s}from"./index-sE9McROK.js";import{t as O,M as D}from"./modal-D5t_VsWL.js";import{H}from"./Header-Ce3beeyr.js";import{a as q,b as z,T as J}from"./table-BiKsd7Cl.js";import{w as Q}from"./dasboardPagesContainer-D6kqLPWj.js";import{C as W}from"./accordion-DIcwOXKu.js";import{j as G,w as d,T as l,y as A}from"./TextField-CMl_o3n-.js";import{L as T}from"./LinearProgress-BdpoE6Jb.js";import"./IconButton-DNp91bHf.js";import"./index-BS84kvxy.js";import"./MenuItem-BXhanr4d.js";import"./useApi-CPAxUgM_.js";import"./confirmationModal-DtYljRDW.js";import"./CircularProgress-Cqs5A885.js";import"./index-BbKQoXkK.js";import"./loadingButton-CLKFd1OZ.js";import"./useSlot-BX7f3QAU.js";import"./useMediaQuery-CnNNHth1.js";function I(_){const{children:o,value:j,index:h,...b}=_;return s.jsx("div",{role:"tabpanel",hidden:j!==h,id:`academic-year-tabpanel-${h}`,"aria-labelledby":`academic-year-tab-${h}`,...b,children:j===h&&s.jsx(d,{sx:{p:3},children:o})})}const C={academicYears:[{_id:"year_1",name:"2023–2024"},{_id:"year_2",name:"2024–2025"}],classes:[{_id:"class_1",academicYearId:"year_1",section:"Primary",displayName:"Primary 1A",students:["stu_1","stu_2"]},{_id:"class_2",academicYearId:"year_2",section:"Secondary",displayName:"Secondary 1B",students:["stu_3"]}],students:[{_id:"stu_1",firstName:"John",lastName:"Doe",subjects:[{name:"Mathematics",topics:[{topic:"Linear Equations",progress:80},{topic:"Quadratic Functions",progress:60}],overallProgress:70},{name:"English",topics:[{topic:"Grammar Basics",progress:90},{topic:"Literature Analysis",progress:50}],overallProgress:70}]},{_id:"stu_2",firstName:"Jane",lastName:"Smith",subjects:[{name:"Mathematics",topics:[{topic:"Linear Equations",progress:70},{topic:"Quadratic Functions",progress:40}],overallProgress:55}]},{_id:"stu_3",firstName:"Alice",lastName:"Brown",subjects:[{name:"Science",topics:[{topic:"Chemical Reactions",progress:85}],overallProgress:85}]}]},K=()=>{const _=G(),o=O(_.palette.mode),[j,h]=P.useState(0),b=Array.isArray(C.academicYears)?C.academicYears:[],[y,S]=P.useState(b.reduce((e,r)=>({...e,[r._id]:{page:0,rowsPerPage:5,sortBy:"name",sortDirection:"asc"}}),{})),[M,N]=P.useState(!1),[k,w]=P.useState(!1),[n,v]=P.useState(null);console.log("dummyData.academicYears:",C.academicYears);const $=(e,r)=>{h(r)},B=(e,r)=>{S(a=>({...a,[e]:{...a[e],page:r}}))},L=(e,r)=>{S(a=>({...a,[e]:{...a[e],page:0,rowsPerPage:parseInt(r.target.value,10)}}))},F=(e,r)=>{S(a=>{const t=a[e],c=t.sortBy===r&&t.sortDirection==="asc"?"desc":"asc";return{...a,[e]:{...t,sortBy:r,sortDirection:c}}})},Y=e=>{v(e),N(!0)},R=e=>{v(e),w(!0)},E=e=>{const{page:r,rowsPerPage:a,sortBy:t,sortDirection:c}=y[e]||{page:0,rowsPerPage:5,sortBy:"name",sortDirection:"asc"},g=C.classes.filter(i=>i.academicYearId===e);let m=[];g.forEach(i=>{const u=C.students.filter(p=>i.students.includes(p._id)).map(p=>({...p,className:i.displayName,section:i.section,subjectsDisplay:(p.subjects||[]).map(x=>x.name).join(", ")}));m.push(...u)}),m.sort((i,u)=>{let p=i[t]??"",x=u[t]??"";return t==="name"?(p=`${i.firstName} ${i.lastName}`.toLowerCase(),x=`${u.firstName} ${u.lastName}`.toLowerCase()):t==="subjects"?(p=(i.subjects||[]).length,x=(u.subjects||[]).length):t==="subjectsDisplay"&&(p=i.subjectsDisplay.toLowerCase(),x=u.subjectsDisplay.toLowerCase()),p<x?c==="asc"?-1:1:p>x?c==="asc"?1:-1:0});const f=r*a;return m.slice(f,f+a).map((i,u)=>({...i,sn:f+u+1,name:`${i.firstName} ${i.lastName}`}))},V=[{id:"sn",label:"S/N",flex:.5},{id:"name",label:"Student Name",flex:2,renderCell:e=>s.jsx(l,{children:e.name})},{id:"className",label:"Class",flex:1,renderCell:e=>s.jsx(l,{children:e.className})},{id:"subjectsDisplay",label:"Subjects",flex:2,renderCell:e=>s.jsx(l,{children:e.subjectsDisplay||"None"})},{id:"actions",label:"Actions",flex:1,renderCell:e=>s.jsxs(d,{display:"flex",gap:"10px",children:[s.jsx(A,{variant:"contained",color:"primary",size:"small",onClick:()=>Y(e),children:"View"}),s.jsx(A,{variant:"contained",color:"secondary",size:"small",onClick:()=>R(e),children:"View Progress"})]})}];return s.jsxs(d,{children:[s.jsx(H,{title:"Teacher Class Management",subtitle:"View your students and their subject progress"}),s.jsx(d,{sx:{mt:3,mb:3},children:b.length>0?s.jsxs(s.Fragment,{children:[s.jsx(q,{value:j,onChange:$,"aria-label":"academic year tabs",sx:{backgroundColor:o.primary[400],"& .MuiTabs-indicator":{backgroundColor:o.blueAccent[700]}},children:b.map((e,r)=>s.jsx(z,{label:e.name,sx:{color:"white !important",textTransform:"none",fontWeight:"bold","&.Mui-selected":{color:"white !important",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.3)",backgroundColor:o.blueAccent[700]},boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)",backgroundColor:o.primary[400]}},e._id))}),b.map((e,r)=>{var a,t,c,g;return s.jsx(I,{value:j,index:r,children:s.jsx(J,{columns:V,tableHeader:`Students for ${e.name}`,data:E(e._id),page:((a=y[e._id])==null?void 0:a.page)||0,rowsPerPage:((t=y[e._id])==null?void 0:t.rowsPerPage)||5,sortBy:((c=y[e._id])==null?void 0:c.sortBy)||"name",sortDirection:((g=y[e._id])==null?void 0:g.sortDirection)||"asc",onSortChange:m=>F(e._id,m),onPageChange:(m,f)=>B(e._id,f),onRowsPerPageChange:m=>L(e._id,m),onRowClick:m=>console.log("Row clicked:",m),hiddenColumnsSmallScreen:["subjectsDisplay"]})},e._id)})]}):s.jsx(l,{children:"No academic years assigned"})}),s.jsx(D,{open:M,onClose:()=>{N(!1),v(null)},title:`${(n==null?void 0:n.name)||"Student"} Details`,noConfirm:!0,children:n&&s.jsxs(d,{children:[s.jsxs(l,{variant:"h6",children:["Class: ",n.className||"N/A"]}),s.jsx(l,{variant:"h6",sx:{mt:2},children:"Subjects and Progress"}),(n.subjects||[]).length>0?n.subjects.map((e,r)=>{var t;const a=(n.subjects||[]).reduce((c,g)=>c+g.overallProgress,0)/(((t=n.subjects)==null?void 0:t.length)||1);return s.jsx(W,{title:`${e.name} (${e.overallProgress.toFixed(2)}%)`,details:s.jsx(d,{children:e.topics.map((c,g)=>s.jsxs(d,{sx:{mb:2},children:[s.jsx(l,{variant:"body1",sx:{mb:1},children:c.topic}),s.jsx(T,{variant:"determinate",value:c.progress,sx:{height:10,borderRadius:5,backgroundColor:o.grey[300],"& .MuiLinearProgress-bar":{backgroundColor:o.greenAccent[500]}}}),s.jsxs(d,{sx:{mt:1},children:[s.jsxs(l,{variant:"body2",color:o.grey[100],children:[s.jsx("strong",{style:{color:o.blueAccent[200]},children:"Topic Progress:"})," ",c.progress.toFixed(2),"%"]}),s.jsxs(l,{variant:"body2",color:o.grey[100],children:[s.jsx("strong",{style:{color:o.blueAccent[200]},children:"Subject Overall Progress:"})," ",e.overallProgress.toFixed(2),"%"]}),s.jsxs(l,{variant:"body2",color:o.grey[100],children:[s.jsx("strong",{style:{color:o.blueAccent[200]},children:"Student Average Progress:"})," ",a.toFixed(2),"%"]})]})]},g))}),defaultExpanded:!1},r)}):s.jsx(l,{variant:"body1",children:"No subjects assigned"})]})}),s.jsx(D,{open:k,onClose:()=>{w(!1),v(null)},title:`Progress for ${(n==null?void 0:n.name)||"Student"}`,noConfirm:!0,children:n&&s.jsx(d,{display:"flex",flexDirection:"column",gap:"16px",children:(n.subjects||[]).length>0?n.subjects.map((e,r)=>s.jsxs(d,{children:[s.jsxs(l,{variant:"h6",mb:"15px",children:[e.name," (",e.overallProgress.toFixed(2),"%)"]}),e.topics.map((a,t)=>s.jsxs(d,{sx:{mb:2},children:[s.jsx(l,{variant:"body1",mb:"10px",children:a.topic}),s.jsx(T,{variant:"determinate",value:a.progress,sx:{height:"10px",borderRadius:"5px",backgroundColor:o.primary[300],"& .MuiLinearProgress-bar":{backgroundColor:o.greenAccent[500]}}}),s.jsxs(l,{variant:"body2",mt:"10px",children:["Progress: ",a.progress.toFixed(2),"%"]})]},t))]},r)):s.jsx(l,{variant:"body1",children:"No subjects available to display"})})})]})},he=Q(K);export{he as default};
